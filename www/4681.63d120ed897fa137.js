"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4681],{6387:(vt,it,M)=>{M.d(it,{T:()=>ae});var s=M(467),I=M(9969),Y=M(1626),W=M(7586),ct=M(4843),t=M(3953),D=M(791),H=M(4938),F=M(177);function tt(f,T){if(1&f&&(t.j41(0,"div",9)(1,"h3",10),t.EFF(2),t.k0s(),t.j41(3,"p",11),t.EFF(4),t.k0s()()),2&f){const h=T.$implicit,e=t.XpG();t.R7$(2),t.JRh(e.getDayInHebrew(h.name)),t.R7$(2),t.JRh(h.date)}}function q(f,T){if(1&f&&(t.j41(0,"div")(1,"p",16),t.EFF(2),t.k0s(),t.j41(3,"p",17),t.EFF(4),t.k0s()()),2&f){const h=t.XpG().$implicit,e=t.XpG().$implicit;t.R7$(2),t.JRh(h.trainings[e].time),t.R7$(2),t.JRh(h.trainings[e].title)}}function U(f,T){1&f&&(t.j41(0,"div")(1,"p",18),t.EFF(2,"-"),t.k0s()())}function Z(f,T){if(1&f&&(t.j41(0,"div",14),t.DNE(1,q,5,2,"div",15)(2,U,3,0,"div",15),t.k0s()),2&f){const h=T.$implicit,e=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",h.trainings[e]),t.R7$(),t.Y8G("ngIf",!h.trainings[e])}}function V(f,T){if(1&f&&(t.j41(0,"div",12),t.DNE(1,Z,3,2,"div",13),t.k0s()),2&f){const h=t.XpG();t.R7$(),t.Y8G("ngForOf",h.days)}}let L=(()=>{var f;class T{constructor(e,o){this.modalCtrl=e,this.ameliaService=o,this.branch="main",this.days=[],this.hebrewDaysMap={Sunday:"\u05e8\u05d0\u05e9\u05d5\u05df",Monday:"\u05e9\u05e0\u05d9",Tuesday:"\u05e9\u05dc\u05d9\u05e9\u05d9",Wednesday:"\u05e8\u05d1\u05d9\u05e2\u05d9",Thursday:"\u05d7\u05de\u05d9\u05e9\u05d9",Friday:"\u05e9\u05d9\u05e9\u05d9",Saturday:"\u05e9\u05d1\u05ea"},this.daysOfWeekEnglish=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}ngOnInit(){this.loadWeeklyTrainings()}loadWeeklyTrainings(){const e=this.ameliaService.getTrainingsTitles(this.branch);this.days=this.daysOfWeekEnglish.map((o,p)=>({name:o,date:W().day(p).format("DD/MM/YYYY"),trainings:e[o]||[]}))}refreshTrainings(){var e=this;return(0,s.A)(function*(){try{yield e.ameliaService.fetchTitleTrainings("main"),e.loadWeeklyTrainings()}catch(o){console.error("Error refreshing trainings:",o)}try{yield e.ameliaService.fetchTitleTrainings("second"),e.loadWeeklyTrainings()}catch(o){console.error("Error refreshing trainings:",o)}})()}getDayInHebrew(e){return this.hebrewDaysMap[e]||e}getMaxTrainingsLength(){return Math.max(...this.days.map(e=>e.trainings.length),0)}getRange(e){return Array.from({length:e},(o,p)=>p)}getDayName(e){return this.daysOfWeekEnglish[e%7]}getDateByOffset(e){return W().add(e,"days").format("DD/MM/YYYY")}getBranchTitle(){return"main"===this.branch?"\u05e1\u05e0\u05d9\u05e3 \u05e8\u05d0\u05e9\u05d9":"\u05e1\u05e0\u05d9\u05e3 \u05de\u05e9\u05e0\u05d9"}dismiss(){this.modalCtrl.dismiss()}}return(f=T).\u0275fac=function(e){return new(e||f)(t.rXU(D.W3),t.rXU(H.J))},f.\u0275cmp=t.VBU({type:f,selectors:[["app-calendar-popup"]],inputs:{weeklyData:"weeklyData",branch:"branch"},decls:13,vars:2,consts:[[1,"modal-title"],["slot","end"],["fill","clear",3,"click"],[1,"modal-content"],[1,"calendar-table-wrapper"],[1,"calendar-table"],[1,"table-header"],["class","day-header",4,"ngFor","ngForOf"],["class","table-row",4,"ngFor","ngForOf"],[1,"day-header"],[1,"dayName"],[1,"dayDate"],[1,"table-row"],["class","table-cell training-cell",4,"ngFor","ngForOf"],[1,"table-cell","training-cell"],[4,"ngIf"],[1,"training-time"],[1,"training-title"],[1,"empty-slot"]],template:function(e,o){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),t.EFF(3,"\u05d4\u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd \u05d4\u05e7\u05e8\u05d5\u05d1\u05d9\u05dd"),t.k0s(),t.j41(4,"ion-buttons",1)(5,"ion-button",2),t.bIt("click",function(){return o.dismiss()}),t.EFF(6,"\u05e1\u05d2\u05d5\u05e8"),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"div",4)(9,"div",5)(10,"div",6),t.DNE(11,tt,5,2,"div",7),t.k0s(),t.DNE(12,V,2,1,"div",8),t.k0s()()()),2&e&&(t.R7$(11),t.Y8G("ngForOf",o.days),t.R7$(),t.Y8G("ngForOf",o.getRange(o.getMaxTrainingsLength())))},dependencies:[F.Sq,F.bT,D.Jm,D.QW,D.W9,D.eU,D.BC,D.ai],styles:[".modal-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.modal-content[_ngcontent-%COMP%]{--background: #f8f9fa;padding:16px}.calendar-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;white-space:nowrap;padding:8px}.calendar-table[_ngcontent-%COMP%]{display:grid;gap:1px;min-width:700px;background-color:#ddd}.table-header[_ngcontent-%COMP%]{display:contents}.day-header[_ngcontent-%COMP%]{background:#f60;color:#fff;text-align:center;padding:8px;border-radius:6px 6px 0 0;font-size:14px;font-weight:700}.table-row[_ngcontent-%COMP%]{display:contents}.table-cell[_ngcontent-%COMP%]{background:#fff;text-align:center;padding:8px;font-size:14px;min-height:60px}.training-time[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin:0;color:#333}.training-title[_ngcontent-%COMP%]{font-size:12px;margin:4px 0 0;color:#555}.empty-slot[_ngcontent-%COMP%]{color:#ccc;font-size:14px}@media (max-width: 768px){.calendar-table[_ngcontent-%COMP%]{grid-template-columns:repeat(7,minmax(120px,1fr))}.day-header[_ngcontent-%COMP%], .training-time[_ngcontent-%COMP%]{font-size:12px}}.dayName[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.dayDate[_ngcontent-%COMP%]{font-size:12px;margin-top:-20px;text-decoration:none;font-weight:200}"]}),T})(),j=(()=>{var f;class T{constructor(e){this.http=e,this.apiUrl="https://k-studio.co.il/wp-json/training-music/v1",this.clientId="b46968a8339c459181a8fc6057ec0438",this.clientSecret="c7757feb5518452cafe80565af400216",this.refreshToken="AQC9oH-UuUUDtAsHJ1NBsvmWb634P8eFEFRT6i86SkTDNme8MSTV3g4gT-SJJVCbq-8xoja2TLbw5G0rntYZnFBFYElIwmVTU4MT3c8NLFNTmy1SDa3DmGkAc-G7aRc9yeg",this.spotifyUserId="",this.backupPlaylistId="37i9dQZF1DX76Wlfdnj7AP",this.getSpotifyUserId()}getSpotifyToken(){var e=this;return(0,s.A)(function*(){const o=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa(e.clientId+":"+e.clientSecret)},body:`grant_type=refresh_token&refresh_token=${e.refreshToken}`});if(!o.ok){const x=yield o.text();throw console.error("Spotify Token Error:",x),new Error("Failed to refresh Spotify token")}return(yield o.json()).access_token})()}getSpotifyUserId(){var e=this;return(0,s.A)(function*(){const o=yield e.getSpotifyToken(),p=yield fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${o}`}});if(!p.ok)return void console.error("Error fetching Spotify User ID");const x=yield p.json();e.spotifyUserId=x.id})()}searchSongs(e){var o=this;return(0,s.A)(function*(){var p;const x=yield o.getSpotifyToken(),k=yield fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track&limit=10`,{headers:{Authorization:`Bearer ${x}`}});if(!k.ok){const J=yield k.text();throw console.error("Spotify Search Error:",J),new Error("Failed to fetch songs from Spotify")}return((null===(p=(yield k.json()).tracks)||void 0===p?void 0:p.items)||[]).filter(J=>J&&J.duration_ms&&!isNaN(J.duration_ms))})()}getSongsForTraining(e){return this.http.get(`${this.apiUrl}/get-songs/?training_id=${e}`)}addSongToTraining(e,o,p){var x,k;const E={training_id:e,user_id:o,song_id:p.id,song_name:p.name,artist_name:(null===(x=p.artists[0])||void 0===x?void 0:x.name)||"UNKNOWN",artist_image:(null===(k=p.album)||void 0===k||null===(k=k.images[0])||void 0===k?void 0:k.url)||"UNKNOWN",duration_ms:p.duration_ms};return this.http.post(`${this.apiUrl}/add-song`,E)}removeSongFromTraining(e,o,p){return this.http.post(`${this.apiUrl}/remove-song/`,{training_id:e,user_id:o,song_id:p})}createPlaylist(e,o){var p=this;return(0,s.A)(function*(){if(!p.spotifyUserId)throw console.error("\u274c Spotify User ID not available"),new Error("Spotify User ID not available");yield p.deleteOldPlaylists();const x=o.reduce((O,z)=>{const J=z.duration_ms||(null==z?void 0:z.duration)||0,u="string"==typeof J?parseInt(J):J;return isNaN(u)?(console.warn(`\u26a0\ufe0f Invalid duration for song: ${z.song_name||"Unknown"}:`,J),O):O+u/1e3},0),k=yield p.getSpotifyToken(),E=`https://api.spotify.com/v1/users/${p.spotifyUserId}/playlists`;try{const O=yield p.http.post(E,{name:e,description:"Training Playlist",public:!1},{headers:new Y.Lr({Authorization:`Bearer ${k}`,"Content-Type":"application/json"})}).toPromise();if(null==O||!O.id)return console.error("\u274c Failed to create playlist: No ID returned"),null;const z=O.id;let J=[...o];if(x<3600){const _=3600-x,b=yield p.getBackupSongs(_);J=[...o,...b]}const u=J.map(_=>{const b=_.song_id||_.id;return b?`spotify:track:${b}`:(console.warn(`\u26a0\ufe0f Missing song ID for: ${_.song_name||"Unknown song"}`),null)}).filter(_=>null!==_);return 0===u.length?(console.error("\u274c No valid songs to add. Aborting playlist creation."),null):(yield p.addSongsToPlaylist(z,u),z)}catch(O){return console.error("\u274c Error creating playlist:",O),null}})()}getBackupSongs(e){var o=this;return(0,s.A)(function*(){const p=yield o.getSpotifyToken(),k=new Y.Lr({Authorization:`Bearer ${p}`});try{const E=yield o.http.get("https://api.spotify.com/v1/me/playlists",{headers:k}).toPromise();if(!E||!E.items)return console.error("Error: Unable to fetch user playlists.",E),[];const O=E.items.find(n=>n.name.toLowerCase().includes("backup"));if(!O)return console.error("\u274c Error: No backup playlist found."),[];const J=`https://api.spotify.com/v1/playlists/${O.id}/tracks`,u=yield o.http.get(J,{headers:k}).toPromise();if(!u||!u.items)return console.error("\u274c Error: No tracks found in backup playlist."),[];let _=u.items.map(n=>n.track);_=_.filter(n=>n&&n.id&&n.duration_ms&&!isNaN(n.duration_ms));let b=0;const i=[];for(const n of _){if(b+n.duration_ms/1e3>e)break;i.push(n),b+=n.duration_ms/1e3}return i}catch(E){return console.error("\u274c Error fetching backup songs:",E),[]}})()}addSongsToPlaylist(e,o){var p=this;return(0,s.A)(function*(){if(!e||"undefined"===e)return void console.error("\u274c Invalid playlist ID:",e);if(!o.length)return void console.error("\u274c No songs to add.");const x=yield p.getSpotifyToken(),k=`https://api.spotify.com/v1/playlists/${e}/tracks`,E=new Y.Lr({Authorization:`Bearer ${x}`,"Content-Type":"application/json"}),O={uris:o.filter(z=>z.startsWith("spotify:track:"))};if(0!==O.uris.length)try{yield p.http.post(k,O,{headers:E}).toPromise()}catch(z){console.error("\u274c Error adding songs to playlist:",z)}else console.error("\u274c No valid track URIs found. Aborting song addition.")})()}getUserPlaylist(){var e=this;return(0,s.A)(function*(){const o=yield e.getSpotifyToken(),x=new Y.Lr({Authorization:`Bearer ${o}`,"Content-Type":"application/json"});let k=[],E="https://api.spotify.com/v1/me/playlists?limit=50&market=US";try{for(;E;){let O="";if(O=yield e.http.get(E,{headers:x}).toPromise().catch(()=>({items:[],next:null})),!O||!O.items){console.warn("Spotify API returned an empty response.");break}k=k.concat(O.items),E=O.next}return k}catch(O){return console.error("Error fetching user playlists:",O),[]}})()}deleteOldPlaylists(){var e=this;return(0,s.A)(function*(){const o=yield e.getUserPlaylist(),p=new Date;p.setDate(p.getDate()-2);for(const x of o)x.name.startsWith("Training -")&&new Date(x.name.split(" - ")[1])<p&&(yield e.deletePlaylist(x.id))})()}deletePlaylist(e){var o=this;return(0,s.A)(function*(){const p=yield o.getSpotifyToken(),x=`https://api.spotify.com/v1/playlists/${e}/followers`,k=new Y.Lr({Authorization:`Bearer ${p}`,"Content-Type":"application/json"});try{yield o.http.delete(x,{headers:k}).toPromise()}catch(E){console.error(`Error deleting playlist ${e}`,E)}})()}}return(f=T).\u0275fac=function(e){return new(e||f)(t.KVO(Y.Qq))},f.\u0275prov=t.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),T})();var N=M(4796),X=M(9417);const nt=["searchInput"],ut=["selectedSongsList"],ht=(f,T)=>({"fade-in":f,"fade-out":T});function ft(f,T){1&f&&(t.j41(0,"div",14),t.nrm(1,"ion-spinner",15),t.k0s())}function C(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-button",22),t.bIt("click",function(){t.eBV(h);const o=t.XpG().$implicit,p=t.XpG(2);return t.Njj(p.addSong(o))}),t.nrm(1,"ion-icon",23),t.k0s()}}function G(f,T){if(1&f&&(t.j41(0,"ion-item",18)(1,"ion-thumbnail",19),t.nrm(2,"img",20),t.k0s(),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s()(),t.DNE(8,C,2,0,"ion-button",21),t.k0s()),2&f){const h=T.$implicit,e=t.XpG(2);t.R7$(2),t.Y8G("src",(null==h.album||null==h.album.images[0]?null:h.album.images[0].url)||"assets/default-artist.png",t.B4B),t.R7$(3),t.JRh(h.name),t.R7$(2),t.JRh(null==h.artists[0]?null:h.artists[0].name),t.R7$(),t.Y8G("ngIf",!e.isAddedToSelectedSongs(h))}}function rt(f,T){if(1&f&&(t.j41(0,"ion-list",16),t.DNE(1,G,9,4,"ion-item",17),t.k0s()),2&f){const h=t.XpG();t.R7$(),t.Y8G("ngForOf",h.searchResults)}}function dt(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-button",27),t.bIt("click",function(){t.eBV(h);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.removeSong(o))}),t.nrm(1,"ion-icon",28),t.k0s()}}function Lt(f,T){if(1&f&&(t.j41(0,"ion-item",24)(1,"ion-thumbnail",19),t.nrm(2,"img",25),t.k0s(),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s()(),t.DNE(8,dt,2,0,"ion-button",26),t.k0s()),2&f){const h=T.$implicit,e=t.XpG();t.Y8G("ngClass",t.l_i(5,ht,h.isNew,h.isFadingOut)),t.R7$(2),t.Y8G("src",h.artist_image,t.B4B),t.R7$(3),t.JRh(h.song_name),t.R7$(2),t.JRh(h.artist_name),t.R7$(),t.Y8G("ngIf",h.user_id===e.userId||"administrator"===e.userRole||"team"===e.userRole)}}function wt(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-fab",29)(1,"ion-fab-button",30),t.bIt("click",function(){t.eBV(h);const o=t.XpG();return t.Njj(o.createSpotifyPlaylist())}),t.nrm(2,"ion-icon",31),t.k0s()()}}let It=(()=>{var f;class T{constructor(e,o,p,x,k){this.modalCtrl=e,this.spotifyService=o,this.authService=p,this.toastController=x,this.animationCtrl=k,this.searchQuery="",this.searchResults=[],this.selectedSongs=[],this.userId="",this.userRole="",this.errorMessage="",this.isSearching=!1,this.userId=this.authService.getUserID(),this.userRole=this.authService.getUserRole()}ngOnInit(){this.loadTrainingSongs()}searchSongs(){var e=this;return(0,s.A)(function*(){if(e.searchQuery.trim()){e.isSearching=!0;try{e.searchResults=yield e.spotifyService.searchSongs(e.searchQuery)}catch(o){console.error("Search error:",o),e.presentToast("Failed to search songs","danger")}finally{e.isSearching=!1}}else e.searchResults=[]})()}addSong(e){var o,p;const x={song_id:e.id,song_name:e.name,artist_name:(null===(o=e.artists[0])||void 0===o?void 0:o.name)||"Unknown Artist",artist_image:(null===(p=e.album)||void 0===p||null===(p=p.images[0])||void 0===p?void 0:p.url)||"assets/default-artist.png",user_id:this.userId,duration_ms:e.duration_ms,isNew:!0,isFadingOut:!1};this.selectedSongs.some(k=>k.song_id===x.song_id)||this.selectedSongs.push(x),this.spotifyService.addSongToTraining(this.training.id,this.userId,e).subscribe(()=>{},k=>{console.error("Error adding song:",k),this.presentToast("Failed to add song","danger"),this.selectedSongs=this.selectedSongs.filter(E=>E.song_id!==x.song_id)}),this.clearSearch(),this.animateAddSong()}removeSong(e){const o=this.selectedSongs.findIndex(p=>p.song_id===e.song_id);-1!==o&&(this.selectedSongs[o].isFadingOut=!0,setTimeout(()=>{this.selectedSongs=this.selectedSongs.filter(p=>p.song_id!==e.song_id),this.spotifyService.removeSongFromTraining(this.training.id,this.userId,e.song_id).subscribe(()=>{},p=>{console.error("Error removing song:",p),this.presentToast("Failed to remove song","danger")})},300))}animateAddSong(){setTimeout(()=>{this.selectedSongsList&&this.animationCtrl.create().addElement(this.selectedSongsList.nativeElement).duration(300).fromTo("opacity","0.5","1").fromTo("transform","scale(0.95)","scale(1)").play()},50)}loadTrainingSongs(){this.spotifyService.getSongsForTraining(this.training.id).subscribe(e=>{this.selectedSongs=e.map(o=>({...o,artist_image:o.artist_image||"assets/default-artist.png"}))},e=>{console.error("Error fetching songs:",e),this.presentToast("Failed to load songs","danger")})}clearSearch(){this.searchQuery="",this.searchResults=[],this.searchInput&&(this.searchInput.nativeElement.value="",this.searchInput.nativeElement.blur())}isAddedToSelectedSongs(e){return this.selectedSongs.some(o=>o.song_id===e.id)}getTotalDuration(){const e=this.selectedSongs.reduce((k,E)=>{const O="string"==typeof E.duration_ms?parseInt(E.duration_ms):E.duration_ms;return k+(isNaN(O)?0:O)},0),o=Math.floor(e/1e3);return`${Math.floor(o/60)}:${(o%60).toString().padStart(2,"0")}`}saveSelection(){this.modalCtrl.dismiss(this.selectedSongs)}closeModal(){this.modalCtrl.dismiss()}presentToast(e,o){var p=this;return(0,s.A)(function*(){yield(yield p.toastController.create({message:e,duration:2500,color:o,position:"bottom"})).present()})()}createSpotifyPlaylist(){var e=this;return(0,s.A)(function*(){if(!e.selectedSongs.length)return void e.presentToast("No songs in the playlist!","danger");const o=`Training - ${e.training.start_time}`;try{if(!(yield e.spotifyService.createPlaylist(o,e.selectedSongs)))return console.error("\u274c Playlist creation failed."),void e.presentToast("Failed to create playlist","danger");e.presentToast("\u05d4\u05e4\u05dc\u05d9\u05d9\u05dc\u05d9\u05e1\u05d8 \u05e0\u05d5\u05e6\u05e8 \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4!","success")}catch(p){console.error("\u274c Error creating playlist:",p),e.presentToast("Failed to create playlist","danger")}})()}}return(f=T).\u0275fac=function(e){return new(e||f)(t.rXU(D.W3),t.rXU(j),t.rXU(N.u),t.rXU(D.K_),t.rXU(D.Hx))},f.\u0275cmp=t.VBU({type:f,selectors:[["app-music-modal"]],viewQuery:function(e,o){if(1&e&&(t.GBs(nt,5),t.GBs(ut,5)),2&e){let p;t.mGM(p=t.lsd())&&(o.searchInput=p.first),t.mGM(p=t.lsd())&&(o.selectedSongsList=p.first)}},inputs:{training:"training"},decls:19,vars:5,consts:[["searchInput",""],["selectedSongsList",""],[1,"music-modal-container"],["slot","end"],[1,"close-button",3,"click"],["name","close-outline"],[1,"search-container"],["placeholder","\u05d7\u05d9\u05e4\u05d5\u05e9",1,"custom-searchbar",3,"ngModelChange","ionInput","ionClear","ngModel"],["class","search-loading",4,"ngIf"],["class","search-results-list",4,"ngIf"],[1,"selected-songs-container"],[1,"selected-songs-list"],[3,"ngClass",4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end",4,"ngIf"],[1,"search-loading"],["name","lines-small","color","primary"],[1,"search-results-list"],["class","fade-in",4,"ngFor","ngForOf"],[1,"fade-in"],["slot","start"],[1,"song-thumbnail",3,"src"],["color","primary","fill","clear","class","add-song-btn",3,"click",4,"ngIf"],["color","primary","fill","clear",1,"add-song-btn",3,"click"],["name","add-circle-outline"],[3,"ngClass"],[1,"artist-image",3,"src"],["color","danger","fill","clear","class","remove-song-btn",3,"click",4,"ngIf"],["color","danger","fill","clear",1,"remove-song-btn",3,"click"],["name","trash-outline"],["slot","fixed","vertical","bottom","horizontal","end"],["color","success",3,"click"],["name","musical-notes-outline"]],template:function(e,o){if(1&e){const p=t.RV6();t.j41(0,"div",2)(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",3)(4,"ion-button",4),t.bIt("click",function(){return t.eBV(p),t.Njj(o.closeModal())}),t.nrm(5,"ion-icon",5),t.k0s()(),t.j41(6,"ion-title"),t.EFF(7,"\u05e4\u05dc\u05d9\u05d9\u05dc\u05d9\u05e1\u05d8 \u05d0\u05d9\u05de\u05d5\u05df"),t.k0s()()(),t.j41(8,"ion-content")(9,"div",6)(10,"ion-searchbar",7,0),t.mxI("ngModelChange",function(k){return t.eBV(p),t.DH7(o.searchQuery,k)||(o.searchQuery=k),t.Njj(k)}),t.bIt("ionInput",function(){return t.eBV(p),t.Njj(o.searchSongs())})("ionClear",function(){return t.eBV(p),t.Njj(o.clearSearch())}),t.k0s(),t.DNE(12,ft,2,0,"div",8),t.k0s(),t.DNE(13,rt,2,1,"ion-list",9),t.j41(14,"div",10)(15,"ion-list",11,1),t.DNE(17,Lt,9,8,"ion-item",12),t.k0s(),t.DNE(18,wt,3,0,"ion-fab",13),t.k0s()()()}2&e&&(t.R7$(10),t.R50("ngModel",o.searchQuery),t.R7$(2),t.Y8G("ngIf",o.isSearching),t.R7$(),t.Y8G("ngIf",o.searchResults.length>0),t.R7$(4),t.Y8G("ngForOf",o.selectedSongs),t.R7$(),t.Y8G("ngIf","administrator"===o.userRole||"team"===o.userRole))},dependencies:[F.YU,F.Sq,F.bT,X.BC,X.vS,D.Jm,D.QW,D.W9,D.Q8,D.YW,D.eU,D.iq,D.uz,D.he,D.nf,D.S1,D.w2,D.Zx,D.BC,D.ai,D.Gw],styles:[".music-modal-container[_ngcontent-%COMP%]{--background: #f4f5f8;height:100%;display:flex;flex-direction:column;background:linear-gradient(135deg,#f4f5f8,#e9ecef)}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--border-width: 0}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#333;transition:transform .2s ease}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{transform:scale(.9)}.music-modal-container[_ngcontent-%COMP%]   .fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.music-modal-container[_ngcontent-%COMP%]   .fade-out[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeOut .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_fadeOut{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.95)}}.music-modal-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-size:1.1em;font-family:Alef;line-height:15px}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;padding:10px;background-color:#fff}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .custom-searchbar[_ngcontent-%COMP%]{--background: #f0f0f0;transition:all .3s ease}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .custom-searchbar[_ngcontent-%COMP%]:focus{--background: #e0e0e0;box-shadow:0 2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-loading[_ngcontent-%COMP%]{position:absolute;top:50%;right:20px;transform:translateY(-50%)}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{transition:background-color .3s ease}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:active{background-color:#0000000d}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .song-thumbnail[_ngcontent-%COMP%]{border-radius:8px;transition:transform .2s ease}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .song-thumbnail[_ngcontent-%COMP%]:active{transform:scale(.95)}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;background-color:#fff;box-shadow:0 -4px 6px #0000000d}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;background-color:#f8f9fa}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:600;color:#333}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]   .total-duration[_ngcontent-%COMP%]{color:#6c757d;font-size:.9em;background-color:#e9ecef;padding:5px 10px;border-radius:15px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]{height:calc(100% - 60px);overflow-y:auto;background-color:#fff;scrollbar-width:thin;scrollbar-color:#ccc #f1f3f5}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f3f5;border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#ccc;border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 15px;--inner-padding-end: 15px;margin:5px 0;border-radius:10px;transition:background-color .3s ease}.music-modal-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{--background: #f4f4f4}.music-modal-container[_ngcontent-%COMP%]   .artist-image[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;object-fit:cover;box-shadow:0 2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]{padding:10px;background-color:#fff;box-shadow:0 -2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]   .save-playlist-btn[_ngcontent-%COMP%]{margin:0;height:50px;--border-radius: 10px;transition:all .3s ease}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]   .save-playlist-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"],data:{animation:[(0,I.hZ)("songListAnimation",[(0,I.kY)(":enter",[(0,I.P)(":enter",[(0,I.iF)({opacity:0,transform:"translateY(20px)"}),(0,I.yc)(50,[(0,I.i0)("300ms ease-out",(0,I.iF)({opacity:1,transform:"translateY(0)"}))])],{optional:!0})]),(0,I.kY)(":leave",[(0,I.P)(":leave",[(0,I.i0)("200ms ease-in",(0,I.iF)({opacity:0,transform:"translateX(-100%)"}))],{optional:!0})])])]}}),T})();var yt=M(3656),lt=M(8507);const et=["popup"],st=["segmentScroll"],B=["indicator"],S=["segmentButton"],K=f=>({background:f}),mt=()=>[1,2,3,4],at=(f,T)=>({"card--shalom":f,"card--other":T}),_t=(f,T,h,e)=>({"standby-enrolled":f,loading:T,success:h,error:e}),St=(f,T)=>({loading:f,success:T});function Vt(f,T){1&f&&(t.j41(0,"ion-segment-button",15)(1,"ion-label"),t.EFF(2,"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"),t.k0s()())}function Tt(f,T){1&f&&(t.j41(0,"ion-segment-button",16)(1,"ion-label"),t.EFF(2,"\u05d4\u05d9\u05e8\u05e7\u05d5\u05df"),t.k0s()())}function xt(f,T){if(1&f){const h=t.RV6();t.qex(0),t.j41(1,"button",22,2),t.bIt("click",function(){const o=t.eBV(h).$implicit,p=t.XpG(2);return t.Njj(p.onDayChange(o.date))}),t.j41(3,"span",23),t.EFF(4),t.k0s(),t.j41(5,"span",23),t.EFF(6),t.k0s()(),t.bVm()}if(2&f){const h=T.$implicit,e=t.XpG(2);t.R7$(),t.AVh("active",e.selectedDay===h.date),t.Y8G("ngStyle",e.selectedDay===h.date?t.eq3(5,K,"shalom"===e.selectedFilterAllFav?"#ff8366":"#59c7cd"):null),t.R7$(3),t.SpI("",h.day," "),t.R7$(2),t.JRh(h.formattedDate)}}function Rt(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-icon",32),t.bIt("click",function(){t.eBV(h);const o=t.XpG(4);return t.Njj(o.openCalendarPopup())}),t.k0s()}}function Zt(f,T){if(1&f&&(t.j41(0,"button",29)(1,"i",30),t.DNE(2,Rt,1,0,"ion-icon",31),t.k0s()()),2&f){const h=t.XpG(3);t.R7$(2),t.Y8G("ngIf",!h.isTrainer)}}function Gt(f,T){if(1&f){const h=t.RV6();t.j41(0,"div",24)(1,"button",25),t.bIt("click",function(o){t.eBV(h);const p=t.XpG(2);return t.Njj(p.toggleFilterDropdown(o))}),t.j41(2,"i",26),t.nrm(3,"ion-icon",27),t.k0s()(),t.DNE(4,Zt,3,1,"button",28),t.k0s()}if(2&f){const h=t.XpG(2);t.R7$(),t.Y8G("@buttonState",h.getDropdownState()),t.R7$(3),t.Y8G("ngIf","trainer"!==h.userRole)}}function Pt(f,T){if(1&f&&(t.j41(0,"ion-select-option",41),t.EFF(1),t.k0s()),2&f){const h=T.$implicit;t.Y8G("value",h),t.R7$(),t.JRh(h)}}function Ct(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-button",42),t.bIt("click",function(){t.eBV(h);const o=t.XpG(3);return t.Njj(o.resetTypeFilter())}),t.nrm(1,"ion-icon",43),t.k0s()}}function Nt(f,T){if(1&f){const h=t.RV6();t.j41(0,"ion-list",33),t.bIt("@dropdownState.done",function(o){t.eBV(h);const p=t.XpG(2);return t.Njj(p.dropdownAnimationDone(o))}),t.j41(1,"ion-item")(2,"ion-label",34),t.EFF(3,"\u05e1\u05d5\u05d2 \u05d0\u05d9\u05de\u05d5\u05df"),t.k0s(),t.j41(4,"ion-select",35),t.mxI("ngModelChange",function(o){t.eBV(h);const p=t.XpG(2);return t.DH7(p.selectedType,o)||(p.selectedType=o),t.Njj(o)}),t.bIt("ionChange",function(){t.eBV(h);const o=t.XpG(2);return t.Njj(o.onTypeChange())}),t.DNE(5,Pt,2,2,"ion-select-option",36),t.k0s(),t.DNE(6,Ct,2,0,"ion-button",37),t.k0s(),t.j41(7,"ion-item")(8,"ion-label",34),t.EFF(9,"\u05d6\u05de\u05d9\u05e0\u05d5\u05ea"),t.k0s(),t.j41(10,"ion-segment",38),t.mxI("ngModelChange",function(o){t.eBV(h);const p=t.XpG(2);return t.DH7(p.availabilityFilter,o)||(p.availabilityFilter=o),t.Njj(o)}),t.bIt("ionChange",function(){t.eBV(h);const o=t.XpG(2);return t.Njj(o.onFilterChange())}),t.j41(11,"ion-segment-button",39)(12,"ion-label"),t.EFF(13,"\u05d4\u05db\u05dc"),t.k0s()(),t.j41(14,"ion-segment-button",40)(15,"ion-label"),t.EFF(16,"\u05d6\u05de\u05d9\u05df \u05d1\u05dc\u05d1\u05d3"),t.k0s()()()()()}if(2&f){const h=t.XpG(2);t.Y8G("@dropdownState",h.getDropdownState()),t.R7$(4),t.R50("ngModel",h.selectedType),t.R7$(),t.Y8G("ngForOf",h.availableTypes),t.R7$(),t.Y8G("ngIf",h.selectedType),t.R7$(4),t.R50("ngModel",h.availabilityFilter)}}function Qt(f,T){if(1&f&&(t.j41(0,"div")(1,"div",17)(2,"div",18,1),t.DNE(4,xt,7,7,"ng-container",19),t.k0s()(),t.DNE(5,Gt,5,2,"div",20)(6,Nt,17,5,"ion-list",21),t.k0s()),2&f){const h=t.XpG();t.R7$(4),t.Y8G("ngForOf",h.days),t.R7$(),t.Y8G("ngIf",!h.showSkeleton),t.R7$(),t.Y8G("ngIf",h.showDropdown||h.isAnimating)}}function Yt(f,T){1&f&&(t.j41(0,"ion-item",47)(1,"ion-thumbnail",48),t.nrm(2,"ion-skeleton-text",49),t.k0s(),t.j41(3,"ion-label")(4,"h3"),t.nrm(5,"ion-skeleton-text",50),t.k0s(),t.j41(6,"p"),t.nrm(7,"ion-skeleton-text",51),t.k0s(),t.j41(8,"p"),t.nrm(9,"ion-skeleton-text",52),t.k0s()()()),2&f&&(t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0))}function Kt(f,T){1&f&&(t.j41(0,"ion-list",44)(1,"ion-list-header"),t.nrm(2,"ion-skeleton-text",45),t.k0s(),t.DNE(3,Yt,10,4,"ion-item",46),t.k0s()),2&f&&(t.R7$(2),t.Y8G("animated",!0),t.R7$(),t.Y8G("ngForOf",t.lJ4(2,mt)))}function Jt(f,T){1&f&&(t.j41(0,"span"),t.EFF(1,", "),t.k0s())}function qt(f,T){if(1&f&&(t.j41(0,"span"),t.EFF(1),t.DNE(2,Jt,2,0,"span",12),t.k0s()),2&f){const h=T.$implicit,e=T.index,o=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",h,""),t.R7$(),t.Y8G("ngIf",e<o.current_participants.length-1)}}function te(f,T){if(1&f&&(t.j41(0,"div",68),t.DNE(1,qt,3,2,"span",19),t.k0s()),2&f){const h=t.XpG().$implicit;t.R7$(),t.Y8G("ngForOf",h.current_participants)}}function gt(f,T){if(1&f&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&f){const h=T.$implicit;t.R7$(),t.SpI(" ",h," ")}}function ee(f,T){if(1&f&&(t.j41(0,"div",69)(1,"div",70),t.EFF(2),t.j41(3,"div",71)(4,"ul"),t.DNE(5,gt,2,1,"li",19),t.k0s()()()()),2&f){const h=t.XpG().$implicit,e=t.XpG();t.Y8G("ngClass",e.capacityState(h)),t.R7$(2),t.Lme(" ",h.booked,"/",h.total_participants," "),t.R7$(3),t.Y8G("ngForOf",h.current_participants)}}function ot(f,T){if(1&f&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&f){const h=T.$implicit;t.R7$(),t.SpI(" ",h," ")}}function Bt(f,T){if(1&f&&(t.j41(0,"div",74)(1,"ul"),t.DNE(2,ot,2,1,"li",19),t.k0s()()),2&f){const h=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ngForOf",h.current_participants)}}function Et(f,T){if(1&f){const h=t.RV6();t.j41(0,"div",69)(1,"div",72),t.bIt("mouseenter",function(){t.eBV(h);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.showParticipantsPopup(o))})("mouseleave",function(){t.eBV(h);const o=t.XpG(2);return t.Njj(o.hideParticipantsPopup())}),t.EFF(2),t.DNE(3,Bt,3,1,"div",73),t.k0s()()}if(2&f){const h=t.XpG().$implicit,e=t.XpG();t.Y8G("ngClass",e.capacityState(h)),t.R7$(2),t.Lme(" ",h.booked,"/",h.total_participants," "),t.R7$(),t.Y8G("ngIf",e.isPopupVisible&&e.activeAppointment===h)}}function jt(f,T){1&f&&(t.qex(0),t.j41(1,"button",76),t.nrm(2,"ion-icon",77),t.EFF(3," \u05e8\u05e9\u05d5\u05dd "),t.k0s(),t.bVm())}function Dt(f,T){1&f&&(t.qex(0),t.EFF(1," \u05e8\u05e9\u05d5\u05dd \u05dc\u05d4\u05de\u05ea\u05e0\u05d4 "),t.bVm())}function At(f,T){1&f&&(t.qex(0),t.EFF(1," \u05d4\u05e8\u05e9\u05de\u05d4 \u05dc\u05d4\u05de\u05ea\u05e0\u05d4 "),t.bVm())}function Mt(f,T){1&f&&(t.qex(0),t.nrm(1,"ion-spinner",81),t.bVm())}function Ft(f,T){1&f&&(t.qex(0),t.nrm(1,"ion-icon",77),t.bVm())}function $t(f,T){1&f&&(t.qex(0),t.nrm(1,"ion-icon",82),t.bVm())}function kt(f,T){if(1&f){const h=t.RV6();t.j41(0,"button",80),t.bIt("click",function(){let o;t.eBV(h);const p=t.XpG(3).$implicit,x=t.XpG();return t.Njj(x.addToStandbyList(null!==(o=p)&&void 0!==o?o:0,x.userId,x.userEmail))}),t.DNE(1,Dt,2,0,"ng-container",12)(2,At,2,0,"ng-container",12)(3,Mt,2,0,"ng-container",12)(4,Ft,2,0,"ng-container",12)(5,$t,2,0,"ng-container",12),t.k0s()}if(2&f){const h=t.XpG(3).$implicit;t.Y8G("ngClass",t.ziG(7,_t,h.isStandbyEnrolled,h.isStandbyLoading&&!h.isStandbyEnrolled,h.isStandbySuccess&&!h.isStandbyEnrolled,h.isError&&!h.isStandbyEnrolled))("disabled",h.isStandbyEnrolled||h.isStandbyLoading||h.isStandbySuccess||h.isError),t.R7$(),t.Y8G("ngIf",h.isStandbyEnrolled),t.R7$(),t.Y8G("ngIf",!(h.isStandbyEnrolled||h.isStandbyLoading||h.isStandbySuccess||h.isError)),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isStandbyLoading),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isStandbySuccess),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isError)}}function Ot(f,T){1&f&&(t.qex(0),t.EFF(1,"\u05d4\u05e8\u05e9\u05de\u05d4"),t.bVm())}function Ht(f,T){1&f&&(t.qex(0),t.nrm(1,"ion-spinner",81),t.bVm())}function ie(f,T){1&f&&(t.qex(0),t.nrm(1,"ion-icon",77),t.bVm())}function Xt(f,T){if(1&f){const h=t.RV6();t.j41(0,"button",83),t.bIt("click",function(){t.eBV(h);const o=t.XpG(3).$implicit,p=t.XpG();return t.Njj(p.enrollUser(o))}),t.DNE(1,Ot,2,0,"ng-container",12)(2,Ht,2,0,"ng-container",12)(3,ie,2,0,"ng-container",12),t.k0s()}if(2&f){const h=t.XpG(3).$implicit;t.Y8G("disabled",h.isLoading||h.isSuccess)("ngClass",t.l_i(5,St,h.isLoading,h.isSuccess)),t.R7$(),t.Y8G("ngIf",!h.isLoading&&!h.isSuccess),t.R7$(),t.Y8G("ngIf",h.isLoading),t.R7$(),t.Y8G("ngIf",h.isSuccess)}}function zt(f,T){if(1&f&&(t.qex(0),t.DNE(1,kt,6,12,"button",78)(2,Xt,4,8,"button",79),t.bVm()),2&f){const h=t.XpG(2).$implicit;t.R7$(),t.Y8G("ngIf",h.booked===h.total_participants),t.R7$(),t.Y8G("ngIf",h.booked<h.total_participants)}}function Ut(f,T){if(1&f&&(t.j41(0,"div",75),t.DNE(1,jt,4,0,"ng-container",12)(2,zt,3,2,"ng-container",12),t.k0s()),2&f){const h=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",h.isUserBooked),t.R7$(),t.Y8G("ngIf",!h.isUserBooked)}}function ne(f,T){if(1&f){const h=t.RV6();t.j41(0,"div",53)(1,"div",54)(2,"div",55),t.EFF(3),t.nI1(4,"date"),t.k0s(),t.j41(5,"div",56)(6,"ion-icon",57),t.bIt("click",function(){const o=t.eBV(h).$implicit,p=t.XpG();return t.Njj(p.toggleFavorite(o))}),t.k0s(),t.j41(7,"ion-icon",58),t.bIt("click",function(){const o=t.eBV(h).$implicit,p=t.XpG();return t.Njj(p.openMusicModal(o))}),t.k0s()()(),t.j41(8,"div",59)(9,"h3",60),t.EFF(10),t.k0s(),t.DNE(11,te,2,1,"div",61)(12,ee,6,4,"div",62)(13,Et,4,4,"div",62),t.k0s(),t.j41(14,"div",63)(15,"div",64)(16,"div",65),t.nrm(17,"div",66),t.k0s()()(),t.DNE(18,Ut,3,2,"div",67),t.k0s()}if(2&f){const h=T.$implicit,e=t.XpG();t.Y8G("ngClass",t.l_i(15,at,643===h.providerId,169===h.providerId)),t.R7$(3),t.SpI(" ",t.i5U(4,12,h.start_time,"HH:mm")," "),t.R7$(3),t.AVh("favorite",h.favorite),t.R7$(4),t.JRh(h.title.name),t.R7$(),t.Y8G("ngIf",e.isAdminOrTrainer),t.R7$(),t.Y8G("ngIf",e.isAdminOrTrainer),t.R7$(),t.Y8G("ngIf",!e.isAdminOrTrainer),t.R7$(4),t.xc7("width",h.progressPercentage+"%"),t.Y8G("ngStyle",t.eq3(18,K,643===h.providerId?"linear-gradient(90deg, #ff8366 0%, #ff3000 100%)":"linear-gradient(-90deg, #59c7cd 0%, #00eaf5 100%)")),t.R7$(),t.Y8G("ngIf",!e.isAdminOrTrainer)}}let ae=(()=>{var f;class T{get showSkeleton(){return"shalom"===this.selectedFilterAllFav&&this.isShalomLoading||"all"===this.selectedFilterAllFav&&this.isBenYehudaLoading}constructor(e,o,p,x,k,E,O){var z;this.platform=e,this.toastController=o,this.modalCtrl=p,this.http=x,this.authService=k,this.modalCalendar=E,this.apptCache=O,this.USE_APPT_CACHE=!0,this.cachedAppointments=[],this.cachedByDate={},this.scheduleItems=[],this.scheduleByDate={},this.customerID="",this.userEmail="",this.userFavLocation="",this.userRole="",this.isTrainer=!1,this.showingParticipants=!1,this.isPopupVisible=!1,this.activeAppointment=null,this.selectedFilterAllFav="all",this.selectedType="",this.availabilityFilter="all",this.showDropdown=!1,this.availableTypes=[],this.appointments=[],this.filteredAppointments=[],this.bookedAppointments=[],this.combinedList=[],this.days=[],this.knownTrainingTypes=["\u05e4\u05d9\u05dc\u05d0\u05d8\u05d9\u05e1","\u05d9\u05d5\u05d2\u05d4","\u05d0\u05d9\u05de\u05d5\u05df \u05db\u05d5\u05d7","Parallel 15","Spinning","TRX","Booty&ABS","All In","HiiT","POWER",""],this.availableTimeslots=[],this.unfilteredList=[],this.PROVIDER_BEN_YEHUDA=169,this.PROVIDER_HAYARKON=643,this.isLoading=!0,this.isStandbyLoading=!1,this.isStandbySuccess=!1,this.isEnrollLoading=!1,this.isEnrollSuccess=!1,this.showToast=!1,this.toastMessage="",this.toastColor="success",this.errorMessage="",this.currentDateRange=null,this.allAvailableDays=[],this.tabLoadingState=!1,this.indicatorPosition=357,this.indicatorWidth=20,this.benYehudaDays=[],this.shalomDays=[],this.benYehudaAppointments=[],this.shalomAppointments=[],this.benYehudaTimeslots=[],this.shalomTimeslots=[],this.benYehudaLoaded=!1,this.shalomLoaded=!1,this.isShalomLoading=!1,this.isBenYehudaLoading=!0,this.userId=this.authService.getUserID(),this.userEmail=this.authService.getUserEmail(),this.customerID=this.authService.getCustomerID(),this.userFavLocation=this.authService.getUserFavLocation(),this.userRole=this.authService.getUserRole(),this.isAdminOrTrainer=["administrator","team"].includes(null!==(z=this.userRole)&&void 0!==z?z:""),this.authService.fetchPackageCustomerId(this.customerID).subscribe({error:J=>{console.error("Error fetching package id",J)}})}ngOnInit(){var e=this;return(0,s.A)(function*(){e.isLoading=!0;try{if("trainer"===e.userRole)e.PROVIDER_BEN_YEHUDA=172,e.PROVIDER_HAYARKON=644;else if("activesubscription"===e.userRole)e.PROVIDER_BEN_YEHUDA=169,e.PROVIDER_HAYARKON=643;else{if("inactive"===e.userRole)return void e.presentToast("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d8\u05e2\u05d5\u05df \u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd, \u05d4\u05de\u05e9\u05ea\u05de\u05e9 \u05dc\u05d0 \u05e4\u05e2\u05d9\u05dc","danger");if("trial-users"===e.userRole)return void e.presentToast("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d8\u05e2\u05d5\u05df \u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd, \u05de\u05e9\u05ea\u05de\u05e9 \u05e0\u05d9\u05e1\u05d9\u05d5\u05df","danger")}const o=e.authService.getUserFavLocation();e.userFavLocation=o,"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===e.userFavLocation||"\u05d4\u05db\u05dc"===e.userFavLocation?e.selectedFilterAllFav="all":"\u05d4\u05d9\u05e8\u05e7\u05d5\u05df"===e.userFavLocation&&(e.selectedFilterAllFav="shalom")}catch(o){console.error("Error during initialization:",o),e.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05de\u05e9\u05d9\u05db\u05ea \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd","danger")}finally{e.isLoading=!1}})()}ionViewWillEnter(){var e=this;return(0,s.A)(function*(){e.USE_APPT_CACHE&&(yield e.loadScheduleFromCacheIfPossible())?e.filterFavAll({detail:{value:e.selectedFilterAllFav}}):(console.warn("[TrainingsPage] Cache empty or disabled \u2192 fallback legacy load"),e.USE_APPT_CACHE&&e.apptCache.schedule$.subscribe(o=>{null!=o&&o.length&&(e.scheduleItems=o,e.appointments=e.mapScheduleToTrainingCards(o),console.log("appointments1:",e.appointments),e.indexScheduleByDate(),e.applyScheduleToUI(),e.filterFavAll(e.selectedFilterAllFav))}))})()}loadScheduleFromCacheIfPossible(){var e=this;return(0,s.A)(function*(){try{const o=yield e.apptCache.ensureScheduleLoaded(20);return o&&o.length?(e.scheduleItems=o,e.appointments=e.mapScheduleToTrainingCards(o),e.combinedList=[...e.appointments],e.unfilteredList=[...e.appointments],e.indexScheduleByDate(),e.extractAvailableDaysFromCache(),e.applyScheduleToUI(),e.isBenYehudaLoading=!1,e.isShalomLoading=!1,e.isLoading=!1,e.updateFilteredAppointments(),!0):(console.log("[TrainingsPage] Cache is empty"),!1)}catch(o){return console.error("[TrainingsPage] Cache load failed:",o),!1}})()}extractAvailableDaysFromCache(){const e=["\u05d0'","\u05d1'","\u05d2'","\u05d3'","\u05d4'","\u05d5'","\u05e9'"],o=(new Date).toISOString().split("T")[0];let p=null;"all"===this.selectedFilterAllFav?p=this.PROVIDER_BEN_YEHUDA:"shalom"===this.selectedFilterAllFav&&(p=this.PROVIDER_HAYARKON);let x=this.scheduleItems;null!==p&&(x=this.scheduleItems.filter(O=>O.providerId===p));const E=Array.from(new Set(x.map(O=>O.date).filter(O=>O))).map(O=>{const z=new Date(O);return{date:O,day:e[z.getDay()],formattedDate:`${z.getDate()}.${z.getMonth()+1}`}});E.sort((O,z)=>O.date===o?-1:z.date===o?1:new Date(O.date).getTime()-new Date(z.date).getTime()),this.days=E,this.selectedDay=this.days.length>0?this.days[0].date:""}mapScheduleToTrainingCards(e){const o=this.getFavoriteTrainings();return e.map(p=>{var x,k,E,O,z;return{id:p.appointmentId,type:"training",appointmentId:p.appointmentId,providerId:p.providerId,serviceId:null!==(x=p.serviceId)&&void 0!==x?x:0,start_time:p.startTime,title:{name:p.serviceName},booked:null!==(k=p.booked)&&void 0!==k?k:0,total_participants:null!==(E=p.capacity)&&void 0!==E?E:null!==(O=p.booked)&&void 0!==O?O:0,current_participants:[],isUserBooked:!!p.isUserBooked,isTrainer:!!p.isTrainer,favorite:o.includes(p.appointmentId),songsCount:0,progressPercentage:null!==(z=p.progressPercentage)&&void 0!==z?z:0}})}indexScheduleByDate(){const e={};for(const p of this.scheduleItems){var o;p.date&&(e[o=p.date]||(e[o]=[])).push(p)}for(const p in e)e[p].sort((x,k)=>x.startTime.localeCompare(k.startTime));this.scheduleByDate=e}applyScheduleToUI(){var e;if(null!==(e=this.days)&&void 0!==e&&e.length)for(const o of this.days){const x=this.scheduleByDate[o.date]||[];let k=x;"all"===this.selectedFilterAllFav?k=x.filter(E=>E.providerId===this.PROVIDER_BEN_YEHUDA):"shalom"===this.selectedFilterAllFav&&(k=x.filter(E=>E.providerId===this.PROVIDER_HAYARKON)),o.scheduleItems=k}}openTrainerAppointment(e){var o=this;return(0,s.A)(function*(){try{const p=yield o.apptCache.loadParticipants(e.appointmentId);o.presentParticipantsModal(e,p)}catch(p){console.error("Failed to load participants",p)}})()}presentParticipantsModal(e,o){console.log("Participants for appt",e.appointmentId,o)}hasTrainerAppts(e){const o=this.cachedByDate[e];return!(!o||!o.some(p=>p.isTrainer))}presentToast(e,o){var p=this;return(0,s.A)(function*(){yield(yield p.toastController.create({message:e,duration:3e3,color:o,position:"bottom"})).present()})()}extractAvailableTypes(){const e=new Set(this.filteredAppointments.map(o=>o.title.name));this.availableTypes=Array.from(e)}onDayChange(e){const o=String(e||"");this.selectedDay=o,this.updateFilteredAppointments()}filterFavAll(e){var o=this;return(0,s.A)(function*(){const p="string"==typeof e?e:e.detail.value;if(o.selectedFilterAllFav=p,o.isAdminOrTrainer){const x=o.scheduleItems;return o.combinedList=o.mapScheduleToTrainingCards(x),o.unfilteredList=[...o.combinedList],console.log("combinedList:",o.combinedList),o.extractAvailableDaysFromFilteredData(x),void o.updateFilteredAppointments()}if("favorites"===p){const x=o.getFavoriteTrainings();return o.filteredAppointments=o.unfilteredList.filter(k=>x.includes(k.id)),void o.extractAvailableDaysFromCache()}"all"===p?o.isBenYehudaLoading=!0:"shalom"===p&&(o.isShalomLoading=!0);try{if(o.USE_APPT_CACHE&&o.scheduleItems.length>0){const x="all"===p?o.PROVIDER_BEN_YEHUDA:o.PROVIDER_HAYARKON,k=o.scheduleItems.filter(E=>E.providerId===x);o.combinedList=o.mapScheduleToTrainingCards(k),o.unfilteredList=[...o.combinedList],o.extractAvailableDaysFromFilteredData(k),o.updateFilteredAppointments()}}finally{"all"===p?o.isBenYehudaLoading=!1:o.isShalomLoading=!1}})()}extractAvailableDaysFromFilteredData(e){const o=["\u05d0'","\u05d1'","\u05d2'","\u05d3'","\u05d4'","\u05d5'","\u05e9'"],p=(new Date).toISOString().split("T")[0],k=Array.from(new Set(e.map(E=>E.date).filter(E=>E))).map(E=>{const O=new Date(E);return{date:E,day:o[O.getDay()],formattedDate:`${O.getDate()}.${O.getMonth()+1}`}});k.sort((E,O)=>E.date===p?-1:O.date===p?1:new Date(E.date).getTime()-new Date(O.date).getTime()),this.days=k,this.selectedDay=this.days.length>0?this.days[0].date:""}toggleAvailabilityFilter(){this.availabilityFilter="all"===this.availabilityFilter?"available":"all",this.updateFilteredAppointments()}updateFilteredAppointments(){let e=[...this.unfilteredList];this.selectedDay&&(e=e.filter(o=>W(o.start_time).format("YYYY-MM-DD")===this.selectedDay)),"available"===this.availabilityFilter&&(e=e.filter(o=>o.booked<o.total_participants)),this.selectedType&&(e=e.filter(o=>o.title.name===this.selectedType)),"favorites"===this.selectedFilterAllFav&&(e=e.filter(o=>o.favorite)),e.sort((o,p)=>new Date(o.start_time).getTime()-new Date(p.start_time).getTime()),this.filteredAppointments=[...e],this.extractAvailableTypes()}onFilterChange(){this.updateFilteredAppointments()}onTypeChange(){this.updateFilteredAppointments()}resetTypeFilter(){this.selectedType="",this.updateFilteredAppointments()}removePastFavorites(){const e=new Date,p=this.getFavoriteTrainings().filter(x=>{const k=this.combinedList.find(E=>E.id===x);return k&&new Date(k.start_time)>e});this.saveFavoriteTrainings(p)}closeModal(){document.body.classList.remove("no-scroll"),this.modalCtrl.dismiss()}toggleFavorite(e){e.favorite=!e.favorite;const o=this.getFavoriteTrainings();if(e.favorite)o.includes(e.id)||o.push(e.id);else{const p=o.indexOf(e.id);p>-1&&o.splice(p,1)}this.saveFavoriteTrainings(o),"favorites"===this.selectedFilterAllFav&&this.updateFilteredAppointments()}getFavoriteTrainings(){const e=localStorage.getItem("favoriteTrainings");return e?JSON.parse(e):[]}saveFavoriteTrainings(e){localStorage.setItem("favoriteTrainings",JSON.stringify(e))}toggleFilterDropdown(e){e&&e.stopPropagation(),!this.isAnimating&&(this.showDropdown=!this.showDropdown,this.isAnimating=!0,this.showDropdown?document.body.classList.add("no-scroll"):document.body.classList.remove("no-scroll"))}handleOutsideClick(e){var o;const p=e.target,x=document.querySelector(".filter-dropdown"),k=null===(o=document.querySelector(".filter-icon"))||void 0===o?void 0:o.parentElement,E=document.querySelector(".training-list");this.showDropdown&&x&&k&&!x.contains(p)&&!k.contains(p)&&(null==E||!E.contains(p))&&(this.showDropdown=!1,document.body.classList.remove("no-scroll"))}dropdownAnimationDone(e){"closed"!==e.toState||this.showDropdown?"open"===e.toState&&this.showDropdown&&(this.isAnimating=!1):this.isAnimating=!1}getDropdownState(){return this.showDropdown?"open":"closed"}capacityRatio(e){var o;const p=null!==(o=null==e?void 0:e.total_participants)&&void 0!==o?o:0;return p>0?e.booked/p:0}capacityState(e){const o=this.capacityRatio(e);return 0===o?"empty":o<.25?"low":o<.75?"medium":o<1?"high":1===o?"full":"over"}showParticipantsPopup(e){var o=this;return(0,s.A)(function*(){var p;if(o.activeAppointment=e,o.isPopupVisible=!0,!(null!==(p=e.current_participants)&&void 0!==p&&p.length||e.participantsLoaded)){e.participantsLoaded=!0;try{const x=yield o.apptCache.loadParticipants(e.appointmentId);e.current_participants=x.map(k=>k.name||k.email||"\u05de\u05e9\u05ea\u05ea\u05e3")}catch(x){console.error("participants load failed",x),e.current_participants=[]}}})()}hideParticipantsPopup(){this.activeAppointment=null,this.isPopupVisible=!1}addToStandbyList(e,o,p){e.isStandbyLoading=!0,e.isStandbySuccess=!1;const k={appointment_id:null==e?void 0:e.id,customer_id:o,email:p};console.log("data",k),this.http.post("https://k-studio.co.il/wp-json/standby-list/v1/add",k).subscribe(()=>{e.isStandbyLoading=!1,e.isStandbySuccess=!0,this.apptCache.invalidate().then(()=>this.apptCache.ensureLoaded(!0)),this.apptCache.invalidateSchedule().then(()=>this.apptCache.ensureScheduleLoaded(20,!0))},E=>{console.error("Error adding user to standby list",E),e.isStandbyLoading=!1,this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4","danger")})}checkStandbyEnrollment(e,o){const x=(new Y.Nl).set("email",e).set("trainingId",o.toString());return(0,ct._)(this.http.get("https://k-studio.co.il/wp-json/standby-list/v1/check",{params:x})).then(k=>k.isEnrolled).catch(k=>(console.error("Error checking standby enrollment",k),!1))}enrollUser(e){e.isLoading=!0,e.isSuccess=!1,e.isError=!1;let o=e.serviceId;const x=e.start_time.slice(0,16);let k=e.providerId,E=this.authService.getCustomerID(),O=this.authService.getPackageCustomerId();const u={type:"appointment",serviceId:o,providerId:k,locationId:null,notifyParticipants:0,bookings:[{customerId:E,status:"approved",duration:3600,persons:1,extras:[],customFields:{},utcOffset:-(new Date).getTimezoneOffset(),packageCustomerService:{packageCustomer:{id:O}}}],bookingStart:x,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone};this.platform.ready().then(()=>{const _=JSON.stringify(u);this.http.post("https://k-studio.co.il/wp-json/wn/v1/enrollTraining",_,{headers:{"Content-Type":"application/json"}}).subscribe(b=>{var i,n;if(console.log("Response:",b),null===b.message||null===b.data)return this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4: \u05dc\u05d0 \u05e0\u05de\u05e6\u05d0\u05d4 \u05d7\u05d1\u05d9\u05dc\u05d4 \u05d6\u05de\u05d9\u05e0\u05d4","danger"),e.isError=!0,void(e.isLoading=!1);if(null!==(i=b.data)&&void 0!==i&&i.timeSlotUnavailable)this.presentToast(b.message||"The time slot is unavailable","danger");else if(null!==(n=b.data)&&void 0!==n&&n.customerAlreadyBooked)this.presentToast(b.message||"You have already booked this training","success");else if(b.message){e.isSuccess=!0,e.current_participants||(e.current_participants=[]),e.booked+=1;const r=`${this.authService.getUserFullName()}`;e.current_participants.push(r),e.isUserBooked=!0,this.apptCache.invalidate().then(()=>this.apptCache.ensureLoaded(!0)),this.apptCache.invalidateSchedule().then(()=>this.apptCache.ensureScheduleLoaded(20,!0))}else e.isSuccess=!0;e.isLoading=!1,setTimeout(()=>{e.isSuccess=!1},2e3)},b=>{console.error("Enrollment failed",JSON.stringify(b)),e.isLoading=!1,b.error&&b.error.includes('"packageCustomerId" is required for booking')?this.presentToast("\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0\u05d4 \u05d7\u05d1\u05d9\u05dc\u05d4 \u05d6\u05de\u05d9\u05e0\u05d4","danger"):this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4","danger"),e.isError=!0})})}openCalendarPopup(){var e=this;return(0,s.A)(function*(){let o="";"all"===e.selectedFilterAllFav?o="main":"shalom"===e.selectedFilterAllFav&&(o="second"),yield(yield e.modalCalendar.create({component:L,componentProps:{branch:o}})).present()})()}openMusicModal(e){var o=this;return(0,s.A)(function*(){const p=yield o.modalCtrl.create({component:It,componentProps:{training:e}});return p.onDidDismiss().then(x=>{}),yield p.present()})()}}return(f=T).\u0275fac=function(e){return new(e||f)(t.rXU(yt.OD),t.rXU(D.K_),t.rXU(D.W3),t.rXU(Y.Qq),t.rXU(N.u),t.rXU(D.W3),t.rXU(lt.w))},f.\u0275cmp=t.VBU({type:f,selectors:[["app-trainings"]],viewQuery:function(e,o){if(1&e&&(t.GBs(et,5),t.GBs(st,5),t.GBs(B,5),t.GBs(S,5)),2&e){let p;t.mGM(p=t.lsd())&&(o.popup=p.first),t.mGM(p=t.lsd())&&(o.segmentScroll=p.first),t.mGM(p=t.lsd())&&(o.indicator=p.first),t.mGM(p=t.lsd())&&(o.segmentButtons=p)}},hostBindings:function(e,o){1&e&&t.bIt("click",function(x){return o.handleOutsideClick(x)},!1,t.EBC)},decls:15,vars:6,consts:[["popup",""],["segmentScroll",""],["segmentButton",""],[1,"popup-modal-trainings"],[1,"drag-handle"],[1,"content-container"],[1,"sticky-header"],[1,"header-tabs"],["mode","md",1,"segment-tab",3,"ngModelChange","ionChange","ngModel"],["value","all","class","header-tab",4,"ngIf"],["value","shalom","class","header-tab segment-button-checked-shalom",4,"ngIf"],["value","favorites",1,"header-tab","segment-button-checked-fav"],[4,"ngIf"],["class","custom-style-ion-list",4,"ngIf"],["class","card",3,"ngClass",4,"ngFor","ngForOf"],["value","all",1,"header-tab"],["value","shalom",1,"header-tab","segment-button-checked-shalom"],[1,"segment-container"],[1,"segment-scroll"],[4,"ngFor","ngForOf"],["class","filter-header",4,"ngIf"],["class","filter-dropdown",4,"ngIf"],[1,"segment-button",3,"click","ngStyle"],[1,"segment-label"],[1,"filter-header"],[1,"icon-button",3,"click"],[1,"filter-icon"],["name","filter-outline",1,"filter-icon"],["class","icon-button calendar-button",4,"ngIf"],[1,"icon-button","calendar-button"],[1,"calendar-icon"],["name","calendar-outline","class","calendar-icon",3,"click",4,"ngIf"],["name","calendar-outline",1,"calendar-icon",3,"click"],[1,"filter-dropdown"],[2,"text-indent","8px"],["interface","popover","placeholder","\u05d1\u05d7\u05e8 \u05e1\u05d5\u05d2 \u05d0\u05d9\u05de\u05d5\u05df",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["color","danger","fill","clear",3,"click",4,"ngIf"],[3,"ngModelChange","ionChange","ngModel"],["value","all",1,"filter-button-segment"],["value","available",1,"filter-button-segment"],[3,"value"],["color","danger","fill","clear",3,"click"],["name","close-circle"],[1,"custom-style-ion-list"],[2,"width","80px",3,"animated"],["lines","none","class","skeleton-item",4,"ngFor","ngForOf"],["lines","none",1,"skeleton-item"],["slot","start"],[3,"animated"],[2,"width","80%",3,"animated"],[2,"width","60%",3,"animated"],[2,"width","30%",3,"animated"],[1,"card",3,"ngClass"],[1,"card-header"],[1,"time-date"],[1,"icons-header"],["name","heart-outline",3,"click"],["name","play-circle-outline",3,"click"],[1,"training-title-and-participants"],[1,"training-title"],["class","participants-list",4,"ngIf"],["class","participants-container",3,"ngClass",4,"ngIf"],[1,"card-content"],[1,"progress-bar-container"],[1,"progress-bar"],[1,"progress",3,"ngStyle"],["class","card-footer",4,"ngIf"],[1,"participants-list"],[1,"participants-container",3,"ngClass"],[1,"participants"],[1,"participant-admin"],[1,"participants",3,"mouseenter","mouseleave"],["class","participant-popup",4,"ngIf"],[1,"participant-popup"],[1,"card-footer"],["disabled","",1,"btn","btn-enrolled","action-button"],["name","checkmark-circle",1,"success-icon"],["class","btn btn-primary action-button",3,"ngClass","disabled","click",4,"ngIf"],["class","btn btn-primary action-button",3,"disabled","ngClass","click",4,"ngIf"],[1,"btn","btn-primary","action-button",3,"click","ngClass","disabled"],["name","crescent"],["name","close-circle",1,"error-icon"],[1,"btn","btn-primary","action-button",3,"click","disabled","ngClass"]],template:function(e,o){if(1&e){const p=t.RV6();t.j41(0,"ion-content",3,0),t.nrm(2,"div",4),t.j41(3,"div",5)(4,"div",6)(5,"div",7)(6,"ion-segment",8),t.mxI("ngModelChange",function(k){return t.eBV(p),t.DH7(o.selectedFilterAllFav,k)||(o.selectedFilterAllFav=k),t.Njj(k)}),t.bIt("ionChange",function(k){return t.eBV(p),t.Njj(o.filterFavAll(k))}),t.DNE(7,Vt,3,0,"ion-segment-button",9)(8,Tt,3,0,"ion-segment-button",10),t.j41(9,"ion-segment-button",11)(10,"ion-label"),t.EFF(11,"\u05de\u05d5\u05e2\u05d3\u05e4\u05d9\u05dd"),t.k0s()()()(),t.DNE(12,Qt,7,3,"div",12)(13,Kt,4,3,"ion-list",13)(14,ne,19,20,"div",14),t.k0s()()()}2&e&&(t.R7$(6),t.R50("ngModel",o.selectedFilterAllFav),t.R7$(),t.Y8G("ngIf","\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===o.userFavLocation||"\u05d4\u05db\u05dc"===o.userFavLocation),t.R7$(),t.Y8G("ngIf","\u05d4\u05d9\u05e8\u05e7\u05d5\u05df"===o.userFavLocation||"\u05d4\u05db\u05dc"===o.userFavLocation),t.R7$(4),t.Y8G("ngIf",!o.showSkeleton),t.R7$(),t.Y8G("ngIf",o.showSkeleton),t.R7$(),t.Y8G("ngForOf",o.filteredAppointments))},dependencies:[F.YU,F.Sq,F.bT,F.B3,X.BC,X.vS,D.Jm,D.W9,D.iq,D.uz,D.he,D.nf,D.AF,D.Gp,D.eP,D.Nm,D.Ip,D.ds,D.w2,D.Zx,D.Je,F.vh],styles:['@charset "UTF-8";.sticky-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background-color:#f8f9fa}.scrollable-list[_ngcontent-%COMP%]{height:calc(100vh - 130px);overflow-y:auto}.filter-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;margin-top:20px;margin-bottom:20px}.icon-button[_ngcontent-%COMP%]{position:relative;width:40px;height:40px;border-radius:50%;background-color:#fff;border:1px solid rgba(0,0,0,.1);box-shadow:0 2px 4px #00000014;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:all .2s ease;margin-right:12px}.icon-button[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000026}.training-title-and-participants[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.calendar-button[_ngcontent-%COMP%]{margin-left:16px}.calendar-icon[_ngcontent-%COMP%], .filter-icon[_ngcontent-%COMP%]{position:static;font-size:18px;transform:none;color:#222}.filter-controls[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 0}.training-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:15px;box-shadow:0 4px 12px #0000001a;padding:15px;margin-bottom:20px;width:100%;box-sizing:border-box}.training-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.favorite-icon[_ngcontent-%COMP%]{font-size:24px;color:#5a5a5a}.training-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4em;font-weight:700;margin-top:-30px;color:#333;font-family:Alef}.training-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin-top:-20px;font-family:Alef}.progress-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:10px}ion-progress-bar[_ngcontent-%COMP%]{--progress-background: #E0E0E0;--background: #9B59B6;border-radius:10px;height:10px;flex-grow:1;margin-left:10px}ion-label[_ngcontent-%COMP%]{font-size:2em;color:#333}ion-button[_ngcontent-%COMP%]{font-weight:700;--border-radius: 25px}.scroll-container[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}ion-segment.days-tabs[_ngcontent-%COMP%]{border-bottom:1px solid grey}.filter-segment[_ngcontent-%COMP%]{color:red}ion-segment-button[_ngcontent-%COMP%]{--color-checked: #000}ion-segment-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1em;font-weight:700;font-family:Alef}ion-segment-button[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:1em;color:#666;font-weight:700;font-family:Alef}ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--inner-padding-start: 0;--padding-start: 0;--padding-end: 0;padding:0}.header-tab[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;padding:0;border:none;box-shadow:none;padding:none;--indicator-color: transparent}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]{display:flex;width:100%}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]{transition:all .3s ease}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab.dragging-mode[_ngcontent-%COMP%]{cursor:move;opacity:.7;transform:scale(1.05)}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]   .hide-tab-btn[_ngcontent-%COMP%]{margin-left:10px;color:red;cursor:pointer;opacity:.7;transition:opacity .2s}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]   .hide-tab-btn[_ngcontent-%COMP%]:hover{opacity:1}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3;background-color:#f0f0f0}.header-tabs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:10px;width:100%;padding:0 16;border-radius:12px;border:none;box-shadow:0 2px 8px #00000014;position:relative;background:#fff}.custom-tabs[_ngcontent-%COMP%]{position:relative;--background-activated: transparent;--background-focused: transparent;--background: transparent;font-size:1em;--color-checked: #333;--color: #ff0000;padding-bottom:10px;width:90%;margin-left:10px;--indicator-color: transparent}.segment-button-checked[_ngcontent-%COMP%]{position:relative;transition:all .3s ease;border-radius:12px;--indicator-color: transparent;color:#000}.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:3px;background:#59c7cd;transition:all .3s ease;border-radius:2px}.custom-underline-default.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:linear-gradient(-90deg,#59c7cd,#4d4d4d);transition:all .3s ease}.scroll-container[_ngcontent-%COMP%]{overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}.scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.custom-underline-shalom.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#ff8366;border-radius:12px;transition:all .3s ease}.custom-underline-favorites.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#373737;border-radius:12px;transition:all .3s ease}.segment-button-checked-shalom[_ngcontent-%COMP%]:after{background:#ff8366}.filter-button-segment[_ngcontent-%COMP%]:after{background:#575757}.segment-button-checked-fav[_ngcontent-%COMP%]:after{background:#373737}.clear-filter-icon[_ngcontent-%COMP%]{font-size:24px;color:#e74c3c;margin-left:10px;cursor:pointer}.filter-dropdown[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:15px;background-color:#fff;border-radius:15px;box-shadow:0 4px 12px #0000001a;padding:15px;width:100%}.filter-dropdown.ng-animating[_ngcontent-%COMP%]{pointer-events:none}ion-select[_ngcontent-%COMP%]{--placeholder-color: #999;--color: #333;--background: #fff;--border-radius: 10px;--box-shadow: 0 4px 12px rgba(0, 0, 0, .1)}.drag-handle[_ngcontent-%COMP%]{width:10px;height:1px;background-color:transparent;border-radius:2.5px;margin:0 auto 10px}.content-container[_ngcontent-%COMP%]{padding:15px;justify-content:center;background-color:#f8f9fa}ion-content[_ngcontent-%COMP%]{--background: #f8f9fa}ion-tab-bar[_ngcontent-%COMP%]{--background: yellow;--color-selected: #3498db;--color: #666}ion-tab-button[_ngcontent-%COMP%]{--color-selected: #666;--color: #666}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 4px 20px #00000014;border:1px solid #f0f0f0;transition:all .3s ease;position:relative;overflow:hidden}.card[_ngcontent-%COMP%]:before{background:#59c7cd;content:"";position:absolute;left:0;right:0;top:0;height:4px;border-top-right-radius:20px;border-top-left-radius:20px}.card--shalom[_ngcontent-%COMP%]:before{background:#ff8366}.card--other[_ngcontent-%COMP%]:before{background:#59c7cd}.card--no-bar[_ngcontent-%COMP%]:before{content:none}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:10px}.btn[_ngcontent-%COMP%]{flex:1;padding:12px 16px;border:none;border-radius:12px;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:8px}.btn-secondary[_ngcontent-%COMP%]{background:#f8f9fa;color:#666;border:1px solid #dee2e6}.btn-enrolled[_ngcontent-%COMP%]{background:#4cb050;color:#fff;border:1px solid #dee2e6}.btn-primary[_ngcontent-%COMP%]{background:#2f2f2f;color:#fff}.training-title[_ngcontent-%COMP%]{font-size:1.4em;margin-bottom:-5px;margin-top:5px;color:#333;font-family:Alef;margin-left:auto}.card-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;margin-left:10px}.card-header[_ngcontent-%COMP%]   ion-icon.favorite[_ngcontent-%COMP%]{color:red}.time-date[_ngcontent-%COMP%]{color:gray;background:linear-gradient(90deg,#929292,#838383);color:#fff;padding:8px 16px;border-radius:20px;font-size:14px;line-height:15px;display:inline}.segment-button[_ngcontent-%COMP%]:not(.segment-button-checked):after{height:0}.progress-bar[_ngcontent-%COMP%]{background-color:#e0e0e0;border-radius:8px;height:6px}.progress-default[_ngcontent-%COMP%]{background-color:#59c7cd}.progress-shalom[_ngcontent-%COMP%]{background-color:#ff8366}.progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:6px;border-radius:8px;background-color:#59c7cd}.participants[_ngcontent-%COMP%]{font-size:12px;display:flex;align-items:center}.participants[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:4px}.card-footer[_ngcontent-%COMP%]{margin-top:10px;display:flex}.action-button[_ngcontent-%COMP%]{flex:1;padding:12px 16px;border:none;border-radius:12px;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:8px}.btn.loading[_ngcontent-%COMP%]{background-color:#f0f0f0;cursor:not-allowed}.btn.success[_ngcontent-%COMP%]{background-color:#4caf50}.action-button.loading[_ngcontent-%COMP%]{flex:1;padding:12px 16px;border:none;border-radius:12px;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:8px;background-color:#f0f0f0;cursor:not-allowed}.action-button.success[_ngcontent-%COMP%]{background-color:#4caf50}.success-icon[_ngcontent-%COMP%]{color:#fff;font-size:14px}ion-spinner[_ngcontent-%COMP%]{height:15px;width:15px}.action-button.full[_ngcontent-%COMP%]{background-color:#757575}.enrolled-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;cursor:not-allowed}.participants-container[_ngcontent-%COMP%]{background:#00000014;color:inherit;padding:4px 12px;border-radius:12px;font-size:12px}.participants-container.empty[_ngcontent-%COMP%]{background:#00000014;color:inherit}.participants-container.low[_ngcontent-%COMP%]{background:#00c85333;color:#0e7a3b}.participants-container.medium[_ngcontent-%COMP%]{background:#ffab0040;color:#b26a00}.participants-container.high[_ngcontent-%COMP%]{background:#ff836659;color:#d85635}.participants-container.full[_ngcontent-%COMP%]{background:#ff300073;color:#fff}.participants-container.over[_ngcontent-%COMP%]{background:repeating-linear-gradient(135deg,#ff3000 0,#ff3000 8px,#000 8px,#000 16px);color:#fff}.participant-popup[_ngcontent-%COMP%]{position:absolute;top:-10px;left:60px;background-color:#fff;border:none;padding:12px;box-shadow:0 8px 16px #00000026;width:180px;z-index:10;border-radius:12px;max-height:200px;overflow-y:auto;transition:opacity .3s ease,transform .3s ease;opacity:0;transform:translateY(-10px)}.participant-popup[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:14px}.custom-style-ion-list[_ngcontent-%COMP%], .item-native[_ngcontent-%COMP%]{background:#f8f9fa}.skeleton-item[_ngcontent-%COMP%]{background:#f8f9fa;--background: #f8f9fa}.participant-popup[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.participant-popup[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:12px;margin-bottom:5px}.participants[_ngcontent-%COMP%]{cursor:pointer;position:relative;justify-content:center}.participants[_ngcontent-%COMP%]:hover{text-decoration:underline}.participants[_ngcontent-%COMP%]:hover   .participant-popup[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.action-button.standby-enrolled[_ngcontent-%COMP%]{background:#f8f9fa;color:#666;border:1px solid #dee2e6;cursor:not-allowed}.action-button.error[_ngcontent-%COMP%]{background-color:#ff4d4d;color:#fff}.action-button[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:14px;color:#fff}.song-count-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;font-size:.7rem}.segment-container[_ngcontent-%COMP%]{width:100%;overflow:hidden;position:relative;display:flex;justify-content:center;gap:8px;margin:16px 0;padding:16px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #00000014}.segment-scroll[_ngcontent-%COMP%]{display:flex;overflow-x:auto;gap:8px;position:relative;font-family:Alef}.segment-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.segment-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:-moz-fit-content;min-width:fit-content;background:#f8f9fa;border-radius:8px;cursor:pointer;transition:all .2s ease;padding:8px 12px;text-align:center}.segment-button.active[_ngcontent-%COMP%]{color:#fff;text-align:center;border-radius:8px}.segment-button.active[_ngcontent-%COMP%]   .segment-label[_ngcontent-%COMP%]{font-size:16px}.segment-button[_ngcontent-%COMP%]:not(.active){color:#999}.segment-button[_ngcontent-%COMP%]:not(.active):hover{color:#666}.segment-icon[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px}.segment-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;line-height:20px}.segment-indicator[_ngcontent-%COMP%]{position:absolute;bottom:-2px;left:-3.3%;height:4px;width:48px;background-color:#000;transition:transform .3s ease}'],data:{animation:[(0,I.hZ)("buttonState",[(0,I.wk)("open",(0,I.iF)({transform:"rotate(180deg)"})),(0,I.wk)("closed",(0,I.iF)({transform:"rotate(0deg)"})),(0,I.kY)("closed <=> open",(0,I.i0)("200ms ease-in-out"))]),(0,I.hZ)("dropdownState",[(0,I.wk)("open",(0,I.iF)({opacity:1,transform:"translateY(0)",height:"*"})),(0,I.wk)("closed",(0,I.iF)({opacity:0,transform:"translateY(-10px)",height:"0"})),(0,I.kY)("closed => open",(0,I.i0)("200ms ease-out")),(0,I.kY)("open => closed",(0,I.i0)("200ms ease-in"))])]}}),T})()},9431:(vt,it,M)=>{M.d(it,{B:()=>Z});var s=M(8359);class I extends s.yU{constructor(L,j){super()}schedule(L,j=0){return this}}const Y={setInterval(V,L,...j){const{delegate:N}=Y;return null!=N&&N.setInterval?N.setInterval(V,L,...j):setInterval(V,L,...j)},clearInterval(V){const{delegate:L}=Y;return((null==L?void 0:L.clearInterval)||clearInterval)(V)},delegate:void 0};var W=M(7908),t=M(6129);class D{constructor(L,j=D.now){this.schedulerActionCtor=L,this.now=j}schedule(L,j=0,N){return new this.schedulerActionCtor(this,L).schedule(N,j)}}D.now=t.U.now;const F=new class H extends D{constructor(L,j=D.now){super(L,j),this.actions=[],this._active=!1}flush(L){const{actions:j}=this;if(this._active)return void j.push(L);let N;this._active=!0;do{if(N=L.execute(L.state,L.delay))break}while(L=j.shift());if(this._active=!1,N){for(;L=j.shift();)L.unsubscribe();throw N}}}(class ct extends I{constructor(L,j){super(L,j),this.scheduler=L,this.work=j,this.pending=!1}schedule(L,j=0){var N;if(this.closed)return this;this.state=L;const X=this.id,nt=this.scheduler;return null!=X&&(this.id=this.recycleAsyncId(nt,X,j)),this.pending=!0,this.delay=j,this.id=null!==(N=this.id)&&void 0!==N?N:this.requestAsyncId(nt,this.id,j),this}requestAsyncId(L,j,N=0){return Y.setInterval(L.flush.bind(L,this),N)}recycleAsyncId(L,j,N=0){if(null!=N&&this.delay===N&&!1===this.pending)return j;null!=j&&Y.clearInterval(j)}execute(L,j){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const N=this._execute(L,j);if(N)return N;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(L,j){let X,N=!1;try{this.work(L)}catch(nt){N=!0,X=nt||new Error("Scheduled action threw falsy error")}if(N)return this.unsubscribe(),X}unsubscribe(){if(!this.closed){const{id:L,scheduler:j}=this,{actions:N}=j;this.work=this.state=this.scheduler=null,this.pending=!1,(0,W.o)(N,this),null!=L&&(this.id=this.recycleAsyncId(j,L,null)),this.delay=null,super.unsubscribe()}}});var q=M(9974),U=M(4360);function Z(V,L=F){return(0,q.N)((j,N)=>{let X=null,nt=null,ut=null;const ht=()=>{if(X){X.unsubscribe(),X=null;const C=nt;nt=null,N.next(C)}};function ft(){const C=ut+V,G=L.now();if(G<C)return X=this.schedule(void 0,C-G),void N.add(X);ht()}j.subscribe((0,U._)(N,C=>{nt=C,ut=L.now(),X||(X=L.schedule(ft,V),N.add(X))},()=>{ht(),N.complete()},void 0,()=>{nt=X=null}))})}},6129:(vt,it,M)=>{M.d(it,{U:()=>s});const s={now:()=>(s.delegate||Date).now(),delegate:void 0}},5262:(vt,it,M)=>{M.d(it,{Bu:()=>Gt,Q_:()=>$,_G:()=>f,w6:()=>T});var s=M(177),I=M(3953),Y=M(6860),W=M(1413),ct=M(8359),H=(M(4402),M(7673),M(7336)),F=M(8141),tt=M(9431),q=M(5964),U=M(6354),Z=M(6697),L=M(4085),j=M(4572),N=M(8793),X=M(1985),ut=M(9172),ht=M(6977);const C=new Set;let G,rt=(()=>{var g;class a{constructor(d,v){this._platform=d,this._nonce=v,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Lt}matchMedia(d){return(this._platform.WEBKIT||this._platform.BLINK)&&function dt(g,a){if(!C.has(g))try{G||(G=document.createElement("style"),a&&G.setAttribute("nonce",a),G.setAttribute("type","text/css"),document.head.appendChild(G)),G.sheet&&(G.sheet.insertRule(`@media ${g} {body{ }}`,0),C.add(g))}catch(l){console.error(l)}}(d,this._nonce),this._matchMedia(d)}}return(g=a).\u0275fac=function(d){return new(d||g)(I.KVO(Y.OD),I.KVO(I.BIS,8))},g.\u0275prov=I.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),a})();function Lt(g){return{matches:"all"===g||""===g,media:g,addListener:()=>{},removeListener:()=>{}}}let wt=(()=>{var g;class a{constructor(d,v){this._mediaMatcher=d,this._zone=v,this._queries=new Map,this._destroySubject=new W.B}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(d){return It((0,L.FG)(d)).some(w=>this._registerQuery(w).mql.matches)}observe(d){const w=It((0,L.FG)(d)).map(P=>this._registerQuery(P).observable);let R=(0,j.z)(w);return R=(0,N.x)(R.pipe((0,Z.s)(1)),R.pipe(function nt(g){return(0,q.p)((a,l)=>g<=l)}(1),(0,tt.B)(0))),R.pipe((0,U.T)(P=>{const Q={matches:!1,breakpoints:{}};return P.forEach(({matches:bt,query:Wt})=>{Q.matches=Q.matches||bt,Q.breakpoints[Wt]=bt}),Q}))}_registerQuery(d){if(this._queries.has(d))return this._queries.get(d);const v=this._mediaMatcher.matchMedia(d),R={observable:new X.c(P=>{const Q=bt=>this._zone.run(()=>P.next(bt));return v.addListener(Q),()=>{v.removeListener(Q)}}).pipe((0,ut.Z)(v),(0,U.T)(({matches:P})=>({query:d,matches:P})),(0,ht.Q)(this._destroySubject)),mql:v};return this._queries.set(d,R),R}}return(g=a).\u0275fac=function(d){return new(d||g)(I.KVO(rt),I.KVO(I.SKi))},g.\u0275prov=I.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),a})();function It(g){return g.map(a=>a.split(",")).reduce((a,l)=>a.concat(l)).map(a=>a.trim())}class xt{constructor(a,l){this._letterKeyStream=new W.B,this._items=[],this._selectedItemIndex=-1,this._pressedLetters=[],this._selectedItem=new W.B,this.selectedItem=this._selectedItem;const d="number"==typeof(null==l?void 0:l.debounceInterval)?l.debounceInterval:200;null!=l&&l.skipPredicate&&(this._skipPredicateFn=l.skipPredicate),this.setItems(a),this._setupKeyHandler(d)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(a){this._selectedItemIndex=a}setItems(a){this._items=a}handleKey(a){const l=a.keyCode;a.key&&1===a.key.length?this._letterKeyStream.next(a.key.toLocaleUpperCase()):(l>=H.A&&l<=H.Z||l>=H.f2&&l<=H.bn)&&this._letterKeyStream.next(String.fromCharCode(l))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(a){this._letterKeyStream.pipe((0,F.M)(l=>this._pressedLetters.push(l)),(0,tt.B)(a),(0,q.p)(()=>this._pressedLetters.length>0),(0,U.T)(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(l=>{for(let w=1;w<this._items.length+1;w++){var d,v;const P=this._items[(this._selectedItemIndex+w)%this._items.length];if((null===(d=this._skipPredicateFn)||void 0===d||!d.call(this,P))&&0===(null===(v=P.getLabel)||void 0===v?void 0:v.call(P).toLocaleUpperCase().trim().indexOf(l))){this._selectedItem.next(P);break}}this._pressedLetters=[]})}}class Rt{constructor(a,l){this._items=a,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._typeaheadSubscription=ct.yU.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=d=>d.disabled,this.tabOut=new W.B,this.change=new W.B,a instanceof I.rOR?this._itemChangesSubscription=a.changes.subscribe(d=>this._itemsChanged(d.toArray())):(0,I.Hps)(a)&&(this._effectRef=(0,I.QZP)(()=>this._itemsChanged(a()),{injector:l}))}skipPredicate(a){return this._skipPredicateFn=a,this}withWrap(a=!0){return this._wrap=a,this}withVerticalOrientation(a=!0){return this._vertical=a,this}withHorizontalOrientation(a){return this._horizontal=a,this}withAllowedModifierKeys(a){return this._allowedModifierKeys=a,this}withTypeAhead(a=200){this._typeaheadSubscription.unsubscribe();const l=this._getItemsArray();return this._typeahead=new xt(l,{debounceInterval:"number"==typeof a?a:void 0,skipPredicate:d=>this._skipPredicateFn(d)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(d=>{this.setActiveItem(d)}),this}cancelTypeahead(){var a;return null===(a=this._typeahead)||void 0===a||a.reset(),this}withHomeAndEnd(a=!0){return this._homeAndEnd=a,this}withPageUpDown(a=!0,l=10){return this._pageUpAndDown={enabled:a,delta:l},this}setActiveItem(a){const l=this._activeItem;this.updateActiveItem(a),this._activeItem!==l&&this.change.next(this._activeItemIndex)}onKeydown(a){var l;const d=a.keyCode,w=["altKey","ctrlKey","metaKey","shiftKey"].every(P=>!a[P]||this._allowedModifierKeys.indexOf(P)>-1);switch(d){case H.wn:return void this.tabOut.next();case H.n6:if(this._vertical&&w){this.setNextItemActive();break}return;case H.i7:if(this._vertical&&w){this.setPreviousItemActive();break}return;case H.LE:if(this._horizontal&&w){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case H.UQ:if(this._horizontal&&w){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case H.yZ:if(this._homeAndEnd&&w){this.setFirstItemActive();break}return;case H.Kp:if(this._homeAndEnd&&w){this.setLastItemActive();break}return;case H.w_:if(this._pageUpAndDown.enabled&&w){const P=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(P>0?P:0,1);break}return;case H.dB:if(this._pageUpAndDown.enabled&&w){const P=this._activeItemIndex+this._pageUpAndDown.delta,Q=this._getItemsArray().length;this._setActiveItemByIndex(P<Q?P:Q-1,-1);break}return;default:var R;return void((w||(0,H.rp)(a,"shiftKey"))&&(null===(R=this._typeahead)||void 0===R||R.handleKey(a)))}null===(l=this._typeahead)||void 0===l||l.reset(),a.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(a){var l;const d=this._getItemsArray(),v="number"==typeof a?a:d.indexOf(a),w=d[v];this._activeItem=null==w?null:w,this._activeItemIndex=v,null===(l=this._typeahead)||void 0===l||l.setCurrentSelectedItemIndex(v)}destroy(){var a,l,d;this._typeaheadSubscription.unsubscribe(),null===(a=this._itemChangesSubscription)||void 0===a||a.unsubscribe(),null===(l=this._effectRef)||void 0===l||l.destroy(),null===(d=this._typeahead)||void 0===d||d.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(a){this._wrap?this._setActiveInWrapMode(a):this._setActiveInDefaultMode(a)}_setActiveInWrapMode(a){const l=this._getItemsArray();for(let d=1;d<=l.length;d++){const v=(this._activeItemIndex+a*d+l.length)%l.length;if(!this._skipPredicateFn(l[v]))return void this.setActiveItem(v)}}_setActiveInDefaultMode(a){this._setActiveItemByIndex(this._activeItemIndex+a,a)}_setActiveItemByIndex(a,l){const d=this._getItemsArray();if(d[a]){for(;this._skipPredicateFn(d[a]);)if(!d[a+=l])return;this.setActiveItem(a)}}_getItemsArray(){return(0,I.Hps)(this._items)?this._items():this._items instanceof I.rOR?this._items.toArray():this._items}_itemsChanged(a){var l;if(null===(l=this._typeahead)||void 0===l||l.setItems(a),this._activeItem){const v=a.indexOf(this._activeItem);var d;v>-1&&v!==this._activeItemIndex&&(this._activeItemIndex=v,null===(d=this._typeahead)||void 0===d||d.setCurrentSelectedItemIndex(v))}}}class Gt extends Rt{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(a){return this._origin=a,this}setActiveItem(a){super.setActiveItem(a),this.activeItem&&this.activeItem.focus(this._origin)}}function f(g){return 0===g.buttons||0===g.detail}function T(g){const a=g.touches&&g.touches[0]||g.changedTouches&&g.changedTouches[0];return!(!a||-1!==a.identifier||null!=a.radiusX&&1!==a.radiusX||null!=a.radiusY&&1!==a.radiusY)}var c=function(g){return g[g.NONE=0]="NONE",g[g.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",g[g.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",g}(c||{});const m="cdk-high-contrast-black-on-white",y="cdk-high-contrast-white-on-black",A="cdk-high-contrast-active";let $=(()=>{var g;class a{constructor(d,v){this._platform=d,this._document=v,this._breakpointSubscription=(0,I.WQX)(wt).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return c.NONE;const d=this._document.createElement("div");d.style.backgroundColor="rgb(1,2,3)",d.style.position="absolute",this._document.body.appendChild(d);const v=this._document.defaultView||window,w=v&&v.getComputedStyle?v.getComputedStyle(d):null,R=(w&&w.backgroundColor||"").replace(/ /g,"");switch(d.remove(),R){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return c.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return c.BLACK_ON_WHITE}return c.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const d=this._document.body.classList;d.remove(A,m,y),this._hasCheckedHighContrastMode=!0;const v=this.getHighContrastMode();v===c.BLACK_ON_WHITE?d.add(A,m):v===c.WHITE_ON_BLACK&&d.add(A,y)}}}return(g=a).\u0275fac=function(d){return new(d||g)(I.KVO(Y.OD),I.KVO(s.qQ))},g.\u0275prov=I.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),a})()},4085:(vt,it,M)=>{M.d(it,{FG:()=>ct,OE:()=>Y,he:()=>I,i8:()=>D});var s=M(3953);function I(F){return null!=F&&"false"!=`${F}`}function Y(F,tt=0){return function W(F){return!isNaN(parseFloat(F))&&!isNaN(Number(F))}(F)?Number(F):2===arguments.length?tt:0}function ct(F){return Array.isArray(F)?F:[F]}function D(F){return F instanceof s.aKT?F.nativeElement:F}},7336:(vt,it,M)=>{M.d(it,{A:()=>_t,A$:()=>H,FX:()=>t,Fm:()=>ct,Ge:()=>Ft,Kp:()=>L,LE:()=>nt,UQ:()=>N,W3:()=>D,Z:()=>Mt,bn:()=>B,dB:()=>V,eg:()=>ce,f2:()=>rt,i7:()=>X,n6:()=>ut,rp:()=>le,t6:()=>U,w_:()=>Z,wn:()=>Y,yZ:()=>j});const Y=9,ct=13,t=16,D=17,H=18,U=32,Z=33,V=34,L=35,j=36,N=37,X=38,nt=39,ut=40,rt=48,B=57,_t=65,Mt=90,Ft=91,ce=224;function le(oe,...se){return se.length?se.some(de=>oe[de]):oe.altKey||oe.shiftKey||oe.ctrlKey||oe.metaKey}},6860:(vt,it,M)=>{M.d(it,{BQ:()=>q,Fb:()=>ht,OD:()=>W,v8:()=>ft,vc:()=>ut});var s=M(3953),I=M(177);let Y;try{Y=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Y=!1}let F,W=(()=>{var C;class G{constructor(dt){this._platformId=dt,this.isBrowser=this._platformId?(0,I.UE)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Y)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return(C=G).\u0275fac=function(dt){return new(dt||C)(s.KVO(s.Agw))},C.\u0275prov=s.jDH({token:C,factory:C.\u0275fac,providedIn:"root"}),G})();function q(C){return function tt(){if(null==F&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>F=!0}))}finally{F=F||!1}return F}()?C:!!C.capture}function ut(){let C=typeof document<"u"&&document?document.activeElement:null;for(;C&&C.shadowRoot;){const G=C.shadowRoot.activeElement;if(G===C)break;C=G}return C}function ht(C){return C.composedPath?C.composedPath()[0]:C.target}function ft(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},8834:(vt,it,M)=>{M.d(it,{Hl:()=>lt});var s=M(3953),I=M(8820);let lt=(()=>{var et;class st{}return(et=st).\u0275fac=function(S){return new(S||et)},et.\u0275mod=s.$C({type:et}),et.\u0275inj=s.G2t({imports:[I.yE,I.pZ,I.yE]}),st})()},8820:(vt,it,M)=>{M.d(it,{$E:()=>Ht,yE:()=>yt,O5:()=>Ut,pZ:()=>Xt,ug:()=>kt});var s=M(3953),I=M(5262),Y=M(177);let tt=(()=>{var n;class r{}return(n=r).\u0275fac=function(m){return new(m||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({}),r})();var U=M(6860),Z=M(4085);const It=new s.nKC("mat-sanity-checks",{providedIn:"root",factory:function wt(){return!0}});let yt=(()=>{var n;class r{constructor(m,y,A){this._sanityChecks=y,this._document=A,this._hasDoneGlobalChecks=!1,m._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(m){return!(0,U.v8)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[m])}}return(n=r).\u0275fac=function(m){return new(m||n)(s.KVO(I.Q_),s.KVO(It,8),s.KVO(Y.qQ))},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[tt,tt]}),r})();var ot=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(ot||{});class Bt{constructor(r,c,m,y=!1){this._renderer=r,this.element=c,this.config=m,this._animationForciblyDisabledThroughCss=y,this.state=ot.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const Et=(0,U.BQ)({passive:!0,capture:!0});class jt{constructor(){this._events=new Map,this._delegateEventHandler=r=>{const c=(0,U.Fb)(r);var m;c&&(null===(m=this._events.get(r.type))||void 0===m||m.forEach((y,A)=>{(A===c||A.contains(c))&&y.forEach($=>$.handleEvent(r))}))}}addHandler(r,c,m,y){const A=this._events.get(c);if(A){const $=A.get(m);$?$.add(y):A.set(m,new Set([y]))}else this._events.set(c,new Map([[m,new Set([y])]])),r.runOutsideAngular(()=>{document.addEventListener(c,this._delegateEventHandler,Et)})}removeHandler(r,c,m){const y=this._events.get(r);if(!y)return;const A=y.get(c);A&&(A.delete(m),0===A.size&&y.delete(c),0===y.size&&(this._events.delete(r),document.removeEventListener(r,this._delegateEventHandler,Et)))}}const Dt={enterDuration:225,exitDuration:150},Mt=(0,U.BQ)({passive:!0,capture:!0}),Ft=["mousedown","touchstart"],$t=["mouseup","mouseleave","touchend","touchcancel"];class kt{constructor(r,c,m,y){this._target=r,this._ngZone=c,this._platform=y,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,y.isBrowser&&(this._containerElement=(0,Z.i8)(m))}fadeInRipple(r,c,m={}){const y=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),A={...Dt,...m.animation};m.centered&&(r=y.left+y.width/2,c=y.top+y.height/2);const $=m.radius||function Ot(n,r,c){const m=Math.max(Math.abs(n-c.left),Math.abs(n-c.right)),y=Math.max(Math.abs(r-c.top),Math.abs(r-c.bottom));return Math.sqrt(m*m+y*y)}(r,c,y),pt=r-y.left,g=c-y.top,a=A.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left=pt-$+"px",l.style.top=g-$+"px",l.style.height=2*$+"px",l.style.width=2*$+"px",null!=m.color&&(l.style.backgroundColor=m.color),l.style.transitionDuration=`${a}ms`,this._containerElement.appendChild(l);const d=window.getComputedStyle(l),w=d.transitionDuration,R="none"===d.transitionProperty||"0s"===w||"0s, 0s"===w||0===y.width&&0===y.height,P=new Bt(this,l,m,R);l.style.transform="scale3d(1, 1, 1)",P.state=ot.FADING_IN,m.persistent||(this._mostRecentTransientRipple=P);let Q=null;return!R&&(a||A.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const bt=()=>{Q&&(Q.fallbackTimer=null),clearTimeout(re),this._finishRippleTransition(P)},Wt=()=>this._destroyRipple(P),re=setTimeout(Wt,a+100);l.addEventListener("transitionend",bt),l.addEventListener("transitioncancel",Wt),Q={onTransitionEnd:bt,onTransitionCancel:Wt,fallbackTimer:re}}),this._activeRipples.set(P,Q),(R||!a)&&this._finishRippleTransition(P),P}fadeOutRipple(r){if(r.state===ot.FADING_OUT||r.state===ot.HIDDEN)return;const c=r.element,m={...Dt,...r.config.animation};c.style.transitionDuration=`${m.exitDuration}ms`,c.style.opacity="0",r.state=ot.FADING_OUT,(r._animationForciblyDisabledThroughCss||!m.exitDuration)&&this._finishRippleTransition(r)}fadeOutAll(){this._getActiveRipples().forEach(r=>r.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(r=>{r.config.persistent||r.fadeOut()})}setupTriggerEvents(r){const c=(0,Z.i8)(r);!this._platform.isBrowser||!c||c===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=c,Ft.forEach(m=>{kt._eventManager.addHandler(this._ngZone,m,c,this)}))}handleEvent(r){"mousedown"===r.type?this._onMousedown(r):"touchstart"===r.type?this._onTouchStart(r):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{$t.forEach(c=>{this._triggerElement.addEventListener(c,this,Mt)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(r){r.state===ot.FADING_IN?this._startFadeOutTransition(r):r.state===ot.FADING_OUT&&this._destroyRipple(r)}_startFadeOutTransition(r){const c=r===this._mostRecentTransientRipple,{persistent:m}=r.config;r.state=ot.VISIBLE,!m&&(!c||!this._isPointerDown)&&r.fadeOut()}_destroyRipple(r){var c;const m=null!==(c=this._activeRipples.get(r))&&void 0!==c?c:null;this._activeRipples.delete(r),this._activeRipples.size||(this._containerRect=null),r===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),r.state=ot.HIDDEN,null!==m&&(r.element.removeEventListener("transitionend",m.onTransitionEnd),r.element.removeEventListener("transitioncancel",m.onTransitionCancel),null!==m.fallbackTimer&&clearTimeout(m.fallbackTimer)),r.element.remove()}_onMousedown(r){const c=(0,I._G)(r),m=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!c&&!m&&(this._isPointerDown=!0,this.fadeInRipple(r.clientX,r.clientY,this._target.rippleConfig))}_onTouchStart(r){if(!this._target.rippleDisabled&&!(0,I.w6)(r)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const c=r.changedTouches;if(c)for(let m=0;m<c.length;m++)this.fadeInRipple(c[m].clientX,c[m].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(r=>{!r.config.persistent&&(r.state===ot.VISIBLE||r.config.terminateOnPointerUp&&r.state===ot.FADING_IN)&&r.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const r=this._triggerElement;r&&(Ft.forEach(c=>kt._eventManager.removeHandler(c,r,this)),this._pointerUpEventsRegistered&&($t.forEach(c=>r.removeEventListener(c,this,Mt)),this._pointerUpEventsRegistered=!1))}}kt._eventManager=new jt;const Ht=new s.nKC("mat-ripple-global-options");let Xt=(()=>{var n;class r{}return(n=r).\u0275fac=function(m){return new(m||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[yt,yt]}),r})(),Ut=(()=>{var n;class r{}return(n=r).\u0275fac=function(m){return new(m||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[yt]}),r})()},2054:(vt,it,M)=>{M.d(it,{Fg:()=>J});var s=M(3953),W=(M(4085),M(6860),M(8820));M(8359),M(6365),M(8750),M(983),M(3794),M(6648),M(1413),M(1985),M(6354),M(5964),M(9431);let X=(()=>{var u;class _{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}}return(u=_).\u0275fac=function(i){return new(i||u)},u.\u0275prov=s.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),_})(),ht=(()=>{var u;class _{}return(u=_).\u0275fac=function(i){return new(i||u)},u.\u0275mod=s.$C({type:u}),u.\u0275inj=s.G2t({providers:[X]}),_})();var ft=M(177);let G=(()=>{var u;class _{}return(u=_).\u0275fac=function(i){return new(i||u)},u.\u0275mod=s.$C({type:u}),u.\u0275inj=s.G2t({imports:[W.yE,W.yE]}),_})();M(5262),M(4402),M(7673),M(7336),M(9417),M(6977);let J=(()=>{var u;class _{}return(u=_).\u0275fac=function(i){return new(i||u)},u.\u0275mod=s.$C({type:u}),u.\u0275inj=s.G2t({imports:[ht,ft.MD,W.yE,W.pZ,W.O5,G]}),_})()},5911:(vt,it,M)=>{M.d(it,{s5:()=>H});var s=M(3953),I=M(8820);let H=(()=>{var F;class tt{}return(F=tt).\u0275fac=function(U){return new(U||F)},F.\u0275mod=s.$C({type:F}),F.\u0275inj=s.G2t({imports:[I.yE,I.yE]}),tt})()}}]);