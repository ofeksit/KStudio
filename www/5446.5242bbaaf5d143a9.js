"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5446],{5446:(Oe,z,p)=>{p.r(z),p.d(z,{LoginPageModule:()=>we});var V=p(177),L=p(4341),w=p(791),$=p(685),u=p(467),j=p(1626),x=p(5558),N=p(8141),ee=p(9437),U=p(7673),te=p(8810);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var _=function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n}(_||{});class S extends Error{constructor(e,o,i){super(e),this.message=e,this.code=o,this.data=i}}const ie=n=>{var e,o,i,t,r;const a=n.CapacitorCustomPlatform||null,l=n.Capacitor||{},h=l.Plugins=l.Plugins||{},c=n.CapacitorPlatforms,D=(null===(e=null==c?void 0:c.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==a?a.name:(n=>{var e,o;return null!=n&&n.androidBridge?"android":null!==(o=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==o&&o.bridge?"ios":"web"})(n)),ye=(null===(o=null==c?void 0:c.currentPlatform)||void 0===o?void 0:o.isNativePlatform)||(()=>"web"!==D()),Le=(null===(i=null==c?void 0:c.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(d=>{const g=B.get(d);return!!(null!=g&&g.platforms.has(D())||Q(d))}),Q=(null===(t=null==c?void 0:c.currentPlatform)||void 0===t?void 0:t.getPluginHeader)||(d=>{var g;return null===(g=l.PluginHeaders)||void 0===g?void 0:g.find(A=>A.name===d)}),B=new Map,Me=(null===(r=null==c?void 0:c.currentPlatform)||void 0===r?void 0:r.registerPlugin)||((d,g={})=>{const A=B.get(d);if(A)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),A.proxy;const E=D(),M=Q(d);let P;const xe=function(){var f=(0,u.A)(function*(){return!P&&E in g?P=P="function"==typeof g[E]?yield g[E]():g[E]:null!==a&&!P&&"web"in g&&(P=P="function"==typeof g.web?yield g.web():g.web),P});return function(){return f.apply(this,arguments)}}(),G=f=>{let m;const b=(...y)=>{const C=xe().then(v=>{const k=((f,m)=>{var b,y;if(!M){if(f)return null===(y=f[m])||void 0===y?void 0:y.bind(f);throw new S(`"${d}" plugin is not implemented on ${E}`,_.Unimplemented)}{const C=null==M?void 0:M.methods.find(v=>m===v.name);if(C)return"promise"===C.rtype?v=>l.nativePromise(d,m.toString(),v):(v,k)=>l.nativeCallback(d,m.toString(),v,k);if(f)return null===(b=f[m])||void 0===b?void 0:b.bind(f)}})(v,f);if(k){const T=k(...y);return m=null==T?void 0:T.remove,T}throw new S(`"${d}.${f}()" is not implemented on ${E}`,_.Unimplemented)});return"addListener"===f&&(C.remove=(0,u.A)(function*(){return m()})),C};return b.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:f,writable:!1,configurable:!1}),b},Z=G("addListener"),q=G("removeListener"),Ie=(f,m)=>{const b=Z({eventName:f},m),y=function(){var v=(0,u.A)(function*(){const k=yield b;q({eventName:f,callbackId:k},m)});return function(){return v.apply(this,arguments)}}(),C=new Promise(v=>b.then(()=>v({remove:y})));return C.remove=(0,u.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield y()}),C},H=new Proxy({},{get(f,m){switch(m){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return M?Ie:Z;case"removeListener":return q;default:return G(m)}}});return h[d]=H,B.set(d,{name:d,proxy:H,platforms:new Set([...Object.keys(g),...M?[E]:[]])}),H});return l.convertFileSrc||(l.convertFileSrc=d=>d),l.getPlatform=D,l.handleError=d=>n.console.error(d),l.isNativePlatform=ye,l.isPluginAvailable=Le,l.pluginMethodNoop=(d,g,A)=>Promise.reject(`${A} does not have an implementation of "${g}".`),l.registerPlugin=Me,l.Exception=S,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},I=(n=>n.Capacitor=ie(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),W=I.registerPlugin;class K{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,o){var i=this;let t=!1;this.listeners[e]||(this.listeners[e]=[],t=!0),this.listeners[e].push(o);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),t&&this.sendRetainedArgumentsForEvent(e);const l=function(){var c=(0,u.A)(function*(){return i.removeListener(e,o)});return function(){return c.apply(this,arguments)}}();return Promise.resolve({remove:l})}removeAllListeners(){var e=this;return(0,u.A)(function*(){e.listeners={};for(const o in e.windowListeners)e.removeWindowListener(e.windowListeners[o]);e.windowListeners={}})()}notifyListeners(e,o,i){const t=this.listeners[e];if(t)t.forEach(r=>r(o));else if(i){let r=this.retainedEventArguments[e];r||(r=[]),r.push(o),this.retainedEventArguments[e]=r}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,o){this.windowListeners[o]={registered:!1,windowEventName:e,pluginEventName:o,handler:i=>{this.notifyListeners(o,i)}}}unimplemented(e="not implemented"){return new I.Exception(e,_.Unimplemented)}unavailable(e="not available"){return new I.Exception(e,_.Unavailable)}removeListener(e,o){var i=this;return(0,u.A)(function*(){const t=i.listeners[e];if(!t)return;const r=t.indexOf(o);i.listeners[e].splice(r,1),i.listeners[e].length||i.removeWindowListener(i.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const o=this.retainedEventArguments[e];o&&(delete this.retainedEventArguments[e],o.forEach(i=>{this.notifyListeners(e,i)}))}}const R=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),X=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class se extends K{getCookies(){return(0,u.A)(function*(){const e=document.cookie,o={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[t,r]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");t=X(t).trim(),r=X(r).trim(),o[t]=r}),o})()}setCookie(e){return(0,u.A)(function*(){try{const o=R(e.key),i=R(e.value),t=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),a=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${o}=${i||""}${t}; path=${r}; ${a};`}catch(o){return Promise.reject(o)}})()}deleteCookie(e){return(0,u.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(o){return Promise.reject(o)}})()}clearCookies(){return(0,u.A)(function*(){try{const e=document.cookie.split(";")||[];for(const o of e)document.cookie=o.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,u.A)(function*(){try{yield e.clearCookies()}catch(o){return Promise.reject(o)}})()}}W("CapacitorCookies",{web:()=>new se});const ae=function(){var n=(0,u.A)(function*(e){return new Promise((o,i)=>{const t=new FileReader;t.onload=()=>{const r=t.result;o(r.indexOf(",")>=0?r.split(",")[1]:r)},t.onerror=r=>i(r),t.readAsDataURL(e)})});return function(o){return n.apply(this,arguments)}}();class de extends K{request(e){return(0,u.A)(function*(){const o=((n,e={})=>{const o=Object.assign({method:n.method||"GET",headers:n.headers},e),t=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(t=>t.toLocaleLowerCase()).reduce((t,r,a)=>(t[r]=n[e[a]],t),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)o.body=n.data;else if(t.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[a,l]of Object.entries(n.data||{}))r.set(a,l);o.body=r.toString()}else if(t.includes("multipart/form-data")||n.data instanceof FormData){const r=new FormData;if(n.data instanceof FormData)n.data.forEach((l,h)=>{r.append(h,l)});else for(const l of Object.keys(n.data))r.append(l,n.data[l]);o.body=r;const a=new Headers(o.headers);a.delete("content-type"),o.headers=a}else(t.includes("application/json")||"object"==typeof n.data)&&(o.body=JSON.stringify(n.data));return o})(e,e.webFetchExtra),i=((n,e=!0)=>n?Object.entries(n).reduce((i,t)=>{const[r,a]=t;let l,h;return Array.isArray(a)?(h="",a.forEach(c=>{l=e?encodeURIComponent(c):c,h+=`${r}=${l}&`}),h.slice(0,-1)):(l=e?encodeURIComponent(a):a,h=`${r}=${l}`),`${i}&${h}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),t=i?`${e.url}?${i}`:e.url,r=yield fetch(t,o),a=r.headers.get("content-type")||"";let h,c,{responseType:l="text"}=r.ok?e:{};switch(a.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":c=yield r.blob(),h=yield ae(c);break;case"json":h=yield r.json();break;default:h=yield r.text()}const O={};return r.headers.forEach((D,F)=>{O[F]=D}),{data:h,headers:O,status:r.status,url:r.url}})()}get(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}W("CapacitorHttp",{web:()=>new de});const J=W("Keyboard");var s=p(3953),pe=p(4796);function he(n,e){1&n&&s.nrm(0,"ion-spinner",17)}function me(n,e){1&n&&(s.j41(0,"span"),s.EFF(1,"\u05d4\u05ea\u05d7\u05d1\u05e8"),s.k0s())}function ve(n,e){1&n&&s.nrm(0,"ion-progress-bar",18)}const be=[{path:"",component:(()=>{var n;class e{constructor(i,t,r,a){this.authService=i,this.router=t,this.http=r,this.toastController=a,this.username="",this.password="",this.errorMessage="",this.showToast=!1,this.toastMessage="",this.toastColor="success",this.showProgressBar=!1,this.isLoading=!1,this.passwordType="password",this.passwordIcon="eye-off",J.addListener("keyboardWillShow",()=>{console.log("Keyboard is opening"),document.body.classList.add("keyboard-open")}),J.addListener("keyboardWillHide",()=>{console.log("Keyboard is closing"),document.body.classList.remove("keyboard-open")})}presentToast(i,t){var r=this;return(0,u.A)(function*(){yield(yield r.toastController.create({message:i,duration:3e3,color:t,position:"top"})).present()})()}login(){var i=this;if(!this.username||!this.password)return this.errorMessage="\u05d0\u05e0\u05d0 \u05de\u05dc\u05d0 \u05d0\u05ea \u05e9\u05dd \u05d4\u05de\u05e9\u05ea\u05de\u05e9 \u05d5\u05d4\u05e1\u05d9\u05e1\u05de\u05d4",void this.presentToast(this.errorMessage,"danger");this.isLoading=!0,this.authService.login(this.username,this.password).pipe((0,x.n)(t=>{this.authService.storeToken(t.data.token),this.authService.storeUserID(t.data.id),this.authService.storeUserEmail(t.data.email);const r=new j.Lr({Authorization:`Bearer ${t.data.token}`});return this.http.get("https://k-studio.co.il/wp-json/wp/v2/users/me",{headers:r})}),(0,x.n)(t=>{this.authService.storeUserFullName(t.name),this.authService.storeUserGamiPts(t.meta._gamipress_pts_points);const r=new j.Lr({Authorization:`Bearer ${this.authService.getToken()}`});return this.http.get(`https://k-studio.co.il/wp-json/custom-api/v1/user-role/${t.id}`,{headers:r})}),(0,x.n)(t=>{const r=t.roles[0];if(this.authService.storeUserRole(r),"administrator"===r)return(0,U.of)({skipAmelia:!0,customerId:null,packages:[]});const l=`https://k-studio.co.il/wp-json/custom-api/v1/amelia-customer-id?email=${this.authService.getUserEmail()}`;return this.http.get(l)}),(0,x.n)(t=>t.skipAmelia?(0,U.of)(t):(t&&t.customerId&&this.authService.storeCustomerID(t.customerId),this.http.get(`https://k-studio.co.il/wp-json/wn/v1/package-purchases/${t.customerId}`))),(0,x.n)(t=>{if(t.skipAmelia)return(0,U.of)(t);if(console.log("package response:",t),t&&t.data&&t.data[0]&&t.data[0].packages[0]&&t.data[0].packages[0].purchases[0]&&t.data[0].packages[0].purchases[0].packageCustomerId){const a=t.data[0].packages[0].purchases[0].packageCustomerId;console.log("packageID:",a),this.authService.storePackageCustomerID(a)}const r=`https://k-studio.co.il/wp-json/custom-api/v1/get-favorite-location?user_id=${this.authService.getUserID()}`;return this.http.get(r)}),(0,N.M)(t=>{t.skipAmelia||(console.log("favlocation",t),console.log("favlocation",t.favorite_location),t&&t.favorite_location&&this.authService.storeFavLocation(t.favorite_location))}),(0,ee.W)(t=>(console.error("Error occurred during login process:",t),this.authService.logout(),401===t.status||403===t.status?(this.errorMessage="\u05e9\u05dd \u05de\u05e9\u05ea\u05de\u05e9 \u05d0\u05d5 \u05e1\u05d9\u05e1\u05de\u05d4 \u05e9\u05d2\u05d5\u05d9\u05d9\u05dd.",this.presentToast(this.errorMessage,"danger")):(this.errorMessage="\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4, \u05d0\u05e0\u05d0 \u05e0\u05e1\u05d4 \u05e9\u05e0\u05d9\u05ea",this.presentToast(this.errorMessage,"medium")),this.isLoading=!1,(0,te.$)(t)))).subscribe((0,u.A)(function*(){i.showProgressBar=!0,setTimeout(()=>{i.router.navigate(["/home"]),i.showProgressBar=!1},1500),i.isLoading=!1}),t=>{console.error("An unexpected error occurred in subscribe:",t),this.isLoading=!1})}togglePasswordVisibility(){this.passwordType="password"===this.passwordType?"text":"password",this.passwordIcon="eye-off"===this.passwordIcon?"eye":"eye-off"}forgotPassword(){console.log("Forgot password clicked")}scrollToInput(i){const t=i.target;setTimeout(()=>{t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},300)}}return(n=e).\u0275fac=function(i){return new(i||n)(s.rXU(pe.u),s.rXU($.Ix),s.rXU(j.Qq),s.rXU(w.K_))},n.\u0275cmp=s.VBU({type:n,selectors:[["app-login"]],decls:19,vars:8,consts:[[1,"background-container"],[1,"background-image"],[1,"overlay"],[1,"logo-container"],["src","https://k-studio.co.il/wp-content/uploads/2022/11/\u05dc\u05d5\u05d2\u05d5-\u05db\u05d9\u05ea\u05d5\u05d1-\u05e2\u05d2\u05d5\u05dc-\u05d8\u05d5\u05e8\u05e7\u05d9\u05d6-\u05e9\u05e7\u05d5\u05e3-01-scaled.webp","alt","Logo"],[1,"form-container"],[1,"login-form",3,"ngSubmit"],[1,"welcome-message",2,"direction","rtl","text-align","center"],[1,"email-container"],["type","email","name","email","required","","label","\u05e9\u05dd \u05de\u05e9\u05ea\u05de\u05e9","label-placement","floating","placeholder","\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05e9\u05dd \u05d4\u05de\u05e9\u05ea\u05de\u05e9",3,"ngModelChange","focus","ngModel"],[1,"password-container",2,"position","relative"],["name","password","required","","label","\u05e1\u05d9\u05e1\u05de\u05d4","label-placement","floating","placeholder","\u05d4\u05db\u05e0\u05e1 \u05e1\u05d9\u05e1\u05de\u05d4",3,"ngModelChange","focus","ngModel","type"],[1,"password-toggle-icon",2,"position","absolute","right","15px","top","25px","font-size","20px",3,"click","name"],[1,"login-btn",3,"click","disabled"],["name","crescent",4,"ngIf"],[4,"ngIf"],["type","indeterminate","color","success",4,"ngIf"],["name","crescent"],["type","indeterminate","color","success"]],template:function(i,t){1&i&&(s.j41(0,"ion-content")(1,"div",0),s.nrm(2,"div",1)(3,"div",2),s.j41(4,"div",3),s.nrm(5,"img",4),s.k0s()(),s.j41(6,"div",5)(7,"form",6),s.bIt("ngSubmit",function(){return t.login()}),s.j41(8,"h2",7),s.EFF(9,"\u05d1\u05e8\u05d5\u05da \u05d4\u05d1\u05d0!"),s.k0s(),s.j41(10,"div",8)(11,"ion-input",9),s.mxI("ngModelChange",function(a){return s.DH7(t.username,a)||(t.username=a),a}),s.bIt("focus",function(a){return t.scrollToInput(a)}),s.k0s()(),s.j41(12,"div",10)(13,"ion-input",11),s.mxI("ngModelChange",function(a){return s.DH7(t.password,a)||(t.password=a),a}),s.bIt("focus",function(a){return t.scrollToInput(a)}),s.k0s(),s.j41(14,"ion-icon",12),s.bIt("click",function(){return t.togglePasswordVisibility()}),s.k0s()(),s.j41(15,"button",13),s.bIt("click",function(){return t.login()}),s.DNE(16,he,1,0,"ion-spinner",14)(17,me,2,0,"span",15),s.k0s()(),s.DNE(18,ve,1,0,"ion-progress-bar",16),s.k0s()()),2&i&&(s.R7$(11),s.R50("ngModel",t.username),s.R7$(2),s.R50("ngModel",t.password),s.Y8G("type",t.passwordType),s.R7$(),s.Y8G("name",t.passwordIcon),s.R7$(),s.Y8G("disabled",t.isLoading),s.R7$(),s.Y8G("ngIf",t.isLoading),s.R7$(),s.Y8G("ngIf",!t.isLoading),s.R7$(),s.Y8G("ngIf",t.showProgressBar))},dependencies:[V.bT,L.qT,L.BC,L.cb,L.YS,L.vS,L.cV,w.W9,w.iq,w.$w,w.FH,w.w2,w.Gw],styles:[".password-container[_ngcontent-%COMP%]{position:relative}.password-toggle-icon[_ngcontent-%COMP%]{position:absolute;right:15px;top:25px;font-size:20px;color:#666;cursor:pointer}.background-container[_ngcontent-%COMP%]{position:relative;width:100%;height:40vh;z-index:1}.background-image[_ngcontent-%COMP%]{background-image:url(https://k-studio.co.il/wp-content/uploads/2024/11/cover.jpeg);background-size:cover;background-position:center;height:100%}.logo-container[_ngcontent-%COMP%]{position:absolute;top:20px;width:100%;display:flex;justify-content:center;z-index:2}.logo-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px;height:auto}.form-container[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-top-left-radius:25px;border-top-right-radius:25px;padding:20px;margin-top:-25px;width:100%;z-index:2;height:30%}.welcome-message[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:10px;color:#333}.login-form[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.email-container[_ngcontent-%COMP%]{margin-bottom:20px}ion-input[_ngcontent-%COMP%]{color:#000;font-family:Arial,sans-serif;font-size:16px;padding:10px;background-color:#dbdbdb;text-indent:20px;border-radius:25px}ion-content[_ngcontent-%COMP%]{--keyboard-offset: 0px;height:100vh}.keyboard-open[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{height:calc(100vh - 50px);overflow-y:auto}.login-btn[_ngcontent-%COMP%]{background:#37c6c2;border-radius:25px;font-weight:700;font-size:18px;padding:10px 0;margin-top:20px;width:100%;background-activated:#744114;--background:#37c6c2;--border-radius: 25px;--background-activated: #744114;color:#fff}.login-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.login-btn[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle}"]}),e})()}];let Pe=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[$.iI.forChild(be),$.iI]}),e})(),we=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[V.MD,L.YN,w.bv,Pe]}),e})()}}]);