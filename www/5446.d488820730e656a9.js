"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5446],{5446:(Oe,H,m)=>{m.r(H),m.d(H,{LoginPageModule:()=>Pe});var R=m(177),L=m(4341),w=m(791),$=m(5559),u=m(467),j=m(1626),T=m(5558),Z=m(8141),N=m(9437),ee=m(8810);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var x=function(t){return t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE",t}(x||{});class U extends Error{constructor(e,o,i){super(e),this.message=e,this.code=o,this.data=i}}const re=t=>{var e,o,i,n,r;const a=t.CapacitorCustomPlatform||null,l=t.Capacitor||{},p=l.Plugins=l.Plugins||{},c=t.CapacitorPlatforms,D=(null===(e=null==c?void 0:c.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==a?a.name:(t=>{var e,o;return null!=t&&t.androidBridge?"android":null!==(o=null===(e=null==t?void 0:t.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==o&&o.bridge?"ios":"web"})(t)),we=(null===(o=null==c?void 0:c.currentPlatform)||void 0===o?void 0:o.isNativePlatform)||(()=>"web"!==D()),Ce=(null===(i=null==c?void 0:c.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(d=>{const g=B.get(d);return!!(null!=g&&g.platforms.has(D())||J(d))}),J=(null===(n=null==c?void 0:c.currentPlatform)||void 0===n?void 0:n.getPluginHeader)||(d=>{var g;return null===(g=l.PluginHeaders)||void 0===g?void 0:g.find(A=>A.name===d)}),B=new Map,Ae=(null===(r=null==c?void 0:c.currentPlatform)||void 0===r?void 0:r.registerPlugin)||((d,g={})=>{const A=B.get(d);if(A)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),A.proxy;const E=D(),M=J(d);let P;const Me=function(){var f=(0,u.A)(function*(){return!P&&E in g?P=P="function"==typeof g[E]?yield g[E]():g[E]:null!==a&&!P&&"web"in g&&(P=P="function"==typeof g.web?yield g.web():g.web),P});return function(){return f.apply(this,arguments)}}(),F=f=>{let h;const b=(...y)=>{const C=Me().then(v=>{const k=((f,h)=>{var b,y;if(!M){if(f)return null===(y=f[h])||void 0===y?void 0:y.bind(f);throw new U(`"${d}" plugin is not implemented on ${E}`,x.Unimplemented)}{const C=null==M?void 0:M.methods.find(v=>h===v.name);if(C)return"promise"===C.rtype?v=>l.nativePromise(d,h.toString(),v):(v,k)=>l.nativeCallback(d,h.toString(),v,k);if(f)return null===(b=f[h])||void 0===b?void 0:b.bind(f)}})(v,f);if(k){const I=k(...y);return h=null==I?void 0:I.remove,I}throw new U(`"${d}.${f}()" is not implemented on ${E}`,x.Unimplemented)});return"addListener"===f&&(C.remove=(0,u.A)(function*(){return h()})),C};return b.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:f,writable:!1,configurable:!1}),b},Q=F("addListener"),q=F("removeListener"),_e=(f,h)=>{const b=Q({eventName:f},h),y=function(){var v=(0,u.A)(function*(){const k=yield b;q({eventName:f,callbackId:k},h)});return function(){return v.apply(this,arguments)}}(),C=new Promise(v=>b.then(()=>v({remove:y})));return C.remove=(0,u.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield y()}),C},G=new Proxy({},{get(f,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return M?_e:Q;case"removeListener":return q;default:return F(h)}}});return p[d]=G,B.set(d,{name:d,proxy:G,platforms:new Set([...Object.keys(g),...M?[E]:[]])}),G});return l.convertFileSrc||(l.convertFileSrc=d=>d),l.getPlatform=D,l.handleError=d=>t.console.error(d),l.isNativePlatform=we,l.isPluginAvailable=Ce,l.pluginMethodNoop=(d,g,A)=>Promise.reject(`${A} does not have an implementation of "${g}".`),l.registerPlugin=Ae,l.Exception=U,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},_=(t=>t.Capacitor=re(t))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),S=_.registerPlugin;class V{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,o){var i=this;let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(o);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(e);const l=function(){var c=(0,u.A)(function*(){return i.removeListener(e,o)});return function(){return c.apply(this,arguments)}}();return Promise.resolve({remove:l})}removeAllListeners(){var e=this;return(0,u.A)(function*(){e.listeners={};for(const o in e.windowListeners)e.removeWindowListener(e.windowListeners[o]);e.windowListeners={}})()}notifyListeners(e,o,i){const n=this.listeners[e];if(n)n.forEach(r=>r(o));else if(i){let r=this.retainedEventArguments[e];r||(r=[]),r.push(o),this.retainedEventArguments[e]=r}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,o){this.windowListeners[o]={registered:!1,windowEventName:e,pluginEventName:o,handler:i=>{this.notifyListeners(o,i)}}}unimplemented(e="not implemented"){return new _.Exception(e,x.Unimplemented)}unavailable(e="not available"){return new _.Exception(e,x.Unavailable)}removeListener(e,o){var i=this;return(0,u.A)(function*(){const n=i.listeners[e];if(!n)return;const r=n.indexOf(o);i.listeners[e].splice(r,1),i.listeners[e].length||i.removeWindowListener(i.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const o=this.retainedEventArguments[e];o&&(delete this.retainedEventArguments[e],o.forEach(i=>{this.notifyListeners(e,i)}))}}const Y=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),K=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ie extends V{getCookies(){return(0,u.A)(function*(){const e=document.cookie,o={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[n,r]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=K(n).trim(),r=K(r).trim(),o[n]=r}),o})()}setCookie(e){return(0,u.A)(function*(){try{const o=Y(e.key),i=Y(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),a=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${o}=${i||""}${n}; path=${r}; ${a};`}catch(o){return Promise.reject(o)}})()}deleteCookie(e){return(0,u.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(o){return Promise.reject(o)}})()}clearCookies(){return(0,u.A)(function*(){try{const e=document.cookie.split(";")||[];for(const o of e)document.cookie=o.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,u.A)(function*(){try{yield e.clearCookies()}catch(o){return Promise.reject(o)}})()}}S("CapacitorCookies",{web:()=>new ie});const se=function(){var t=(0,u.A)(function*(e){return new Promise((o,i)=>{const n=new FileReader;n.onload=()=>{const r=n.result;o(r.indexOf(",")>=0?r.split(",")[1]:r)},n.onerror=r=>i(r),n.readAsDataURL(e)})});return function(o){return t.apply(this,arguments)}}();class ue extends V{request(e){return(0,u.A)(function*(){const o=((t,e={})=>{const o=Object.assign({method:t.method||"GET",headers:t.headers},e),n=((t={})=>{const e=Object.keys(t);return Object.keys(t).map(n=>n.toLocaleLowerCase()).reduce((n,r,a)=>(n[r]=t[e[a]],n),{})})(t.headers)["content-type"]||"";if("string"==typeof t.data)o.body=t.data;else if(n.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[a,l]of Object.entries(t.data||{}))r.set(a,l);o.body=r.toString()}else if(n.includes("multipart/form-data")||t.data instanceof FormData){const r=new FormData;if(t.data instanceof FormData)t.data.forEach((l,p)=>{r.append(p,l)});else for(const l of Object.keys(t.data))r.append(l,t.data[l]);o.body=r;const a=new Headers(o.headers);a.delete("content-type"),o.headers=a}else(n.includes("application/json")||"object"==typeof t.data)&&(o.body=JSON.stringify(t.data));return o})(e,e.webFetchExtra),i=((t,e=!0)=>t?Object.entries(t).reduce((i,n)=>{const[r,a]=n;let l,p;return Array.isArray(a)?(p="",a.forEach(c=>{l=e?encodeURIComponent(c):c,p+=`${r}=${l}&`}),p.slice(0,-1)):(l=e?encodeURIComponent(a):a,p=`${r}=${l}`),`${i}&${p}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),n=i?`${e.url}?${i}`:e.url,r=yield fetch(n,o),a=r.headers.get("content-type")||"";let p,c,{responseType:l="text"}=r.ok?e:{};switch(a.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":c=yield r.blob(),p=yield se(c);break;case"json":p=yield r.json();break;default:p=yield r.text()}const O={};return r.headers.forEach((D,W)=>{O[W]=D}),{data:p,headers:O,status:r.status,url:r.url}})()}get(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var o=this;return(0,u.A)(function*(){return o.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}S("CapacitorHttp",{web:()=>new ue});const X=S("Keyboard");var s=m(3953),fe=m(4796);function pe(t,e){1&t&&s.nrm(0,"ion-spinner",17)}function he(t,e){1&t&&(s.j41(0,"span"),s.EFF(1,"\u05d4\u05ea\u05d7\u05d1\u05e8"),s.k0s())}function me(t,e){1&t&&s.nrm(0,"ion-progress-bar",18)}const ve=[{path:"",component:(()=>{var t;class e{constructor(i,n,r,a){this.authService=i,this.router=n,this.http=r,this.toastController=a,this.username="",this.password="",this.errorMessage="",this.showToast=!1,this.toastMessage="",this.toastColor="success",this.showProgressBar=!1,this.isLoading=!1,this.passwordType="password",this.passwordIcon="eye-off",X.addListener("keyboardWillShow",()=>{console.log("Keyboard is opening"),document.body.classList.add("keyboard-open")}),X.addListener("keyboardWillHide",()=>{console.log("Keyboard is closing"),document.body.classList.remove("keyboard-open")})}presentToast(i,n){var r=this;return(0,u.A)(function*(){yield(yield r.toastController.create({message:i,duration:3e3,color:n,position:"top"})).present()})()}login(){var i=this;if(!this.username||!this.password)return this.errorMessage="\u05d0\u05e0\u05d0 \u05de\u05dc\u05d0 \u05d0\u05ea \u05e9\u05dd \u05d4\u05de\u05e9\u05ea\u05de\u05e9 \u05d5\u05d4\u05e1\u05d9\u05e1\u05de\u05d4",void this.presentToast(this.errorMessage,"danger");this.isLoading=!0,this.authService.login(this.username,this.password).pipe((0,T.n)(n=>{this.authService.storeToken(n.data.token),this.authService.storeUserID(n.data.id),this.authService.storeUserEmail(n.data.email);const r=new j.Lr({Authorization:`Bearer ${n.data.token}`});return this.http.get("https://k-studio.co.il/wp-json/wp/v2/users/me",{headers:r})}),(0,T.n)(n=>{this.authService.storeUserFullName(n.name),this.authService.storeUserGamiPts(n.meta._gamipress_pts_points);const r=new j.Lr({Authorization:`Bearer ${this.authService.getToken()}`});return this.http.get(`https://k-studio.co.il/wp-json/custom-api/v1/user-role/${n.id}`,{headers:r})}),(0,T.n)(n=>{this.authService.storeUserRole(n.roles[0]);const a=`https://k-studio.co.il/wp-json/custom-api/v1/amelia-customer-id?email=${this.authService.getUserEmail()}`;return this.http.get(a)}),(0,T.n)(n=>(n&&n.customerId&&this.authService.storeCustomerID(n.customerId),this.http.get(`https://k-studio.co.il/wp-json/wn/v1/package-purchases/${n.customerId}`))),(0,Z.M)(n=>{n&&n.data&&n.data[0]&&n.data[0].packages[0]&&n.data[0].packages[0].purchases[0]&&n.data[0].packages[0].purchases[0].packageCustomerId&&this.authService.storePackageCustomerID(n.data[0].packages[0].purchases[0].packageCustomerId)}),(0,N.W)(n=>(console.error("Error occurred during login process:",n),this.authService.logout(),401===n.status||403===n.status?(this.errorMessage="\u05e9\u05dd \u05de\u05e9\u05ea\u05de\u05e9 \u05d0\u05d5 \u05e1\u05d9\u05e1\u05de\u05d4 \u05e9\u05d2\u05d5\u05d9\u05d9\u05dd.",this.presentToast(this.errorMessage,"danger")):(this.errorMessage="\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4, \u05d0\u05e0\u05d0 \u05e0\u05e1\u05d4 \u05e9\u05e0\u05d9\u05ea",this.presentToast(this.errorMessage,"medium")),this.isLoading=!1,(0,ee.$)(n)))).subscribe((0,u.A)(function*(){i.showProgressBar=!0,setTimeout(()=>{i.router.navigate(["/home"]),i.showProgressBar=!1},3e3),i.isLoading=!1}),n=>{console.error("An unexpected error occurred in subscribe:",n),this.isLoading=!1})}togglePasswordVisibility(){this.passwordType="password"===this.passwordType?"text":"password",this.passwordIcon="eye-off"===this.passwordIcon?"eye":"eye-off"}forgotPassword(){console.log("Forgot password clicked")}scrollToInput(i){const n=i.target;setTimeout(()=>{n.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},300)}}return(t=e).\u0275fac=function(i){return new(i||t)(s.rXU(fe.u),s.rXU($.Ix),s.rXU(j.Qq),s.rXU(w.K_))},t.\u0275cmp=s.VBU({type:t,selectors:[["app-login"]],decls:19,vars:8,consts:[[1,"background-container"],[1,"background-image"],[1,"overlay"],[1,"logo-container"],["src","https://k-studio.co.il/wp-content/uploads/2022/11/\u05dc\u05d5\u05d2\u05d5-\u05db\u05d9\u05ea\u05d5\u05d1-\u05e2\u05d2\u05d5\u05dc-\u05d8\u05d5\u05e8\u05e7\u05d9\u05d6-\u05e9\u05e7\u05d5\u05e3-01-scaled.webp","alt","Logo"],[1,"form-container"],[1,"login-form",3,"ngSubmit"],[1,"welcome-message",2,"direction","rtl","text-align","center"],[1,"email-container"],["type","email","name","email","required","","label","\u05e9\u05dd \u05de\u05e9\u05ea\u05de\u05e9","label-placement","floating","placeholder","\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05e9\u05dd \u05d4\u05de\u05e9\u05ea\u05de\u05e9",3,"ngModelChange","focus","ngModel"],[1,"password-container",2,"position","relative"],["name","password","required","","label","\u05e1\u05d9\u05e1\u05de\u05d4","label-placement","floating","placeholder","\u05d4\u05db\u05e0\u05e1 \u05e1\u05d9\u05e1\u05de\u05d4",3,"ngModelChange","focus","ngModel","type"],[1,"password-toggle-icon",2,"position","absolute","right","15px","top","25px","font-size","20px",3,"click","name"],[1,"login-btn",3,"click","disabled"],["name","crescent",4,"ngIf"],[4,"ngIf"],["type","indeterminate","color","success",4,"ngIf"],["name","crescent"],["type","indeterminate","color","success"]],template:function(i,n){1&i&&(s.j41(0,"ion-content")(1,"div",0),s.nrm(2,"div",1)(3,"div",2),s.j41(4,"div",3),s.nrm(5,"img",4),s.k0s()(),s.j41(6,"div",5)(7,"form",6),s.bIt("ngSubmit",function(){return n.login()}),s.j41(8,"h2",7),s.EFF(9,"\u05d1\u05e8\u05d5\u05da \u05d4\u05d1\u05d0!"),s.k0s(),s.j41(10,"div",8)(11,"ion-input",9),s.mxI("ngModelChange",function(a){return s.DH7(n.username,a)||(n.username=a),a}),s.bIt("focus",function(a){return n.scrollToInput(a)}),s.k0s()(),s.j41(12,"div",10)(13,"ion-input",11),s.mxI("ngModelChange",function(a){return s.DH7(n.password,a)||(n.password=a),a}),s.bIt("focus",function(a){return n.scrollToInput(a)}),s.k0s(),s.j41(14,"ion-icon",12),s.bIt("click",function(){return n.togglePasswordVisibility()}),s.k0s()(),s.j41(15,"button",13),s.bIt("click",function(){return n.login()}),s.DNE(16,pe,1,0,"ion-spinner",14)(17,he,2,0,"span",15),s.k0s()(),s.DNE(18,me,1,0,"ion-progress-bar",16),s.k0s()()),2&i&&(s.R7$(11),s.R50("ngModel",n.username),s.R7$(2),s.R50("ngModel",n.password),s.Y8G("type",n.passwordType),s.R7$(),s.Y8G("name",n.passwordIcon),s.R7$(),s.Y8G("disabled",n.isLoading),s.R7$(),s.Y8G("ngIf",n.isLoading),s.R7$(),s.Y8G("ngIf",!n.isLoading),s.R7$(),s.Y8G("ngIf",n.showProgressBar))},dependencies:[R.bT,L.qT,L.BC,L.cb,L.YS,L.vS,L.cV,w.W9,w.iq,w.$w,w.FH,w.w2,w.Gw],styles:[".password-container[_ngcontent-%COMP%]{position:relative}.password-toggle-icon[_ngcontent-%COMP%]{position:absolute;right:15px;top:25px;font-size:20px;color:#666;cursor:pointer}.background-container[_ngcontent-%COMP%]{position:relative;width:100%;height:40vh;z-index:1}.background-image[_ngcontent-%COMP%]{background-image:url(https://k-studio.co.il/wp-content/uploads/2024/11/cover.jpeg);background-size:cover;background-position:center;height:100%}.logo-container[_ngcontent-%COMP%]{position:absolute;top:20px;width:100%;display:flex;justify-content:center;z-index:2}.logo-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px;height:auto}.form-container[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-top-left-radius:25px;border-top-right-radius:25px;padding:20px;margin-top:-25px;width:100%;z-index:2;height:30%}.welcome-message[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:10px;color:#333}.login-form[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.email-container[_ngcontent-%COMP%]{margin-bottom:20px}ion-input[_ngcontent-%COMP%]{color:#000;font-family:Arial,sans-serif;font-size:16px;padding:10px;background-color:#dbdbdb;text-indent:20px;border-radius:25px}ion-content[_ngcontent-%COMP%]{--keyboard-offset: 0px;height:100vh}.keyboard-open[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{height:calc(100vh - 50px);overflow-y:auto}.login-btn[_ngcontent-%COMP%]{background:#37c6c2;border-radius:25px;font-weight:700;font-size:18px;padding:10px 0;margin-top:20px;width:100%;background-activated:#744114;--background:#37c6c2;--border-radius: 25px;--background-activated: #744114;color:#fff}.login-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.login-btn[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{font-size:20px;vertical-align:middle}"]}),e})()}];let be=(()=>{var t;class e{}return(t=e).\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[$.iI.forChild(ve),$.iI]}),e})(),Pe=(()=>{var t;class e{}return(t=e).\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[R.MD,L.YN,w.bv,be]}),e})()}}]);