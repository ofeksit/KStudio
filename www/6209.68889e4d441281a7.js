"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6209],{689:(Dt,ht,k)=>{k.d(ht,{p:()=>J});var s=k(1626),E=k(1985),K=k(6354),X=k(9437),pt=k(7673),dt=k(7468),mt=k(8141),t=k(8810);var rt=k(3953),Z=k(3656),Q=k(1118),at=k(4796);let J=(()=>{var S;class U{constructor(F,G,P,H){this.platform=F,this.httpA=G,this.http=P,this.authService=H,this.headers=new s.Lr({"Content-Type":"application/json",Amelia:"C7YZnwLJ90FF42GOCkEFT9z856v6r5SQ2QWpdhGBexQk"}),this.apiUrl="https://k-studio.co.il/wp-json/custom-api/v1"}getLast60DaysAppointmentsForUser(){const F=new Date,G=this.formatDate(new Date(F.setDate(F.getDate()+30))),H=`https://k-studio.co.il/wp-admin/admin-ajax.php?action=wpamelia_api&call=/api/v1/appointments&dates=${this.formatDate(new Date(F.setDate(F.getDate()-60)))},${G}&skipServices=1&skipProviders=1`,Y=this.authService.getUserEmail(),D={Amelia:"C7YZnwLJ90FF42GOCkEFT9z856v6r5SQ2QWpdhGBexQk"};return new E.c(L=>{this.platform.ready().then(()=>{this.platform.is("cordova")?this.httpA.get(H,{},D).then(q=>{var tt;const gt=(null===(tt=JSON.parse(q.data).data)||void 0===tt?void 0:tt.appointments)||{};let yt=[];for(const _t in gt)gt.hasOwnProperty(_t)&&Array.isArray(gt[_t].appointments)&&gt[_t].appointments.forEach(ct=>{ct.bookings&&Array.isArray(ct.bookings)&&ct.bookings.forEach(nt=>{var ut;if((null===(ut=nt.customer)||void 0===ut?void 0:ut.email)===Y){nt.googleCalendarEventId=ct.googleCalendarEventId;const j={...ct,matchedBooking:nt,userBookingStatus:nt.status};yt.push(j)}})});L.next(yt),L.complete()}).catch(q=>{L.error(`Error fetching appointments: ${q}`)}):this.http.get(H,{headers:this.headers}).subscribe(q=>{var tt;const vt=(null===(tt=q.data)||void 0===tt?void 0:tt.appointments)||{};let gt=[];for(const yt in vt)vt.hasOwnProperty(yt)&&Array.isArray(vt[yt].appointments)&&vt[yt].appointments.forEach(_t=>{_t.bookings&&Array.isArray(_t.bookings)&&_t.bookings.forEach(ct=>{var nt;if((null===(nt=ct.customer)||void 0===nt?void 0:nt.email)===Y){ct.googleCalendarEventId=_t.googleCalendarEventId;const ut={..._t,matchedBooking:ct,userBookingStatus:ct.status};gt.push(ut)}})});L.next(gt),L.complete()},q=>{L.error(`Error fetching appointments: ${q}`)})})})}fetchSubscriptionExpiryDate(F){return this.http.get(`https://k-studio.co.il/wp-json/custom-api/v1/subscription-dates/?user_id={${F}}`).pipe((0,K.T)(P=>{if(!P||0===P.length)return{expiryDate:"\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05de\u05e0\u05d5\u05d9 \u05d1\u05ea\u05d5\u05e7\u05e3"};const H=P[0],Y=H.status;let D,L=new Date;return"active"===Y?(L=0!=H.expiry_date?new Date(H.expiry_date):new Date(H.renewal_date),D=`${L.getDate().toString().padStart(2,"0")}/${(L.getMonth()+1).toString().padStart(2,"0")}/${L.getFullYear()}`,this.storeSubscriptionExpiryDate(D),D="\u05ea\u05d5\u05e7\u05e3 \u05d4\u05de\u05e0\u05d5\u05d9: "+D):D="on-hold"===Y?"\u05d4\u05de\u05e0\u05d5\u05d9 \u05de\u05d5\u05e9\u05d4\u05d4":"\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05de\u05e0\u05d5\u05d9 \u05d1\u05ea\u05d5\u05e7\u05e3",{expiryDate:D}}))}fetchAvailablePackageSlots(F){return this.http.get(`https://k-studio.co.il/wp-json/wn/v1/package-purchases/${F}`,{}).pipe((0,K.T)(P=>{if(P&&P.data&&P.data.length>0){const H=P.data[0].packages;if(H&&H.length>0){const Y=H[0].purchases,D=H[0].purchases[0].packageCustomerId;if(this.authService.storePackageCustomerID(D),Y&&Y.length>0){const L=Y[0].purchase[0].available,tt=new Date(Y[0].purchased);return tt.setDate(tt.getDate()+30),{availableSlots:L,expiryDate:`${tt.getDate().toString().padStart(2,"0")}/${(tt.getMonth()+1).toString().padStart(2,"0")}/${tt.getFullYear()}`,customerPackageID:D}}}}return{availableSlots:0,expiryDate:""}}),(0,X.W)(P=>(console.error("API Error:",P),(0,pt.of)({availableSlots:0,expiryDate:""}))))}fetchSubscriptionData(F,G){const H=`https://k-studio.co.il/wp-json/wn/v1/package-purchases/${G}`;return(0,dt.p)({subscription:this.http.get(`https://k-studio.co.il/wp-json/custom-api/v1/subscription-dates/?user_id=${F}`).pipe((0,K.T)(Y=>{if(!Y||0===Y.length)return{subscriptionId:0,expiryDate:"\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05de\u05e0\u05d5\u05d9 \u05d1\u05ea\u05d5\u05e7\u05e3"};const D=Y[0],L=D.status;let q,tt=new Date;return"active"===L?(tt=0!=D.expiry_date?new Date(D.expiry_date):new Date(D.renewal_date),q=`${tt.getDate().toString().padStart(2,"0")}/${(tt.getMonth()+1).toString().padStart(2,"0")}/${tt.getFullYear()}`,this.storeSubscriptionExpiryDate(q),q="\u05ea\u05d5\u05e7\u05e3 \u05d4\u05de\u05e0\u05d5\u05d9: "+q):q="on-hold"===L?"\u05d4\u05de\u05e0\u05d5\u05d9 \u05de\u05d5\u05e9\u05d4\u05d4":"\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05de\u05e0\u05d5\u05d9 \u05d1\u05ea\u05d5\u05e7\u05e3",{subscriptionId:D.subscription_id,expiryDate:q}})),packageSlots:this.http.get(H).pipe((0,K.T)(Y=>{if(Y&&Y.data&&Y.data.length>0){const D=Y.data[0].packages;if(D&&D.length>0){const L=D[0].purchases;if(this.authService.storePackageCustomerID(L[0].packageCustomerId),L&&L.length>0)return{availableSlots:L[0].purchase[0].available}}}return{availableSlots:0}}),(0,X.W)(Y=>(console.error("Package API Error:",Y),(0,pt.of)({availableSlots:0}))))}).pipe((0,K.T)(({subscription:Y,packageSlots:D})=>({subscriptionId:Y.subscriptionId,expiryDate:Y.expiryDate,availableSlots:D.availableSlots})))}getUserPackageCustomerID(){const G=`https://k-studio.co.il/wp-json/wn/v1/package-purchases/${this.authService.getPackageCustomerId()}`;return this.http.get(G,{}).pipe((0,K.T)(P=>{P&&P.data&&P.data[0]&&P.data[0].packages[0]&&P.data[0].packages[0].purchases[0]&&P.data[0].packages[0].purchases[0].packageCustomerId&&this.authService.storePackageCustomerID(P.data[0].packages[0].purchases[0].packageCustomerId)}),(0,X.W)(P=>(console.error("API Error:",P),(0,pt.of)({availableSlots:0,expiryDate:""}))))}fetchUserPurchases(F){return this.http.get(`https://k-studio.co.il/wp-json/wn/v1/user-purchases/${F}`,{}).pipe((0,K.T)(P=>(P.forEach(H=>{H.invoice_link||(H.invoice_link="")}),P||[])),(0,X.W)(P=>(console.error("Error fetching user purchases:",P),(0,pt.of)([]))))}updateFavoriteLocation(F){const P="https://k-studio.co.il/wp-json/custom-api/v1/set-favorite-location?user_id="+this.authService.getUserID();return this.http.post(P,{favorite_location:F}).pipe((0,mt.M)(()=>console.log("HTTP request sent")),(0,K.T)(Y=>(this.authService.storeFavLocation(F),Y)),(0,X.W)(Y=>(console.error("HTTP Error:",Y),(0,t.$)(()=>new Error("Failed to update favorite location")))))}cancelBooking(F){return this.http.post(`https://k-studio.co.il/wp-json/wn/v1/cancel-booking/${F}`,{})}formatDate(F){return`${F.getFullYear()}-${(F.getMonth()+1).toString().padStart(2,"0")}-${F.getDate().toString().padStart(2,"0")}`}storeSubscriptionExpiryDate(F){localStorage.setItem("subscription_expiry_date",F)}getSubscriptionExpiryDate(){return localStorage.getItem("subscription_expiry_date")}addNote(F,G,P,H){return this.http.post(`${this.apiUrl}/add-note`,{userID:F,title:G,content:P,color:H})}removeNote(F){return this.http.post(`${this.apiUrl}/remove-note`,{note_id:F})}editNote(F,G,P,H){return this.http.post(`${this.apiUrl}/edit-note`,{note_id:F,title:G,content:P,color:H})}getNotesByUser(F){return this.http.get(`${this.apiUrl}/get-notes-by-user?user_id=${F}`)}}return(S=U).\u0275fac=function(F){return new(F||S)(rt.KVO(Z.OD),rt.KVO(Q.B),rt.KVO(s.Qq),rt.KVO(at.u))},S.\u0275prov=rt.jDH({token:S,factory:S.\u0275fac,providedIn:"root"}),U})()},5480:(Dt,ht,k)=>{k.d(ht,{T:()=>Gt});var s=k(467),E=k(9969),K=k(1626),X=k(7586),pt=k(9350),dt=k(7707);function mt(_,x){const h="object"==typeof x;return new Promise((e,n)=>{const p=new dt.Ms({next:y=>{e(y),p.unsubscribe()},error:n,complete:()=>{h?e(x.defaultValue):n(new pt.G)}});_.subscribe(p)})}var t=k(3953),w=k(791),rt=k(4938),Z=k(177);function Q(_,x){if(1&_&&(t.j41(0,"div",9)(1,"h3",10),t.EFF(2),t.k0s(),t.j41(3,"p",11),t.EFF(4),t.k0s()()),2&_){const h=x.$implicit,e=t.XpG();t.R7$(2),t.JRh(e.getDayInHebrew(h.name)),t.R7$(2),t.JRh(h.date)}}function at(_,x){if(1&_&&(t.j41(0,"div")(1,"p",16),t.EFF(2),t.k0s(),t.j41(3,"p",17),t.EFF(4),t.k0s()()),2&_){const h=t.XpG().$implicit,e=t.XpG().$implicit;t.R7$(2),t.JRh(h.trainings[e].time),t.R7$(2),t.JRh(h.trainings[e].title)}}function J(_,x){1&_&&(t.j41(0,"div")(1,"p",18),t.EFF(2,"-"),t.k0s()())}function S(_,x){if(1&_&&(t.j41(0,"div",14),t.DNE(1,at,5,2,"div",15)(2,J,3,0,"div",15),t.k0s()),2&_){const h=x.$implicit,e=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",h.trainings[e]),t.R7$(),t.Y8G("ngIf",!h.trainings[e])}}function U(_,x){if(1&_&&(t.j41(0,"div",12),t.DNE(1,S,3,2,"div",13),t.k0s()),2&_){const h=t.XpG();t.R7$(),t.Y8G("ngForOf",h.days)}}let $=(()=>{var _;class x{constructor(e,n){this.modalCtrl=e,this.ameliaService=n,this.branch="main",this.days=[],this.hebrewDaysMap={Sunday:"\u05e8\u05d0\u05e9\u05d5\u05df",Monday:"\u05e9\u05e0\u05d9",Tuesday:"\u05e9\u05dc\u05d9\u05e9\u05d9",Wednesday:"\u05e8\u05d1\u05d9\u05e2\u05d9",Thursday:"\u05d7\u05de\u05d9\u05e9\u05d9",Friday:"\u05e9\u05d9\u05e9\u05d9",Saturday:"\u05e9\u05d1\u05ea"},this.daysOfWeekEnglish=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}ngOnInit(){this.loadWeeklyTrainings()}loadWeeklyTrainings(){const e=this.ameliaService.getTrainingsTitles(this.branch);this.days=this.daysOfWeekEnglish.map((n,p)=>({name:n,date:X().day(p).format("DD/MM/YYYY"),trainings:e[n]||[]}))}refreshTrainings(){var e=this;return(0,s.A)(function*(){try{yield e.ameliaService.fetchTitleTrainings("main"),e.loadWeeklyTrainings()}catch(n){console.error("Error refreshing trainings:",n)}try{yield e.ameliaService.fetchTitleTrainings("second"),e.loadWeeklyTrainings()}catch(n){console.error("Error refreshing trainings:",n)}})()}getDayInHebrew(e){return this.hebrewDaysMap[e]||e}getMaxTrainingsLength(){return Math.max(...this.days.map(e=>e.trainings.length),0)}getRange(e){return Array.from({length:e},(n,p)=>p)}getDayName(e){return this.daysOfWeekEnglish[e%7]}getDateByOffset(e){return X().add(e,"days").format("DD/MM/YYYY")}getBranchTitle(){return"main"===this.branch?"\u05e1\u05e0\u05d9\u05e3 \u05e8\u05d0\u05e9\u05d9":"\u05e1\u05e0\u05d9\u05e3 \u05de\u05e9\u05e0\u05d9"}dismiss(){this.modalCtrl.dismiss()}}return(_=x).\u0275fac=function(e){return new(e||_)(t.rXU(w.W3),t.rXU(rt.J))},_.\u0275cmp=t.VBU({type:_,selectors:[["app-calendar-popup"]],inputs:{weeklyData:"weeklyData",branch:"branch"},decls:13,vars:2,consts:[[1,"modal-title"],["slot","end"],["fill","clear",3,"click"],[1,"modal-content"],[1,"calendar-table-wrapper"],[1,"calendar-table"],[1,"table-header"],["class","day-header",4,"ngFor","ngForOf"],["class","table-row",4,"ngFor","ngForOf"],[1,"day-header"],[1,"dayName"],[1,"dayDate"],[1,"table-row"],["class","table-cell training-cell",4,"ngFor","ngForOf"],[1,"table-cell","training-cell"],[4,"ngIf"],[1,"training-time"],[1,"training-title"],[1,"empty-slot"]],template:function(e,n){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),t.EFF(3,"\u05d4\u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd \u05d4\u05e7\u05e8\u05d5\u05d1\u05d9\u05dd"),t.k0s(),t.j41(4,"ion-buttons",1)(5,"ion-button",2),t.bIt("click",function(){return n.dismiss()}),t.EFF(6,"\u05e1\u05d2\u05d5\u05e8"),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"div",4)(9,"div",5)(10,"div",6),t.DNE(11,Q,5,2,"div",7),t.k0s(),t.DNE(12,U,2,1,"div",8),t.k0s()()()),2&e&&(t.R7$(11),t.Y8G("ngForOf",n.days),t.R7$(),t.Y8G("ngForOf",n.getRange(n.getMaxTrainingsLength())))},dependencies:[Z.Sq,Z.bT,w.Jm,w.QW,w.W9,w.eU,w.BC,w.ai],styles:[".modal-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.modal-content[_ngcontent-%COMP%]{--background: #f8f9fa;padding:16px}.calendar-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;white-space:nowrap;padding:8px}.calendar-table[_ngcontent-%COMP%]{display:grid;gap:1px;min-width:700px;background-color:#ddd}.table-header[_ngcontent-%COMP%]{display:contents}.day-header[_ngcontent-%COMP%]{background:#f60;color:#fff;text-align:center;padding:8px;border-radius:6px 6px 0 0;font-size:14px;font-weight:700}.table-row[_ngcontent-%COMP%]{display:contents}.table-cell[_ngcontent-%COMP%]{background:#fff;text-align:center;padding:8px;font-size:14px;min-height:60px}.training-time[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin:0;color:#333}.training-title[_ngcontent-%COMP%]{font-size:12px;margin:4px 0 0;color:#555}.empty-slot[_ngcontent-%COMP%]{color:#ccc;font-size:14px}@media (max-width: 768px){.calendar-table[_ngcontent-%COMP%]{grid-template-columns:repeat(7,minmax(120px,1fr))}.day-header[_ngcontent-%COMP%], .training-time[_ngcontent-%COMP%]{font-size:12px}}.dayName[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.dayDate[_ngcontent-%COMP%]{font-size:12px;margin-top:-20px;text-decoration:none;font-weight:200}"]}),x})(),F=(()=>{var _;class x{constructor(e){this.http=e,this.apiUrl="https://k-studio.co.il/wp-json/training-music/v1",this.clientId="b46968a8339c459181a8fc6057ec0438",this.clientSecret="c7757feb5518452cafe80565af400216",this.refreshToken="AQC9oH-UuUUDtAsHJ1NBsvmWb634P8eFEFRT6i86SkTDNme8MSTV3g4gT-SJJVCbq-8xoja2TLbw5G0rntYZnFBFYElIwmVTU4MT3c8NLFNTmy1SDa3DmGkAc-G7aRc9yeg",this.spotifyUserId="",this.backupPlaylistId="37i9dQZF1DX76Wlfdnj7AP",this.getSpotifyUserId()}getSpotifyToken(){var e=this;return(0,s.A)(function*(){const n=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa(e.clientId+":"+e.clientSecret)},body:`grant_type=refresh_token&refresh_token=${e.refreshToken}`});if(!n.ok){const y=yield n.text();throw console.error("Spotify Token Error:",y),new Error("Failed to refresh Spotify token")}return(yield n.json()).access_token})()}getSpotifyUserId(){var e=this;return(0,s.A)(function*(){const n=yield e.getSpotifyToken(),p=yield fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${n}`}});if(!p.ok)return void console.error("Error fetching Spotify User ID");const y=yield p.json();e.spotifyUserId=y.id})()}searchSongs(e){var n=this;return(0,s.A)(function*(){var p;const y=yield n.getSpotifyToken(),I=yield fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track&limit=10`,{headers:{Authorization:`Bearer ${y}`}});if(!I.ok){const N=yield I.text();throw console.error("Spotify Search Error:",N),new Error("Failed to fetch songs from Spotify")}return((null===(p=(yield I.json()).tracks)||void 0===p?void 0:p.items)||[]).filter(N=>N&&N.duration_ms&&!isNaN(N.duration_ms))})()}getSongsForTraining(e){return this.http.get(`${this.apiUrl}/get-songs/?training_id=${e}`)}addSongToTraining(e,n,p){var y,I;const A={training_id:e,user_id:n,song_id:p.id,song_name:p.name,artist_name:(null===(y=p.artists[0])||void 0===y?void 0:y.name)||"UNKNOWN",artist_image:(null===(I=p.album)||void 0===I||null===(I=I.images[0])||void 0===I?void 0:I.url)||"UNKNOWN",duration_ms:p.duration_ms};return this.http.post(`${this.apiUrl}/add-song`,A)}removeSongFromTraining(e,n,p){return this.http.post(`${this.apiUrl}/remove-song/`,{training_id:e,user_id:n,song_id:p})}createPlaylist(e,n){var p=this;return(0,s.A)(function*(){if(!p.spotifyUserId)throw console.error("\u274c Spotify User ID not available"),new Error("Spotify User ID not available");yield p.deleteOldPlaylists();const y=n.reduce((R,V)=>{const N=V.duration_ms||(null==V?void 0:V.duration)||0,lt="string"==typeof N?parseInt(N):N;return isNaN(lt)?(console.warn(`\u26a0\ufe0f Invalid duration for song: ${V.song_name||"Unknown"}:`,N),R):R+lt/1e3},0),I=yield p.getSpotifyToken(),A=`https://api.spotify.com/v1/users/${p.spotifyUserId}/playlists`;try{const R=yield p.http.post(A,{name:e,description:"Training Playlist",public:!1},{headers:new K.Lr({Authorization:`Bearer ${I}`,"Content-Type":"application/json"})}).toPromise();if(null==R||!R.id)return console.error("\u274c Failed to create playlist: No ID returned"),null;const V=R.id;let N=[...n];if(y<3600){const ot=3600-y,et=yield p.getBackupSongs(ot);N=[...n,...et]}const lt=N.map(ot=>{const et=ot.song_id||ot.id;return et?`spotify:track:${et}`:(console.warn(`\u26a0\ufe0f Missing song ID for: ${ot.song_name||"Unknown song"}`),null)}).filter(ot=>null!==ot);return 0===lt.length?(console.error("\u274c No valid songs to add. Aborting playlist creation."),null):(yield p.addSongsToPlaylist(V,lt),V)}catch(R){return console.error("\u274c Error creating playlist:",R),null}})()}getBackupSongs(e){var n=this;return(0,s.A)(function*(){const p=yield n.getSpotifyToken(),I=new K.Lr({Authorization:`Bearer ${p}`});try{const A=yield n.http.get("https://api.spotify.com/v1/me/playlists",{headers:I}).toPromise();if(!A||!A.items)return console.error("Error: Unable to fetch user playlists.",A),[];const R=A.items.find(b=>b.name.toLowerCase().includes("backup"));if(!R)return console.error("\u274c Error: No backup playlist found."),[];const N=`https://api.spotify.com/v1/playlists/${R.id}/tracks`,lt=yield n.http.get(N,{headers:I}).toPromise();if(!lt||!lt.items)return console.error("\u274c Error: No tracks found in backup playlist."),[];let ot=lt.items.map(b=>b.track);ot=ot.filter(b=>b&&b.id&&b.duration_ms&&!isNaN(b.duration_ms));let et=0;const m=[];for(const b of ot){if(et+b.duration_ms/1e3>e)break;m.push(b),et+=b.duration_ms/1e3}return m}catch(A){return console.error("\u274c Error fetching backup songs:",A),[]}})()}addSongsToPlaylist(e,n){var p=this;return(0,s.A)(function*(){if(!e||"undefined"===e)return void console.error("\u274c Invalid playlist ID:",e);if(!n.length)return void console.error("\u274c No songs to add.");const y=yield p.getSpotifyToken(),I=`https://api.spotify.com/v1/playlists/${e}/tracks`,A=new K.Lr({Authorization:`Bearer ${y}`,"Content-Type":"application/json"}),R={uris:n.filter(V=>V.startsWith("spotify:track:"))};if(0!==R.uris.length)try{yield p.http.post(I,R,{headers:A}).toPromise()}catch(V){console.error("\u274c Error adding songs to playlist:",V)}else console.error("\u274c No valid track URIs found. Aborting song addition.")})()}getUserPlaylist(){var e=this;return(0,s.A)(function*(){const n=yield e.getSpotifyToken(),y=new K.Lr({Authorization:`Bearer ${n}`,"Content-Type":"application/json"});let I=[],A="https://api.spotify.com/v1/me/playlists?limit=50&market=US";try{for(;A;){let R="";if(R=yield e.http.get(A,{headers:y}).toPromise().catch(()=>({items:[],next:null})),!R||!R.items){console.warn("Spotify API returned an empty response.");break}I=I.concat(R.items),A=R.next}return I}catch(R){return console.error("Error fetching user playlists:",R),[]}})()}deleteOldPlaylists(){var e=this;return(0,s.A)(function*(){const n=yield e.getUserPlaylist(),p=new Date;p.setDate(p.getDate()-2);for(const y of n)y.name.startsWith("Training -")&&new Date(y.name.split(" - ")[1])<p&&(yield e.deletePlaylist(y.id))})()}deletePlaylist(e){var n=this;return(0,s.A)(function*(){const p=yield n.getSpotifyToken(),y=`https://api.spotify.com/v1/playlists/${e}/followers`,I=new K.Lr({Authorization:`Bearer ${p}`,"Content-Type":"application/json"});try{yield n.http.delete(y,{headers:I}).toPromise()}catch(A){console.error(`Error deleting playlist ${e}`,A)}})()}}return(_=x).\u0275fac=function(e){return new(e||_)(t.KVO(K.Qq))},_.\u0275prov=t.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),x})();var G=k(4796),P=k(9417);const H=["searchInput"],Y=["selectedSongsList"],D=(_,x)=>({"fade-in":_,"fade-out":x});function L(_,x){1&_&&(t.j41(0,"div",14),t.nrm(1,"ion-spinner",15),t.k0s())}function q(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-button",22),t.bIt("click",function(){t.eBV(h);const n=t.XpG().$implicit,p=t.XpG(2);return t.Njj(p.addSong(n))}),t.nrm(1,"ion-icon",23),t.k0s()}}function tt(_,x){if(1&_&&(t.j41(0,"ion-item",18)(1,"ion-thumbnail",19),t.nrm(2,"img",20),t.k0s(),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s()(),t.DNE(8,q,2,0,"ion-button",21),t.k0s()),2&_){const h=x.$implicit,e=t.XpG(2);t.R7$(2),t.Y8G("src",(null==h.album||null==h.album.images[0]?null:h.album.images[0].url)||"assets/default-artist.png",t.B4B),t.R7$(3),t.JRh(h.name),t.R7$(2),t.JRh(null==h.artists[0]?null:h.artists[0].name),t.R7$(),t.Y8G("ngIf",!e.isAddedToSelectedSongs(h))}}function vt(_,x){if(1&_&&(t.j41(0,"ion-list",16),t.DNE(1,tt,9,4,"ion-item",17),t.k0s()),2&_){const h=t.XpG();t.R7$(),t.Y8G("ngForOf",h.searchResults)}}function gt(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-button",27),t.bIt("click",function(){t.eBV(h);const n=t.XpG().$implicit,p=t.XpG();return t.Njj(p.removeSong(n))}),t.nrm(1,"ion-icon",28),t.k0s()}}function yt(_,x){if(1&_&&(t.j41(0,"ion-item",24)(1,"ion-thumbnail",19),t.nrm(2,"img",25),t.k0s(),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s()(),t.DNE(8,gt,2,0,"ion-button",26),t.k0s()),2&_){const h=x.$implicit,e=t.XpG();t.Y8G("ngClass",t.l_i(5,D,h.isNew,h.isFadingOut)),t.R7$(2),t.Y8G("src",h.artist_image,t.B4B),t.R7$(3),t.JRh(h.song_name),t.R7$(2),t.JRh(h.artist_name),t.R7$(),t.Y8G("ngIf",h.user_id===e.userId||"administrator"===e.userRole||"team"===e.userRole)}}function _t(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-fab",29)(1,"ion-fab-button",30),t.bIt("click",function(){t.eBV(h);const n=t.XpG();return t.Njj(n.createSpotifyPlaylist())}),t.nrm(2,"ion-icon",31),t.k0s()()}}let ct=(()=>{var _;class x{constructor(e,n,p,y,I){this.modalCtrl=e,this.spotifyService=n,this.authService=p,this.toastController=y,this.animationCtrl=I,this.searchQuery="",this.searchResults=[],this.selectedSongs=[],this.userId="",this.userRole="",this.errorMessage="",this.isSearching=!1,this.userId=this.authService.getUserID(),this.userRole=this.authService.getUserRole()}ngOnInit(){this.loadTrainingSongs()}searchSongs(){var e=this;return(0,s.A)(function*(){if(e.searchQuery.trim()){e.isSearching=!0;try{e.searchResults=yield e.spotifyService.searchSongs(e.searchQuery)}catch(n){console.error("Search error:",n),e.presentToast("Failed to search songs","danger")}finally{e.isSearching=!1}}else e.searchResults=[]})()}addSong(e){var n,p;const y={song_id:e.id,song_name:e.name,artist_name:(null===(n=e.artists[0])||void 0===n?void 0:n.name)||"Unknown Artist",artist_image:(null===(p=e.album)||void 0===p||null===(p=p.images[0])||void 0===p?void 0:p.url)||"assets/default-artist.png",user_id:this.userId,duration_ms:e.duration_ms,isNew:!0,isFadingOut:!1};this.selectedSongs.some(I=>I.song_id===y.song_id)||this.selectedSongs.push(y),this.spotifyService.addSongToTraining(this.training.id,this.userId,e).subscribe(()=>{},I=>{console.error("Error adding song:",I),this.presentToast("Failed to add song","danger"),this.selectedSongs=this.selectedSongs.filter(A=>A.song_id!==y.song_id)}),this.clearSearch(),this.animateAddSong()}removeSong(e){const n=this.selectedSongs.findIndex(p=>p.song_id===e.song_id);-1!==n&&(this.selectedSongs[n].isFadingOut=!0,setTimeout(()=>{this.selectedSongs=this.selectedSongs.filter(p=>p.song_id!==e.song_id),this.spotifyService.removeSongFromTraining(this.training.id,this.userId,e.song_id).subscribe(()=>{},p=>{console.error("Error removing song:",p),this.presentToast("Failed to remove song","danger")})},300))}animateAddSong(){setTimeout(()=>{this.selectedSongsList&&this.animationCtrl.create().addElement(this.selectedSongsList.nativeElement).duration(300).fromTo("opacity","0.5","1").fromTo("transform","scale(0.95)","scale(1)").play()},50)}loadTrainingSongs(){this.spotifyService.getSongsForTraining(this.training.id).subscribe(e=>{this.selectedSongs=e.map(n=>({...n,artist_image:n.artist_image||"assets/default-artist.png"}))},e=>{console.error("Error fetching songs:",e),this.presentToast("Failed to load songs","danger")})}clearSearch(){this.searchQuery="",this.searchResults=[],this.searchInput&&(this.searchInput.nativeElement.value="",this.searchInput.nativeElement.blur())}isAddedToSelectedSongs(e){return this.selectedSongs.some(n=>n.song_id===e.id)}getTotalDuration(){const e=this.selectedSongs.reduce((I,A)=>{const R="string"==typeof A.duration_ms?parseInt(A.duration_ms):A.duration_ms;return I+(isNaN(R)?0:R)},0),n=Math.floor(e/1e3);return`${Math.floor(n/60)}:${(n%60).toString().padStart(2,"0")}`}saveSelection(){this.modalCtrl.dismiss(this.selectedSongs)}closeModal(){this.modalCtrl.dismiss()}presentToast(e,n){var p=this;return(0,s.A)(function*(){yield(yield p.toastController.create({message:e,duration:2500,color:n,position:"bottom"})).present()})()}createSpotifyPlaylist(){var e=this;return(0,s.A)(function*(){if(!e.selectedSongs.length)return void e.presentToast("No songs in the playlist!","danger");const n=`Training - ${e.training.start_time}`;try{if(!(yield e.spotifyService.createPlaylist(n,e.selectedSongs)))return console.error("\u274c Playlist creation failed."),void e.presentToast("Failed to create playlist","danger");e.presentToast("\u05d4\u05e4\u05dc\u05d9\u05d9\u05dc\u05d9\u05e1\u05d8 \u05e0\u05d5\u05e6\u05e8 \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4!","success")}catch(p){console.error("\u274c Error creating playlist:",p),e.presentToast("Failed to create playlist","danger")}})()}}return(_=x).\u0275fac=function(e){return new(e||_)(t.rXU(w.W3),t.rXU(F),t.rXU(G.u),t.rXU(w.K_),t.rXU(w.Hx))},_.\u0275cmp=t.VBU({type:_,selectors:[["app-music-modal"]],viewQuery:function(e,n){if(1&e&&(t.GBs(H,5),t.GBs(Y,5)),2&e){let p;t.mGM(p=t.lsd())&&(n.searchInput=p.first),t.mGM(p=t.lsd())&&(n.selectedSongsList=p.first)}},inputs:{training:"training"},decls:19,vars:5,consts:[["searchInput",""],["selectedSongsList",""],[1,"music-modal-container"],["slot","end"],[1,"close-button",3,"click"],["name","close-outline"],[1,"search-container"],["placeholder","\u05d7\u05d9\u05e4\u05d5\u05e9",1,"custom-searchbar",3,"ngModelChange","ionInput","ionClear","ngModel"],["class","search-loading",4,"ngIf"],["class","search-results-list",4,"ngIf"],[1,"selected-songs-container"],[1,"selected-songs-list"],[3,"ngClass",4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end",4,"ngIf"],[1,"search-loading"],["name","lines-small","color","primary"],[1,"search-results-list"],["class","fade-in",4,"ngFor","ngForOf"],[1,"fade-in"],["slot","start"],[1,"song-thumbnail",3,"src"],["color","primary","fill","clear","class","add-song-btn",3,"click",4,"ngIf"],["color","primary","fill","clear",1,"add-song-btn",3,"click"],["name","add-circle-outline"],[3,"ngClass"],[1,"artist-image",3,"src"],["color","danger","fill","clear","class","remove-song-btn",3,"click",4,"ngIf"],["color","danger","fill","clear",1,"remove-song-btn",3,"click"],["name","trash-outline"],["slot","fixed","vertical","bottom","horizontal","end"],["color","success",3,"click"],["name","musical-notes-outline"]],template:function(e,n){if(1&e){const p=t.RV6();t.j41(0,"div",2)(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",3)(4,"ion-button",4),t.bIt("click",function(){return t.eBV(p),t.Njj(n.closeModal())}),t.nrm(5,"ion-icon",5),t.k0s()(),t.j41(6,"ion-title"),t.EFF(7,"\u05e4\u05dc\u05d9\u05d9\u05dc\u05d9\u05e1\u05d8 \u05d0\u05d9\u05de\u05d5\u05df"),t.k0s()()(),t.j41(8,"ion-content")(9,"div",6)(10,"ion-searchbar",7,0),t.mxI("ngModelChange",function(I){return t.eBV(p),t.DH7(n.searchQuery,I)||(n.searchQuery=I),t.Njj(I)}),t.bIt("ionInput",function(){return t.eBV(p),t.Njj(n.searchSongs())})("ionClear",function(){return t.eBV(p),t.Njj(n.clearSearch())}),t.k0s(),t.DNE(12,L,2,0,"div",8),t.k0s(),t.DNE(13,vt,2,1,"ion-list",9),t.j41(14,"div",10)(15,"ion-list",11,1),t.DNE(17,yt,9,8,"ion-item",12),t.k0s(),t.DNE(18,_t,3,0,"ion-fab",13),t.k0s()()()}2&e&&(t.R7$(10),t.R50("ngModel",n.searchQuery),t.R7$(2),t.Y8G("ngIf",n.isSearching),t.R7$(),t.Y8G("ngIf",n.searchResults.length>0),t.R7$(4),t.Y8G("ngForOf",n.selectedSongs),t.R7$(),t.Y8G("ngIf","administrator"===n.userRole||"team"===n.userRole))},dependencies:[Z.YU,Z.Sq,Z.bT,P.BC,P.vS,w.Jm,w.QW,w.W9,w.Q8,w.YW,w.eU,w.iq,w.uz,w.he,w.nf,w.S1,w.w2,w.Zx,w.BC,w.ai,w.Gw],styles:[".music-modal-container[_ngcontent-%COMP%]{--background: #f4f5f8;height:100%;display:flex;flex-direction:column;background:linear-gradient(135deg,#f4f5f8,#e9ecef)}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--border-width: 0}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{color:#333;transition:transform .2s ease}.music-modal-container[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{transform:scale(.9)}.music-modal-container[_ngcontent-%COMP%]   .fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.music-modal-container[_ngcontent-%COMP%]   .fade-out[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeOut .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_fadeOut{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.95)}}.music-modal-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-size:1.1em;font-family:Alef;line-height:15px}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;padding:10px;background-color:#fff}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .custom-searchbar[_ngcontent-%COMP%]{--background: #f0f0f0;transition:all .3s ease}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .custom-searchbar[_ngcontent-%COMP%]:focus{--background: #e0e0e0;box-shadow:0 2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-loading[_ngcontent-%COMP%]{position:absolute;top:50%;right:20px;transform:translateY(-50%)}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{transition:background-color .3s ease}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:active{background-color:#0000000d}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .song-thumbnail[_ngcontent-%COMP%]{border-radius:8px;transition:transform .2s ease}.music-modal-container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .song-thumbnail[_ngcontent-%COMP%]:active{transform:scale(.95)}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;background-color:#fff;box-shadow:0 -4px 6px #0000000d}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;background-color:#f8f9fa}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:600;color:#333}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-header[_ngcontent-%COMP%]   .total-duration[_ngcontent-%COMP%]{color:#6c757d;font-size:.9em;background-color:#e9ecef;padding:5px 10px;border-radius:15px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]{height:calc(100% - 60px);overflow-y:auto;background-color:#fff;scrollbar-width:thin;scrollbar-color:#ccc #f1f3f5}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f3f5;border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   .selected-songs-container[_ngcontent-%COMP%]   .selected-songs-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#ccc;border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 15px;--inner-padding-end: 15px;margin:5px 0;border-radius:10px;transition:background-color .3s ease}.music-modal-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{--background: #f4f4f4}.music-modal-container[_ngcontent-%COMP%]   .artist-image[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;object-fit:cover;box-shadow:0 2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:10px}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]{padding:10px;background-color:#fff;box-shadow:0 -2px 4px #0000001a}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]   .save-playlist-btn[_ngcontent-%COMP%]{margin:0;height:50px;--border-radius: 10px;transition:all .3s ease}.music-modal-container[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]   .save-playlist-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"],data:{animation:[(0,E.hZ)("songListAnimation",[(0,E.kY)(":enter",[(0,E.P)(":enter",[(0,E.iF)({opacity:0,transform:"translateY(20px)"}),(0,E.yc)(50,[(0,E.i0)("300ms ease-out",(0,E.iF)({opacity:1,transform:"translateY(0)"}))])],{optional:!0})]),(0,E.kY)(":leave",[(0,E.P)(":leave",[(0,E.i0)("200ms ease-in",(0,E.iF)({opacity:0,transform:"translateX(-100%)"}))],{optional:!0})])])]}}),x})();var nt=k(3656),ut=k(689),j=k(1635),C=k(4594),it=function(_){function x(){return null!==_&&_.apply(this,arguments)||this}return(0,j.C6)(x,_),x.prototype.hasReadWritePermission=function(){return(0,C.bk)(this,"hasReadWritePermission",{},arguments)},x.prototype.hasReadPermission=function(){return(0,C.bk)(this,"hasReadPermission",{},arguments)},x.prototype.hasWritePermission=function(){return(0,C.bk)(this,"hasWritePermission",{},arguments)},x.prototype.requestWritePermission=function(){return(0,C.bk)(this,"requestWritePermission",{},arguments)},x.prototype.requestReadPermission=function(){return(0,C.bk)(this,"requestReadPermission",{},arguments)},x.prototype.requestReadWritePermission=function(){return(0,C.bk)(this,"requestReadWritePermission",{},arguments)},x.prototype.createCalendar=function(h){return(0,C.bk)(this,"createCalendar",{},arguments)},x.prototype.deleteCalendar=function(h){return(0,C.bk)(this,"deleteCalendar",{},arguments)},x.prototype.getCalendarOptions=function(){return(0,C.bk)(this,"getCalendarOptions",{sync:!0},arguments)},x.prototype.getCreateCalendarOptions=function(){return(0,C.bk)(this,"getCreateCalendarOptions",{sync:!0},arguments)},x.prototype.createEvent=function(h,e,n,p,y){return(0,C.bk)(this,"createEvent",{},arguments)},x.prototype.createEventWithOptions=function(h,e,n,p,y,I){return(0,C.bk)(this,"createEventWithOptions",{},arguments)},x.prototype.createEventInteractively=function(h,e,n,p,y){return(0,C.bk)(this,"createEventInteractively",{},arguments)},x.prototype.createEventInteractivelyWithOptions=function(h,e,n,p,y,I){return(0,C.bk)(this,"createEventInteractivelyWithOptions",{},arguments)},x.prototype.findEvent=function(h,e,n,p,y){return(0,C.bk)(this,"findEvent",{},arguments)},x.prototype.findEventWithOptions=function(h,e,n,p,y,I){return(0,C.bk)(this,"findEventWithOptions",{},arguments)},x.prototype.listEventsInRange=function(h,e){return(0,C.bk)(this,"listEventsInRange",{platforms:["Android"]},arguments)},x.prototype.listCalendars=function(){return(0,C.bk)(this,"listCalendars",{},arguments)},x.prototype.findAllEventsInNamedCalendar=function(h){return(0,C.bk)(this,"findAllEventsInNamedCalendar",{platforms:["iOS"]},arguments)},x.prototype.modifyEvent=function(h,e,n,p,y,I,A,R,V,N){return(0,C.bk)(this,"modifyEvent",{platforms:["iOS"]},arguments)},x.prototype.modifyEventWithOptions=function(h,e,n,p,y,I,A,R,V,N,lt,ot){return(0,C.bk)(this,"modifyEventWithOptions",{platforms:["iOS"]},arguments)},x.prototype.deleteEvent=function(h,e,n,p,y){return(0,C.bk)(this,"deleteEvent",{},arguments)},x.prototype.deleteEventFromNamedCalendar=function(h,e,n,p,y,I){return(0,C.bk)(this,"deleteEventFromNamedCalendar",{platforms:["iOS"]},arguments)},x.prototype.deleteEventById=function(h,e){return(0,C.bk)(this,"deleteEventById",{},arguments)},x.prototype.openCalendar=function(h){return(0,C.bk)(this,"openCalendar",{},arguments)},x.\u0275fac=(()=>{let h;return function(n){return(h||(h=t.xGo(x)))(n||x)}})(),x.\u0275prov=t.jDH({token:x,factory:x.\u0275fac}),x.pluginName="Calendar",x.plugin="cordova-plugin-calendar",x.pluginRef="plugins.calendar",x.repo="https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin",x.platforms=["Android","iOS"],x=(0,j.Cg)([],x)}(C.UF);let xt=(()=>{var _;class x{constructor(e,n){this.platform=e,this.calendar=n}addEventToCalendar(e,n,p,y,I){var A=this;return(0,s.A)(function*(){if(A.platform.is("capacitor"))try{(yield A.calendar.hasReadWritePermission())||(yield A.calendar.requestReadWritePermission()),yield A.calendar.createEvent(e,n,p,y,I),console.log("Event added to calendar succesfully!")}catch(R){console.error("Error adding event to calendar: ",R)}else console.warn("Calendar Plugin only works on mobile devices!")})()}}return(_=x).\u0275fac=function(e){return new(e||_)(t.KVO(nt.OD),t.KVO(it))},_.\u0275prov=t.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),x})();const bt=["popup"],kt=["segmentScroll"],Nt=["indicator"],Yt=["segmentButton"],At=()=>[1,2,3,4],Tt=_=>({"background-color":_}),Bt=(_,x,h,e)=>({"standby-enrolled":_,loading:x,success:h,error:e}),Jt=(_,x)=>({loading:_,success:x});function Kt(_,x){1&_&&(t.j41(0,"ion-segment-button",14)(1,"ion-label"),t.EFF(2,"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"),t.k0s()())}function jt(_,x){1&_&&(t.j41(0,"ion-segment-button",15)(1,"ion-label"),t.EFF(2,"\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"),t.k0s()())}function Ft(_,x){if(1&_){const h=t.RV6();t.qex(0),t.j41(1,"button",21,2),t.bIt("click",function(){const n=t.eBV(h).$implicit,p=t.XpG(2);return t.Njj(p.onDayChange(n.date))}),t.j41(3,"span",22),t.EFF(4),t.k0s(),t.j41(5,"span",22),t.EFF(6),t.k0s()(),t.bVm()}if(2&_){const h=x.$implicit,e=t.XpG(2);t.R7$(),t.AVh("active",e.selectedDay===h.date),t.R7$(3),t.SpI("",h.day," "),t.R7$(2),t.JRh(h.formattedDate)}}function $t(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-icon",30),t.bIt("click",function(){t.eBV(h);const n=t.XpG(3);return t.Njj(n.openCalendarPopup())}),t.k0s()}}function qt(_,x){if(1&_){const h=t.RV6();t.j41(0,"div",23)(1,"button",24),t.bIt("click",function(n){t.eBV(h);const p=t.XpG(2);return t.Njj(p.toggleFilterDropdown(n))}),t.j41(2,"i",25),t.nrm(3,"ion-icon",26),t.k0s()(),t.j41(4,"button",27)(5,"i",28),t.DNE(6,$t,1,0,"ion-icon",29),t.k0s()()()}if(2&_){const h=t.XpG(2);t.R7$(),t.Y8G("@buttonState",h.getDropdownState()),t.R7$(5),t.Y8G("ngIf",!h.isTrainer)}}function Ht(_,x){if(1&_&&(t.j41(0,"ion-select-option",39),t.EFF(1),t.k0s()),2&_){const h=x.$implicit;t.Y8G("value",h),t.R7$(),t.JRh(h)}}function Wt(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-button",40),t.bIt("click",function(){t.eBV(h);const n=t.XpG(3);return t.Njj(n.resetTypeFilter())}),t.nrm(1,"ion-icon",41),t.k0s()}}function te(_,x){if(1&_){const h=t.RV6();t.j41(0,"ion-list",31),t.bIt("@dropdownState.done",function(n){t.eBV(h);const p=t.XpG(2);return t.Njj(p.dropdownAnimationDone(n))}),t.j41(1,"ion-item")(2,"ion-label",32),t.EFF(3,"\u05e1\u05d5\u05d2 \u05d0\u05d9\u05de\u05d5\u05df"),t.k0s(),t.j41(4,"ion-select",33),t.mxI("ngModelChange",function(n){t.eBV(h);const p=t.XpG(2);return t.DH7(p.selectedType,n)||(p.selectedType=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(h);const n=t.XpG(2);return t.Njj(n.onTypeChange())}),t.DNE(5,Ht,2,2,"ion-select-option",34),t.k0s(),t.DNE(6,Wt,2,0,"ion-button",35),t.k0s(),t.j41(7,"ion-item")(8,"ion-label",32),t.EFF(9,"\u05d6\u05de\u05d9\u05e0\u05d5\u05ea"),t.k0s(),t.j41(10,"ion-segment",36),t.mxI("ngModelChange",function(n){t.eBV(h);const p=t.XpG(2);return t.DH7(p.availabilityFilter,n)||(p.availabilityFilter=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(h);const n=t.XpG(2);return t.Njj(n.onFilterChange())}),t.j41(11,"ion-segment-button",37)(12,"ion-label"),t.EFF(13,"\u05d4\u05db\u05dc"),t.k0s()(),t.j41(14,"ion-segment-button",38)(15,"ion-label"),t.EFF(16,"\u05d6\u05de\u05d9\u05df \u05d1\u05dc\u05d1\u05d3"),t.k0s()()()()()}if(2&_){const h=t.XpG(2);t.Y8G("@dropdownState",h.getDropdownState()),t.R7$(4),t.R50("ngModel",h.selectedType),t.R7$(),t.Y8G("ngForOf",h.availableTypes),t.R7$(),t.Y8G("ngIf",h.selectedType),t.R7$(4),t.R50("ngModel",h.availabilityFilter)}}function ee(_,x){if(1&_&&(t.j41(0,"div")(1,"div",16)(2,"div",17,1),t.DNE(4,Ft,7,4,"ng-container",18),t.k0s()(),t.DNE(5,qt,7,2,"div",19)(6,te,17,5,"ion-list",20),t.k0s()),2&_){const h=t.XpG();t.R7$(4),t.Y8G("ngForOf",h.days),t.R7$(),t.Y8G("ngIf",!h.showSkeleton),t.R7$(),t.Y8G("ngIf",h.showDropdown||h.isAnimating)}}function ie(_,x){1&_&&(t.j41(0,"ion-item",44)(1,"ion-thumbnail",45),t.nrm(2,"ion-skeleton-text",46),t.k0s(),t.j41(3,"ion-label")(4,"h3"),t.nrm(5,"ion-skeleton-text",47),t.k0s(),t.j41(6,"p"),t.nrm(7,"ion-skeleton-text",48),t.k0s(),t.j41(8,"p"),t.nrm(9,"ion-skeleton-text",49),t.k0s()()()),2&_&&(t.R7$(2),t.Y8G("animated",!0),t.R7$(3),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0))}function It(_,x){1&_&&(t.j41(0,"ion-list")(1,"ion-list-header"),t.nrm(2,"ion-skeleton-text",42),t.k0s(),t.DNE(3,ie,10,4,"ion-item",43),t.k0s()),2&_&&(t.R7$(2),t.Y8G("animated",!0),t.R7$(),t.Y8G("ngForOf",t.lJ4(2,At)))}function ne(_,x){if(1&_&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&_){const h=x.$implicit;t.R7$(),t.SpI(" ",h," ")}}function ft(_,x){if(1&_&&(t.j41(0,"div",66)(1,"ul"),t.DNE(2,ne,2,1,"li",18),t.k0s()()),2&_){const h=t.XpG().$implicit;t.R7$(2),t.Y8G("ngForOf",h.current_participants)}}function zt(_,x){1&_&&(t.qex(0),t.j41(1,"button",67),t.nrm(2,"ion-icon",68),t.EFF(3," \u05e8\u05e9\u05d5\u05dd "),t.k0s(),t.bVm())}function Ot(_,x){1&_&&(t.qex(0),t.EFF(1," \u05e8\u05e9\u05d5\u05dd \u05dc\u05d4\u05de\u05ea\u05e0\u05d4 "),t.bVm())}function Ut(_,x){1&_&&(t.qex(0),t.EFF(1," \u05d4\u05e8\u05e9\u05de\u05d4 \u05dc\u05d4\u05de\u05ea\u05e0\u05d4 "),t.bVm())}function St(_,x){1&_&&(t.qex(0),t.nrm(1,"ion-spinner",72),t.bVm())}function Lt(_,x){1&_&&(t.qex(0),t.nrm(1,"ion-icon",68),t.bVm())}function Et(_,x){1&_&&(t.qex(0),t.nrm(1,"ion-icon",73),t.bVm())}function Pt(_,x){if(1&_){const h=t.RV6();t.j41(0,"button",71),t.bIt("click",function(){let n;t.eBV(h);const p=t.XpG(2).$implicit,y=t.XpG();return t.Njj(y.addToStandbyList(null!==(n=p)&&void 0!==n?n:0,y.userId,y.userEmail))}),t.DNE(1,Ot,2,0,"ng-container",12)(2,Ut,2,0,"ng-container",12)(3,St,2,0,"ng-container",12)(4,Lt,2,0,"ng-container",12)(5,Et,2,0,"ng-container",12),t.k0s()}if(2&_){const h=t.XpG(2).$implicit;t.Y8G("ngClass",t.ziG(7,Bt,h.isStandbyEnrolled,h.isStandbyLoading&&!h.isStandbyEnrolled,h.isStandbySuccess&&!h.isStandbyEnrolled,h.isError&&!h.isStandbyEnrolled))("disabled",h.isStandbyEnrolled||h.isStandbyLoading||h.isStandbySuccess||h.isError),t.R7$(),t.Y8G("ngIf",h.isStandbyEnrolled),t.R7$(),t.Y8G("ngIf",!(h.isStandbyEnrolled||h.isStandbyLoading||h.isStandbySuccess||h.isError)),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isStandbyLoading),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isStandbySuccess),t.R7$(),t.Y8G("ngIf",!h.isStandbyEnrolled&&h.isError)}}function Vt(_,x){1&_&&(t.qex(0),t.EFF(1,"\u05d4\u05e8\u05e9\u05de\u05d4"),t.bVm())}function Ct(_,x){1&_&&(t.qex(0),t.nrm(1,"ion-spinner",72),t.bVm())}function Rt(_,x){1&_&&(t.qex(0),t.nrm(1,"ion-icon",68),t.bVm())}function Xt(_,x){if(1&_){const h=t.RV6();t.j41(0,"button",74),t.bIt("click",function(){t.eBV(h);const n=t.XpG(2).$implicit,p=t.XpG();return t.Njj(p.enrollUser(n))}),t.DNE(1,Vt,2,0,"ng-container",12)(2,Ct,2,0,"ng-container",12)(3,Rt,2,0,"ng-container",12),t.k0s()}if(2&_){const h=t.XpG(2).$implicit;t.Y8G("disabled",h.isLoading||h.isSuccess)("ngClass",t.l_i(5,Jt,h.isLoading,h.isSuccess)),t.R7$(),t.Y8G("ngIf",!h.isLoading&&!h.isSuccess),t.R7$(),t.Y8G("ngIf",h.isLoading),t.R7$(),t.Y8G("ngIf",h.isSuccess)}}function ae(_,x){if(1&_&&(t.qex(0),t.DNE(1,Pt,6,12,"button",69)(2,Xt,4,8,"button",70),t.bVm()),2&_){const h=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",h.booked===h.total_participants),t.R7$(),t.Y8G("ngIf",h.booked<h.total_participants)}}function Zt(_,x){if(1&_){const h=t.RV6();t.j41(0,"div",50)(1,"div",51)(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"ion-icon",52),t.bIt("click",function(){const n=t.eBV(h).$implicit,p=t.XpG();return t.Njj(p.toggleFavorite(n))}),t.k0s(),t.j41(5,"ion-icon",53),t.bIt("click",function(){const n=t.eBV(h).$implicit,p=t.XpG();return t.Njj(p.openMusicModal(n))}),t.k0s(),t.j41(6,"button",54),t.bIt("click",function(){t.eBV(h);const n=t.XpG();return t.Njj(n.addTrainingToCalendar())}),t.j41(7,"ion-icon",55),t.bIt("click",function(){t.eBV(h);const n=t.XpG();return t.Njj(n.addTrainingToCalendar())}),t.k0s(),t.j41(8,"span"),t.EFF(9,"\u05d4\u05d5\u05e1\u05e3 \u05dc\u05d9\u05d5\u05de\u05df"),t.k0s()()(),t.j41(10,"div",56)(11,"div",57),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"div",58)(15,"div",59),t.nrm(16,"div",60),t.k0s(),t.j41(17,"div",61)(18,"div",62),t.bIt("mouseenter",function(){const n=t.eBV(h).$implicit,p=t.XpG();return t.Njj(p.showParticipantsPopup(n))})("mouseleave",function(){t.eBV(h);const n=t.XpG();return t.Njj(n.hideParticipantsPopup())}),t.EFF(19),t.nrm(20,"ion-icon",63),t.DNE(21,ft,3,1,"div",64),t.k0s()()()(),t.j41(22,"div",65),t.DNE(23,zt,4,0,"ng-container",12)(24,ae,3,2,"ng-container",12),t.k0s()()}if(2&_){const h=x.$implicit,e=t.XpG();t.R7$(3),t.JRh(h.title.name),t.R7$(),t.AVh("favorite",h.favorite),t.R7$(8),t.SpI(" ",t.i5U(13,12,h.start_time,"HH:mm")," "),t.R7$(4),t.xc7("width",e.calculateProgress(h)+"%"),t.Y8G("ngStyle",t.eq3(15,Tt,"shalom"===e.selectedFilterAllFav?"#ff8366":"#59c7cd")),t.R7$(3),t.Lme(" ",h.booked,"/",h.total_participants," "),t.R7$(2),t.Y8G("ngIf",e.isPopupVisible&&e.activeAppointment===h),t.R7$(2),t.Y8G("ngIf",h.isUserBooked),t.R7$(),t.Y8G("ngIf",!h.isUserBooked)}}let Gt=(()=>{var _;class x{get showSkeleton(){return"shalom"===this.selectedFilterAllFav&&this.isShalomLoading||"all"===this.selectedFilterAllFav&&this.isBenYehudaLoading}constructor(e,n,p,y,I,A,R,V){this.platform=e,this.toastController=n,this.modalCtrl=p,this.http=y,this.authService=I,this.modalCalendar=A,this.profileService=R,this.calendarService=V,this.customerID="",this.userEmail="",this.userFavLocation="",this.userRole="",this.isTrainer=!1,this.showingParticipants=!1,this.isPopupVisible=!1,this.activeAppointment=null,this.selectedFilterAllFav="all",this.selectedType="",this.availabilityFilter="all",this.showDropdown=!1,this.availableTypes=[],this.filteredAppointments=[],this.bookedAppointments=[],this.combinedList=[],this.days=[],this.knownTrainingTypes=["\u05e4\u05d9\u05dc\u05d0\u05d8\u05d9\u05e1","\u05d9\u05d5\u05d2\u05d4","\u05d0\u05d9\u05de\u05d5\u05df \u05db\u05d5\u05d7","Parallel 15","Spinning","TRX","Booty&ABS","All In","HiiT","POWER",""],this.availableTimeslots=[],this.unfilteredList=[],this.isLoading=!0,this.isStandbyLoading=!1,this.isStandbySuccess=!1,this.isEnrollLoading=!1,this.isEnrollSuccess=!1,this.showToast=!1,this.toastMessage="",this.toastColor="success",this.errorMessage="",this.currentDateRange=null,this.allAvailableDays=[],this.tabLoadingState=!1,this.indicatorPosition=357,this.indicatorWidth=20,this.benYehudaDays=[],this.shalomDays=[],this.benYehudaAppointments=[],this.shalomAppointments=[],this.benYehudaTimeslots=[],this.shalomTimeslots=[],this.benYehudaLoaded=!1,this.shalomLoaded=!1,this.isShalomLoading=!1,this.isBenYehudaLoading=!0,"trainer"===this.authService.getUserRole()&&(this.isTrainer=!0),this.userId=this.authService.getUserID(),this.userEmail=this.authService.getUserEmail(),this.customerID=this.authService.getCustomerID(),this.userFavLocation=this.authService.getUserFavLocation(),this.authService.fetchPackageCustomerId(this.customerID).subscribe({error:N=>{console.error("Error fetching package id",N)}})}ngAfterViewInit(){setTimeout(()=>{this.updateIndicatorPosition()},100)}ngOnInit(){var e=this;return(0,s.A)(function*(){e.isLoading=!0;try{"inactive"===e.userRole?e.presentToast("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d8\u05e2\u05d5\u05df \u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd, \u05d4\u05de\u05e9\u05ea\u05de\u05e9 \u05dc\u05d0 \u05e4\u05e2\u05d9\u05dc","danger"):"trial-users"===e.userRole&&e.presentToast("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d8\u05e2\u05d5\u05df \u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd, \u05de\u05e9\u05ea\u05de\u05e9 \u05e0\u05d9\u05e1\u05d9\u05d5\u05df","danger");const n=e.authService.getUserFavLocation();e.userFavLocation=n,"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===e.userFavLocation||"\u05d4\u05db\u05dc"===e.userFavLocation?e.selectedFilterAllFav="all":"\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"===e.userFavLocation&&(e.selectedFilterAllFav="shalom"),yield e.loadInitialData()}catch(n){console.error("Error during initialization:",n),e.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05de\u05e9\u05d9\u05db\u05ea \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd","danger")}finally{e.isLoading=!1}})()}presentToast(e,n){var p=this;return(0,s.A)(function*(){yield(yield p.toastController.create({message:e,duration:3e3,color:n,position:"bottom"})).present()})()}extractAvailableDays(){const e=["\u05d0'","\u05d1'","\u05d2'","\u05d3'","\u05d4'","\u05d5'","\u05e9'"],n=(new Date).toISOString().split("T")[0],p=this.combinedList.filter(I=>!isNaN(new Date(I.start_time).getTime())).map(I=>new Date(I.start_time).toISOString().split("T")[0]),y=Array.from(new Set(p)).map(I=>{const A=new Date(I);return{date:I,day:e[A.getDay()],formattedDate:`${A.getDate()}.${A.getMonth()+1}`}});y.sort((I,A)=>I.date===n?-1:A.date===n?1:new Date(I.date).getTime()-new Date(A.date).getTime()),"all"===this.selectedFilterAllFav?this.benYehudaDays=y:"shalom"===this.selectedFilterAllFav&&(this.shalomDays=y),this.days="all"===this.selectedFilterAllFav?this.benYehudaDays:this.shalomDays,this.selectedDay=this.days.length>0?this.days[0].date:""}extractAvailableTypes(){const e=new Set(this.filteredAppointments.map(n=>n.title.name));this.availableTypes=Array.from(e)}getAppointmentsForSelectedDay(){return this.combinedList.filter(e=>{const n=X(e.start_time);return n.isValid()&&n.format("YYYY-MM-DD")===this.selectedDay})}loadInitialData(){var e=this;return(0,s.A)(function*(){"all"===e.selectedFilterAllFav?(e.isBenYehudaLoading=!0,setTimeout(()=>{},0)):"shalom"===e.selectedFilterAllFav&&(e.isShalomLoading=!0);try{const p=new Date,y=new Date(p);y.setDate(p.getDate()+20);let I=e.profileService.getSubscriptionExpiryDate(),A=y;if(I){const[V,N,lt]=I.split("/").map(Number);var n=new Date(lt,N-1,V);et=A,m=n,b=p,A=Math.abs(et-b)<Math.abs(m-b)?et:m}e.currentDateRange={start:p,end:A};let R=e.userFavLocation;"\u05d4\u05db\u05dc"==e.userFavLocation&&(R="\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"),console.time("fetchTime"),yield e.fetchTrainingsForDateRange(p,A,R),console.timeEnd("fetchTime")}catch(p){console.error("Error loading initial data:",p),yield e.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d8\u05e2\u05d9\u05e0\u05ea \u05d0\u05d9\u05de\u05d5\u05e0\u05d9\u05dd","danger")}finally{"all"===e.selectedFilterAllFav?(e.isBenYehudaLoading=!1,setTimeout(()=>{},0)):"shalom"===e.selectedFilterAllFav&&(e.isShalomLoading=!1)}var et,m,b})()}fetchTrainingsForDateRange(e,n,p){var y=this;return(0,s.A)(function*(){if("\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===p&&y.benYehudaLoaded)return y.combinedList=[...y.benYehudaAppointments],y.unfilteredList=[...y.combinedList],void y.updateFilteredAppointments();if("\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"===p&&y.shalomLoaded)return y.combinedList=[...y.shalomAppointments],y.unfilteredList=[...y.combinedList],void y.updateFilteredAppointments();const I=y.authService.getUserID(),A=R=>X(R).format("YYYY-MM-DD");try{const R=A(e),V=A(n);console.log("endDateFormatted:",V);const lt=`https://k-studio.co.il/wp-json/custom-api/v1/get-trainings?startDate=${R}&endDate=${V}&userID=${I}&location=${encodeURIComponent(p)}`,ot=yield mt(y.http.get(lt));for(let et=new Date(e);et<=n;et.setDate(et.getDate()+1)){const m=A(new Date(et));y.allAvailableDays.includes(m)||y.allAvailableDays.push(m)}yield y.combineTimeslotsAndAppointments(ot),"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===p?(y.benYehudaAppointments=[...y.combinedList],y.benYehudaLoaded=!0):"\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"===p&&(y.shalomAppointments=[...y.combinedList],y.shalomLoaded=!0)}catch(R){throw console.error("Error fetching trainings:",R),R}})()}combineTimeslotsAndAppointments(e){var n=this;return(0,s.A)(function*(){try{const p=e.filter(V=>"timeslot"===V.type),y=e.filter(V=>"appointment"===V.type),I="all"===n.selectedFilterAllFav;I?(n.benYehudaTimeslots=p,n.benYehudaAppointments=y):(n.shalomTimeslots=p,n.shalomAppointments=y),n.combinedList=[...I?n.benYehudaTimeslots:n.shalomTimeslots,...I?n.benYehudaAppointments:n.shalomAppointments],n.combinedList.sort((V,N)=>new Date(V.start_time).getTime()-new Date(N.start_time).getTime()),n.unfilteredList=[...n.combinedList],n.extractAvailableDays();const A=n.authService.getUserFullName(),R=n.combinedList.map(function(){var V=(0,s.A)(function*(N){N.start_time&&!isNaN(Date.parse(N.start_time))?(N.isStandbyEnrolled=N.booked>=N.total_participants&&void 0!==N.id&&(yield n.checkStandbyEnrollment(n.userEmail,N.id)),Array.isArray(N.current_participants)?N.isUserBooked=N.current_participants.some(lt=>lt===A):(console.warn("current_participants is not an array for training:",N),N.isUserBooked=!1)):console.error("Invalid start_time for training:",N)});return function(N){return V.apply(this,arguments)}}());yield Promise.all(R),n.filteredAppointments=[...n.combinedList],n.updateFilteredAppointments()}catch(p){console.error("Error combining timeslots and appointments:",p)}})()}onDayChange(e){this.selectedDay=String(e||""),this.updateIndicatorPosition(),this.updateFilteredAppointments()}updateIndicatorPosition(){setTimeout(()=>{if(!this.segmentButtons||0===this.segmentButtons.length)return;const e=this.days.findIndex(y=>y.date===this.selectedDay);if(-1!==e){var n,p;const y=null===(n=this.segmentButtons.toArray()[e])||void 0===n?void 0:n.nativeElement;if(y&&null!==(p=this.segmentScroll)&&void 0!==p&&p.nativeElement){const I=y.getBoundingClientRect(),A=this.segmentScroll.nativeElement.getBoundingClientRect();this.indicatorPosition=I.left-A.left+y.offsetWidth/2-this.indicatorWidth/2,this.renderer.setStyle(this.indicator.nativeElement,"transform",`translateX(${this.indicatorPosition}px)`)}}},50)}getIndicatorPosition(){return this.indicatorPosition}filterFavAll(e){var n=this;return(0,s.A)(function*(){const p=e.detail.value;if(n.combinedList=[],n.filteredAppointments=[],n.days=[],"favorites"===p){n.tabLoadingState=!0;try{const V=[...n.benYehudaAppointments,...n.shalomAppointments],N=[...n.benYehudaTimeslots,...n.shalomTimeslots];n.combinedList=[...N,...V],n.unfilteredList=[...n.combinedList],n.updateFilteredAppointments()}finally{n.tabLoadingState=!1}return}const I={all:"\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4",shalom:"\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"}[p],A="all"===p?n.benYehudaLoaded:n.shalomLoaded;"all"===p?(n.isBenYehudaLoading=!0,setTimeout(()=>{},0)):"shalom"===p&&(n.isShalomLoading=!0);try{if("all"===p?(n.days=n.benYehudaDays,n.benYehudaLoaded&&(n.combinedList=[...n.benYehudaTimeslots,...n.benYehudaAppointments],n.unfilteredList=[...n.combinedList],n.selectedDay=n.benYehudaDays.length>0?n.benYehudaDays[0].date:"",n.updateFilteredAppointments())):"shalom"===p&&(n.days=n.shalomDays,n.shalomLoaded&&(n.combinedList=[...n.shalomTimeslots,...n.shalomAppointments],n.unfilteredList=[...n.combinedList],n.selectedDay=n.shalomDays.length>0?n.shalomDays[0].date:"",n.updateFilteredAppointments())),!A){const V=new Date,N=new Date(V);N.setDate(V.getDate()+20);let lt=n.profileService.getSubscriptionExpiryDate(),ot=N;if(lt){const[et,m,b]=lt.split("/").map(Number);var R=new Date(b,m-1,et);i=ot,r=R,o=V,ot=Math.abs(i-o)<Math.abs(r-o)?i:r}yield n.fetchTrainingsForDateRange(V,ot,I)}}finally{"all"===p?n.isBenYehudaLoading=!1:n.isShalomLoading=!1}var i,r,o})()}toggleAvailabilityFilter(){this.availabilityFilter="all"===this.availabilityFilter?"available":"all",this.updateFilteredAppointments()}updateFilteredAppointments(){let e=[...this.unfilteredList];this.selectedDay&&(e=e.filter(n=>X(n.start_time).format("YYYY-MM-DD")===this.selectedDay)),"available"===this.availabilityFilter&&(e=e.filter(n=>n.booked<n.total_participants)),this.selectedType&&(e=e.filter(n=>n.title.name===this.selectedType)),"favorites"===this.selectedFilterAllFav&&(e=e.filter(n=>n.favorite)),e.sort((n,p)=>new Date(n.start_time).getTime()-new Date(p.start_time).getTime()),this.filteredAppointments=[...e],this.extractAvailableTypes()}onFilterChange(){this.updateFilteredAppointments()}onTypeChange(){this.updateFilteredAppointments()}resetTypeFilter(){this.selectedType="",this.updateFilteredAppointments()}removePastFavorites(){const e=new Date,p=this.getFavoriteTrainings().filter(y=>{const I=this.combinedList.find(A=>A.id===y);return I&&new Date(I.start_time)>e});this.saveFavoriteTrainings(p)}closeModal(){document.body.classList.remove("no-scroll"),this.modalCtrl.dismiss()}toggleFavorite(e){e.favorite=!e.favorite;const n=this.getFavoriteTrainings();if(e.favorite)n.push(e.id);else{const p=n.indexOf(e.id);p>-1&&n.splice(p,1)}this.saveFavoriteTrainings(n)}getFavoriteTrainings(){const e=localStorage.getItem("favoriteTrainings");return e?JSON.parse(e):[]}saveFavoriteTrainings(e){localStorage.setItem("favoriteTrainings",JSON.stringify(e))}toggleFilterDropdown(e){e&&e.stopPropagation(),!this.isAnimating&&(this.showDropdown=!this.showDropdown,this.isAnimating=!0,this.showDropdown?document.body.classList.add("no-scroll"):document.body.classList.remove("no-scroll"))}handleOutsideClick(e){var n;const p=e.target,y=document.querySelector(".filter-dropdown"),I=null===(n=document.querySelector(".filter-icon"))||void 0===n?void 0:n.parentElement,A=document.querySelector(".training-list");this.showDropdown&&y&&I&&!y.contains(p)&&!I.contains(p)&&(null==A||!A.contains(p))&&(this.showDropdown=!1,document.body.classList.remove("no-scroll"))}dropdownAnimationDone(e){"closed"!==e.toState||this.showDropdown?"open"===e.toState&&this.showDropdown&&(this.isAnimating=!1):this.isAnimating=!1}getDropdownState(){return this.showDropdown?"open":"closed"}calculateProgress(e){if(!e.current_participants||!e.total_participants)return 0;const n=e.current_participants.length/e.total_participants*100;return n>100?100:n}showParticipantsPopup(e){this.activeAppointment=e,this.isPopupVisible=!0}hideParticipantsPopup(){this.activeAppointment=null,this.isPopupVisible=!1}addToStandbyList(e,n,p){e.isStandbyLoading=!0,e.isStandbySuccess=!1,this.http.post("https://k-studio.co.il/wp-json/standby-list/v1/add",{appointment_id:null==e?void 0:e.id,customer_id:n,email:p}).subscribe(()=>{e.isStandbyLoading=!1,e.isStandbySuccess=!0},A=>{console.error("Error adding user to standby list",A),e.isStandbyLoading=!1,this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4","danger")})}checkStandbyEnrollment(e,n){const y=(new K.Nl).set("email",e).set("trainingId",n.toString());return mt(this.http.get("https://k-studio.co.il/wp-json/standby-list/v1/check",{params:y})).then(I=>I.isEnrolled).catch(I=>(console.error("Error checking standby enrollment",I),!1))}enrollUser(e){e.isLoading=!0,e.isSuccess=!1,e.isError=!1;let n=e.serviceID;const y=e.start_time.slice(0,16);let I=e.providerId,A=this.authService.getCustomerID(),R=this.authService.getPackageCustomerId();const lt={type:"appointment",serviceId:n,providerId:I,locationId:null,notifyParticipants:0,bookings:[{customerId:A,status:"approved",duration:3600,persons:1,extras:[],customFields:{},utcOffset:-(new Date).getTimezoneOffset(),packageCustomerService:{packageCustomer:{id:R}}}],bookingStart:y,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone};this.platform.ready().then(()=>{const ot=JSON.stringify(lt);this.http.post("https://k-studio.co.il/wp-json/wn/v1/enrollTraining",ot,{headers:{"Content-Type":"application/json"}}).subscribe(et=>{var m,b;if(console.log("Response:",et),null===et.message||null===et.data)return this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4: \u05dc\u05d0 \u05e0\u05de\u05e6\u05d0\u05d4 \u05d7\u05d1\u05d9\u05dc\u05d4 \u05d6\u05de\u05d9\u05e0\u05d4","danger"),e.isError=!0,void(e.isLoading=!1);if(null!==(m=et.data)&&void 0!==m&&m.timeSlotUnavailable)this.presentToast(et.message||"The time slot is unavailable","danger");else if(null!==(b=et.data)&&void 0!==b&&b.customerAlreadyBooked)this.presentToast(et.message||"You have already booked this training","success");else if(et.message){e.isSuccess=!0,e.current_participants||(e.current_participants=[]),e.booked+=1;const g=`${this.authService.getUserFullName()}`;e.current_participants.push(g),e.isUserBooked=!0}else e.isSuccess=!0;e.isLoading=!1,setTimeout(()=>{e.isSuccess=!1},2e3)},et=>{console.error("Enrollment failed",JSON.stringify(et)),e.isLoading=!1,et.error&&et.error.includes('"packageCustomerId" is required for booking')?this.presentToast("\u05dc\u05d0 \u05e0\u05de\u05e6\u05d0\u05d4 \u05d7\u05d1\u05d9\u05dc\u05d4 \u05d6\u05de\u05d9\u05e0\u05d4","danger"):this.presentToast("\u05e9\u05d2\u05d9\u05d0\u05d4","danger"),e.isError=!0})})}openCalendarPopup(){var e=this;return(0,s.A)(function*(){let n="";"all"===e.selectedFilterAllFav?n="main":"shalom"===e.selectedFilterAllFav&&(n="second"),yield(yield e.modalCalendar.create({component:$,componentProps:{branch:n}})).present()})()}getWeeklyTrainings(){return[]}openMusicModal(e){var n=this;return(0,s.A)(function*(){const p=yield n.modalCtrl.create({component:ct,componentProps:{training:e}});return p.onDidDismiss().then(y=>{}),yield p.present()})()}addTrainingToCalendar(){this.calendarService.addEventToCalendar("Gym Training Session","Smart Zone Gym, Tel Aviv","Your booked training session at Smart Zone Gym",new Date("2025-03-15T10:00:00"),new Date("2025-03-15T12:00:00"))}}return(_=x).\u0275fac=function(e){return new(e||_)(t.rXU(nt.OD),t.rXU(w.K_),t.rXU(w.W3),t.rXU(K.Qq),t.rXU(G.u),t.rXU(w.W3),t.rXU(ut.p),t.rXU(xt))},_.\u0275cmp=t.VBU({type:_,selectors:[["app-trainings"]],viewQuery:function(e,n){if(1&e&&(t.GBs(bt,5),t.GBs(kt,5),t.GBs(Nt,5),t.GBs(Yt,5)),2&e){let p;t.mGM(p=t.lsd())&&(n.popup=p.first),t.mGM(p=t.lsd())&&(n.segmentScroll=p.first),t.mGM(p=t.lsd())&&(n.indicator=p.first),t.mGM(p=t.lsd())&&(n.segmentButtons=p)}},hostBindings:function(e,n){1&e&&t.bIt("click",function(y){return n.handleOutsideClick(y)},!1,t.EBC)},decls:15,vars:6,consts:[["popup",""],["segmentScroll",""],["segmentButton",""],[1,"popup-modal-trainings"],[1,"drag-handle"],[1,"content-container"],[1,"sticky-header"],[1,"header-tabs"],["mode","md",1,"segment-tab",3,"ngModelChange","ionChange","ngModel"],["value","all","class","header-tab",4,"ngIf"],["value","shalom","class","header-tab segment-button-checked-shalom",4,"ngIf"],["value","favorites",1,"header-tab","segment-button-checked-fav"],[4,"ngIf"],["class","card",4,"ngFor","ngForOf"],["value","all",1,"header-tab"],["value","shalom",1,"header-tab","segment-button-checked-shalom"],[1,"segment-container"],[1,"segment-scroll"],[4,"ngFor","ngForOf"],["class","filter-header",4,"ngIf"],["class","filter-dropdown",4,"ngIf"],[1,"segment-button",3,"click"],[1,"segment-label"],[1,"filter-header"],[1,"icon-button",3,"click"],[1,"filter-icon"],["name","filter-outline",1,"filter-icon"],[1,"icon-button","calendar-button"],[1,"calendar-icon"],["name","calendar-outline","class","calendar-icon",3,"click",4,"ngIf"],["name","calendar-outline",1,"calendar-icon",3,"click"],[1,"filter-dropdown"],[2,"text-indent","8px"],["interface","popover","placeholder","\u05d1\u05d7\u05e8 \u05e1\u05d5\u05d2 \u05d0\u05d9\u05de\u05d5\u05df",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["color","danger","fill","clear",3,"click",4,"ngIf"],[3,"ngModelChange","ionChange","ngModel"],["value","all"],["value","available"],[3,"value"],["color","danger","fill","clear",3,"click"],["name","close-circle"],[2,"width","80px",3,"animated"],["lines","none","class","skeleton-item",4,"ngFor","ngForOf"],["lines","none",1,"skeleton-item"],["slot","start"],[3,"animated"],[2,"width","80%",3,"animated"],[2,"width","60%",3,"animated"],[2,"width","30%",3,"animated"],[1,"card"],[1,"card-header"],["name","heart-outline",3,"click"],["name","play-circle-outline",3,"click"],[1,"action-button","calendar-button",3,"click"],["name","calendar-outline",3,"click"],[1,"card-content"],[1,"time-date"],[1,"progress-bar-container"],[1,"progress-bar"],[1,"progress",3,"ngStyle"],[1,"participants-container"],[1,"participants",3,"mouseenter","mouseleave"],["name","people-outline"],["class","participant-popup",4,"ngIf"],[1,"card-footer"],[1,"participant-popup"],["disabled","",1,"action-button","enrolled-button"],["name","checkmark-circle",1,"success-icon"],["class","action-button",3,"ngClass","disabled","click",4,"ngIf"],["class","action-button",3,"disabled","ngClass","click",4,"ngIf"],[1,"action-button",3,"click","ngClass","disabled"],["name","crescent"],["name","close-circle",1,"error-icon"],[1,"action-button",3,"click","disabled","ngClass"]],template:function(e,n){if(1&e){const p=t.RV6();t.j41(0,"ion-content",3,0),t.nrm(2,"div",4),t.j41(3,"div",5)(4,"div",6)(5,"div",7)(6,"ion-segment",8),t.mxI("ngModelChange",function(I){return t.eBV(p),t.DH7(n.selectedFilterAllFav,I)||(n.selectedFilterAllFav=I),t.Njj(I)}),t.bIt("ionChange",function(I){return t.eBV(p),t.Njj(n.filterFavAll(I))}),t.DNE(7,Kt,3,0,"ion-segment-button",9)(8,jt,3,0,"ion-segment-button",10),t.j41(9,"ion-segment-button",11)(10,"ion-label"),t.EFF(11,"\u05de\u05d5\u05e2\u05d3\u05e4\u05d9\u05dd"),t.k0s()()()(),t.DNE(12,ee,7,3,"div",12)(13,It,4,3,"ion-list",12)(14,Zt,25,17,"div",13),t.k0s()()()}2&e&&(t.R7$(6),t.R50("ngModel",n.selectedFilterAllFav),t.R7$(),t.Y8G("ngIf","\u05d1\u05df \u05d9\u05d4\u05d5\u05d3\u05d4"===n.userFavLocation||"\u05d4\u05db\u05dc"===n.userFavLocation),t.R7$(),t.Y8G("ngIf","\u05e9\u05dc\u05d5\u05dd \u05e2\u05dc\u05d9\u05db\u05dd"===n.userFavLocation||"\u05d4\u05db\u05dc"===n.userFavLocation),t.R7$(4),t.Y8G("ngIf",!n.showSkeleton),t.R7$(),t.Y8G("ngIf",n.showSkeleton),t.R7$(),t.Y8G("ngForOf",n.filteredAppointments))},dependencies:[Z.YU,Z.Sq,Z.bT,Z.B3,P.BC,P.vS,w.Jm,w.W9,w.iq,w.uz,w.he,w.nf,w.AF,w.Gp,w.eP,w.Nm,w.Ip,w.ds,w.w2,w.Zx,w.Je,Z.vh],styles:['@charset "UTF-8";.sticky-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background-color:#fff}.scrollable-list[_ngcontent-%COMP%]{height:calc(100vh - 130px);overflow-y:auto}.filter-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;margin-top:20px;margin-bottom:20px}.icon-button[_ngcontent-%COMP%]{position:relative;width:40px;height:40px;border-radius:50%;background-color:#fff;border:1px solid rgba(0,0,0,.1);box-shadow:0 2px 4px #00000014;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:all .2s ease;margin-right:12px}.icon-button[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000026}.calendar-button[_ngcontent-%COMP%]{margin-left:16px}.calendar-icon[_ngcontent-%COMP%], .filter-icon[_ngcontent-%COMP%]{position:static;font-size:18px;transform:none;color:#222}.filter-controls[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 0}.training-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:15px;box-shadow:0 4px 12px #0000001a;padding:15px;margin-bottom:20px;width:100%;box-sizing:border-box}.training-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.favorite-icon[_ngcontent-%COMP%]{font-size:24px;color:#5a5a5a}.training-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4em;font-weight:700;margin-top:-30px;color:#333;font-family:Alef}.training-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin-top:-20px;font-family:Alef}.progress-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:10px}ion-progress-bar[_ngcontent-%COMP%]{--progress-background: #E0E0E0;--background: #9B59B6;border-radius:10px;height:10px;flex-grow:1;margin-left:10px}ion-label[_ngcontent-%COMP%]{font-size:2em;color:#333}ion-button[_ngcontent-%COMP%]{font-weight:700;--border-radius: 25px}.scroll-container[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}ion-segment.days-tabs[_ngcontent-%COMP%]{border-bottom:1px solid grey}.filter-segment[_ngcontent-%COMP%]{color:red}ion-segment-button[_ngcontent-%COMP%]{--color-checked: #000}ion-segment-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1em;font-weight:700;font-family:Alef}ion-segment-button[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:1em;color:#666;font-weight:700;font-family:Alef}ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--inner-padding-start: 0;--padding-start: 0;--padding-end: 0;padding:0}.header-tab[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:10px;width:100%;padding:0;border:none;box-shadow:none;padding:none;--indicator-color: transparent}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]{display:flex;width:100%}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]{transition:all .3s ease}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab.dragging-mode[_ngcontent-%COMP%]{cursor:move;opacity:.7;transform:scale(1.05)}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]   .hide-tab-btn[_ngcontent-%COMP%]{margin-left:10px;color:red;cursor:pointer;opacity:.7;transition:opacity .2s}.header-tab[_ngcontent-%COMP%]   segment-tab[_ngcontent-%COMP%]   .header-tab[_ngcontent-%COMP%]   .hide-tab-btn[_ngcontent-%COMP%]:hover{opacity:1}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3;background-color:#f0f0f0}.header-tabs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:10px;width:100%;padding:0;border:none;box-shadow:none}.custom-tabs[_ngcontent-%COMP%]{position:relative;--background-activated: transparent;--background-focused: transparent;--background: transparent;font-size:1em;--color-checked: #333;--color: #ff0000;padding-bottom:10px;width:90%;margin-left:10px;--indicator-color: transparent}.segment-button-checked[_ngcontent-%COMP%]{position:relative;transition:all .3s ease;border-radius:12px;--indicator-color: transparent;color:#000}.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#59c7cd;transition:all .3s ease}.custom-underline-default.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#59c7cd;transition:all .3s ease}.scroll-container[_ngcontent-%COMP%]{overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}.scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.custom-underline-shalom.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#ff8366;border-radius:12px;transition:all .3s ease}.custom-underline-favorites.segment-button-checked[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;transform:translate(-50%);width:80%;height:4px;background:#373737;border-radius:12px;transition:all .3s ease}.segment-button-checked-shalom[_ngcontent-%COMP%]:after{background:#ff8366}.segment-button-checked-fav[_ngcontent-%COMP%]:after{background:#373737}.clear-filter-icon[_ngcontent-%COMP%]{font-size:24px;color:#e74c3c;margin-left:10px;cursor:pointer}.filter-dropdown[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:15px;background-color:#fff;border-radius:15px;box-shadow:0 4px 12px #0000001a;padding:15px;width:100%}.filter-dropdown.ng-animating[_ngcontent-%COMP%]{pointer-events:none}ion-select[_ngcontent-%COMP%]{--placeholder-color: #999;--color: #333;--background: #fff;--border-radius: 10px;--box-shadow: 0 4px 12px rgba(0, 0, 0, .1)}.popup-modal-trainings[_ngcontent-%COMP%]{height:80vh;border-top-left-radius:20px;border-top-right-radius:20px;background:#fff;padding:10px;box-shadow:0 -4px 12px #0000001a;overflow-y:auto;max-height:100vh}.drag-handle[_ngcontent-%COMP%]{width:10px;height:1px;background-color:transparent;border-radius:2.5px;margin:0 auto 10px}.content-container[_ngcontent-%COMP%]{padding:15px;justify-content:center}ion-content[_ngcontent-%COMP%]{--background: white}ion-tab-bar[_ngcontent-%COMP%]{--background: #fff;--color-selected: #3498db;--color: #666}ion-tab-button[_ngcontent-%COMP%]{--color-selected: #666;--color: #666}.card[_ngcontent-%COMP%]{background-color:#fff;padding:15px;margin:10px 0;border-radius:12px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.4em;font-weight:700;color:#333;font-family:Alef;margin-left:auto}.card-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;margin-left:10px}.card-header[_ngcontent-%COMP%]   ion-icon.favorite[_ngcontent-%COMP%]{color:red}.time-date[_ngcontent-%COMP%]{font-size:14px;color:gray}.segment-button[_ngcontent-%COMP%]:not(.segment-button-checked):after{height:0}.progress-bar-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.progress-bar[_ngcontent-%COMP%]{width:80%;background-color:#e0e0e0;border-radius:8px;height:6px}.progress-default[_ngcontent-%COMP%]{background-color:#59c7cd}.progress-shalom[_ngcontent-%COMP%]{background-color:#ff8366}.progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:6px;border-radius:8px;background-color:#59c7cd}.participants[_ngcontent-%COMP%]{font-size:12px;display:flex;align-items:center}.participants[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:4px}.card-footer[_ngcontent-%COMP%]{margin-top:10px}.action-button[_ngcontent-%COMP%]{width:100%;background-color:#454545;color:#fff;border:none;padding:10px;border-radius:8px;text-align:center;font-size:14px;cursor:pointer;transition:background-color .3s ease}.action-button.loading[_ngcontent-%COMP%]{background-color:#f0f0f0;cursor:not-allowed}.action-button.success[_ngcontent-%COMP%]{background-color:#4caf50}.success-icon[_ngcontent-%COMP%]{color:#fff;font-size:14px}ion-spinner[_ngcontent-%COMP%]{height:10px;width:10px}.action-button.full[_ngcontent-%COMP%]{background-color:#757575}.enrolled-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;cursor:not-allowed}.participants-container[_ngcontent-%COMP%]{background-color:#c5c5c563;position:relative;width:50px;border-radius:7px}.participant-popup[_ngcontent-%COMP%]{position:absolute;top:-10px;left:60px;background-color:#fff;border:none;padding:12px;box-shadow:0 8px 16px #00000026;width:180px;z-index:10;border-radius:12px;max-height:200px;overflow-y:auto;transition:opacity .3s ease,transform .3s ease;opacity:0;transform:translateY(-10px)}.participant-popup[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:14px}.participant-popup[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.participant-popup[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:12px;margin-bottom:5px}.participants[_ngcontent-%COMP%]{cursor:pointer;position:relative;justify-content:center}.participants[_ngcontent-%COMP%]:hover{text-decoration:underline}.participants[_ngcontent-%COMP%]:hover   .participant-popup[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.action-button.standby-enrolled[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#757575;cursor:not-allowed}.action-button.error[_ngcontent-%COMP%]{background-color:#ff4d4d;color:#fff}.action-button[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:14px;color:#fff}.song-count-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;font-size:.7rem}.segment-container[_ngcontent-%COMP%]{width:100%;overflow:hidden;position:relative;padding:8px 0}.segment-scroll[_ngcontent-%COMP%]{display:flex;overflow-x:auto;gap:32px;padding:0 16px 10px;position:relative;border-bottom:2px #c7c7c7 solid;font-family:Alef}.segment-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.segment-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:-moz-fit-content;min-width:fit-content;background:transparent;border:none;cursor:pointer;transition:all .2s ease;padding:4px 0}.segment-button.active[_ngcontent-%COMP%]{color:#000}.segment-button.active[_ngcontent-%COMP%]   .segment-label[_ngcontent-%COMP%]{font-weight:600;font-size:16px}.segment-button[_ngcontent-%COMP%]:not(.active){color:#999}.segment-button[_ngcontent-%COMP%]:not(.active):hover{color:#666}.segment-icon[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px}.segment-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;line-height:20px}.segment-indicator[_ngcontent-%COMP%]{position:absolute;bottom:-2px;left:-3.3%;height:4px;width:48px;background-color:#000;transition:transform .3s ease}'],data:{animation:[(0,E.hZ)("buttonState",[(0,E.wk)("open",(0,E.iF)({transform:"rotate(180deg)"})),(0,E.wk)("closed",(0,E.iF)({transform:"rotate(0deg)"})),(0,E.kY)("closed <=> open",(0,E.i0)("200ms ease-in-out"))]),(0,E.hZ)("dropdownState",[(0,E.wk)("open",(0,E.iF)({opacity:1,transform:"translateY(0)",height:"*"})),(0,E.wk)("closed",(0,E.iF)({opacity:0,transform:"translateY(-10px)",height:"0"})),(0,E.kY)("closed => open",(0,E.i0)("200ms ease-out")),(0,E.kY)("open => closed",(0,E.i0)("200ms ease-in"))])]}}),x})()},9584:(Dt,ht,k)=>{k.d(ht,{B:()=>at});var s=k(8359);class E extends s.yU{constructor(S,U){super()}schedule(S,U=0){return this}}const K={setInterval(J,S,...U){const{delegate:$}=K;return null!=$&&$.setInterval?$.setInterval(J,S,...U):setInterval(J,S,...U)},clearInterval(J){const{delegate:S}=K;return((null==S?void 0:S.clearInterval)||clearInterval)(J)},delegate:void 0};var X=k(7908);const dt={now:()=>(dt.delegate||Date).now(),delegate:void 0};class mt{constructor(S,U=mt.now){this.schedulerActionCtor=S,this.now=U}schedule(S,U=0,$){return new this.schedulerActionCtor(this,S).schedule($,U)}}mt.now=dt.now;const w=new class t extends mt{constructor(S,U=mt.now){super(S,U),this.actions=[],this._active=!1}flush(S){const{actions:U}=this;if(this._active)return void U.push(S);let $;this._active=!0;do{if($=S.execute(S.state,S.delay))break}while(S=U.shift());if(this._active=!1,$){for(;S=U.shift();)S.unsubscribe();throw $}}}(class pt extends E{constructor(S,U){super(S,U),this.scheduler=S,this.work=U,this.pending=!1}schedule(S,U=0){var $;if(this.closed)return this;this.state=S;const F=this.id,G=this.scheduler;return null!=F&&(this.id=this.recycleAsyncId(G,F,U)),this.pending=!0,this.delay=U,this.id=null!==($=this.id)&&void 0!==$?$:this.requestAsyncId(G,this.id,U),this}requestAsyncId(S,U,$=0){return K.setInterval(S.flush.bind(S,this),$)}recycleAsyncId(S,U,$=0){if(null!=$&&this.delay===$&&!1===this.pending)return U;null!=U&&K.clearInterval(U)}execute(S,U){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const $=this._execute(S,U);if($)return $;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(S,U){let F,$=!1;try{this.work(S)}catch(G){$=!0,F=G||new Error("Scheduled action threw falsy error")}if($)return this.unsubscribe(),F}unsubscribe(){if(!this.closed){const{id:S,scheduler:U}=this,{actions:$}=U;this.work=this.state=this.scheduler=null,this.pending=!1,(0,X.o)($,this),null!=S&&(this.id=this.recycleAsyncId(U,S,null)),this.delay=null,super.unsubscribe()}}});var Z=k(9974),Q=k(4360);function at(J,S=w){return(0,Z.N)((U,$)=>{let F=null,G=null,P=null;const H=()=>{if(F){F.unsubscribe(),F=null;const D=G;G=null,$.next(D)}};function Y(){const D=P+J,L=S.now();if(L<D)return F=this.schedule(void 0,D-L),void $.add(F);H()}U.subscribe((0,Q._)($,D=>{G=D,P=S.now(),F||(F=S.schedule(Y,J),$.add(F))},()=>{H(),$.complete()},void 0,()=>{G=F=null}))})}},5262:(Dt,ht,k)=>{k.d(ht,{Bu:()=>Kt,Q_:()=>W,_G:()=>e,w6:()=>n});var s=k(177),E=k(3953),K=k(6860),X=k(1413),pt=k(8359),t=(k(4402),k(7673),k(7336)),w=k(8141),rt=k(9584),Z=k(5964),Q=k(6354),at=k(6697),S=k(4085),U=k(4572),$=k(8793),F=k(1985),P=k(9172),H=k(6977);const D=new Set;let L,q=(()=>{var f;class a{constructor(d,v){this._platform=d,this._nonce=v,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):vt}matchMedia(d){return(this._platform.WEBKIT||this._platform.BLINK)&&function tt(f,a){if(!D.has(f))try{L||(L=document.createElement("style"),a&&L.setAttribute("nonce",a),L.setAttribute("type","text/css"),document.head.appendChild(L)),L.sheet&&(L.sheet.insertRule(`@media ${f} {body{ }}`,0),D.add(f))}catch(l){console.error(l)}}(d,this._nonce),this._matchMedia(d)}}return(f=a).\u0275fac=function(d){return new(d||f)(E.KVO(K.OD),E.KVO(E.BIS,8))},f.\u0275prov=E.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),a})();function vt(f){return{matches:"all"===f||""===f,media:f,addListener:()=>{},removeListener:()=>{}}}let gt=(()=>{var f;class a{constructor(d,v){this._mediaMatcher=d,this._zone=v,this._queries=new Map,this._destroySubject=new X.B}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(d){return yt((0,S.FG)(d)).some(T=>this._registerQuery(T).mql.matches)}observe(d){const T=yt((0,S.FG)(d)).map(z=>this._registerQuery(z).observable);let B=(0,U.z)(T);return B=(0,$.x)(B.pipe((0,at.s)(1)),B.pipe(function G(f){return(0,Z.p)((a,l)=>f<=l)}(1),(0,rt.B)(0))),B.pipe((0,Q.T)(z=>{const st={matches:!1,breakpoints:{}};return z.forEach(({matches:wt,query:Qt})=>{st.matches=st.matches||wt,st.breakpoints[Qt]=wt}),st}))}_registerQuery(d){if(this._queries.has(d))return this._queries.get(d);const v=this._mediaMatcher.matchMedia(d),B={observable:new F.c(z=>{const st=wt=>this._zone.run(()=>z.next(wt));return v.addListener(st),()=>{v.removeListener(st)}}).pipe((0,P.Z)(v),(0,Q.T)(({matches:z})=>({query:d,matches:z})),(0,H.Q)(this._destroySubject)),mql:v};return this._queries.set(d,B),B}}return(f=a).\u0275fac=function(d){return new(d||f)(E.KVO(q),E.KVO(E.SKi))},f.\u0275prov=E.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),a})();function yt(f){return f.map(a=>a.split(",")).reduce((a,l)=>a.concat(l)).map(a=>a.trim())}class Tt{constructor(a,l){this._letterKeyStream=new X.B,this._items=[],this._selectedItemIndex=-1,this._pressedLetters=[],this._selectedItem=new X.B,this.selectedItem=this._selectedItem;const d="number"==typeof(null==l?void 0:l.debounceInterval)?l.debounceInterval:200;null!=l&&l.skipPredicate&&(this._skipPredicateFn=l.skipPredicate),this.setItems(a),this._setupKeyHandler(d)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(a){this._selectedItemIndex=a}setItems(a){this._items=a}handleKey(a){const l=a.keyCode;a.key&&1===a.key.length?this._letterKeyStream.next(a.key.toLocaleUpperCase()):(l>=t.A&&l<=t.Z||l>=t.f2&&l<=t.bn)&&this._letterKeyStream.next(String.fromCharCode(l))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(a){this._letterKeyStream.pipe((0,w.M)(l=>this._pressedLetters.push(l)),(0,rt.B)(a),(0,Z.p)(()=>this._pressedLetters.length>0),(0,Q.T)(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(l=>{for(let T=1;T<this._items.length+1;T++){var d,v;const z=this._items[(this._selectedItemIndex+T)%this._items.length];if((null===(d=this._skipPredicateFn)||void 0===d||!d.call(this,z))&&0===(null===(v=z.getLabel)||void 0===v?void 0:v.call(z).toLocaleUpperCase().trim().indexOf(l))){this._selectedItem.next(z);break}}this._pressedLetters=[]})}}class Bt{constructor(a,l){this._items=a,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._typeaheadSubscription=pt.yU.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=d=>d.disabled,this.tabOut=new X.B,this.change=new X.B,a instanceof E.rOR?this._itemChangesSubscription=a.changes.subscribe(d=>this._itemsChanged(d.toArray())):(0,E.Hps)(a)&&(this._effectRef=(0,E.QZP)(()=>this._itemsChanged(a()),{injector:l}))}skipPredicate(a){return this._skipPredicateFn=a,this}withWrap(a=!0){return this._wrap=a,this}withVerticalOrientation(a=!0){return this._vertical=a,this}withHorizontalOrientation(a){return this._horizontal=a,this}withAllowedModifierKeys(a){return this._allowedModifierKeys=a,this}withTypeAhead(a=200){this._typeaheadSubscription.unsubscribe();const l=this._getItemsArray();return this._typeahead=new Tt(l,{debounceInterval:"number"==typeof a?a:void 0,skipPredicate:d=>this._skipPredicateFn(d)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(d=>{this.setActiveItem(d)}),this}cancelTypeahead(){var a;return null===(a=this._typeahead)||void 0===a||a.reset(),this}withHomeAndEnd(a=!0){return this._homeAndEnd=a,this}withPageUpDown(a=!0,l=10){return this._pageUpAndDown={enabled:a,delta:l},this}setActiveItem(a){const l=this._activeItem;this.updateActiveItem(a),this._activeItem!==l&&this.change.next(this._activeItemIndex)}onKeydown(a){var l;const d=a.keyCode,T=["altKey","ctrlKey","metaKey","shiftKey"].every(z=>!a[z]||this._allowedModifierKeys.indexOf(z)>-1);switch(d){case t.wn:return void this.tabOut.next();case t.n6:if(this._vertical&&T){this.setNextItemActive();break}return;case t.i7:if(this._vertical&&T){this.setPreviousItemActive();break}return;case t.LE:if(this._horizontal&&T){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case t.UQ:if(this._horizontal&&T){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case t.yZ:if(this._homeAndEnd&&T){this.setFirstItemActive();break}return;case t.Kp:if(this._homeAndEnd&&T){this.setLastItemActive();break}return;case t.w_:if(this._pageUpAndDown.enabled&&T){const z=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(z>0?z:0,1);break}return;case t.dB:if(this._pageUpAndDown.enabled&&T){const z=this._activeItemIndex+this._pageUpAndDown.delta,st=this._getItemsArray().length;this._setActiveItemByIndex(z<st?z:st-1,-1);break}return;default:var B;return void((T||(0,t.rp)(a,"shiftKey"))&&(null===(B=this._typeahead)||void 0===B||B.handleKey(a)))}null===(l=this._typeahead)||void 0===l||l.reset(),a.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(a){var l;const d=this._getItemsArray(),v="number"==typeof a?a:d.indexOf(a),T=d[v];this._activeItem=null==T?null:T,this._activeItemIndex=v,null===(l=this._typeahead)||void 0===l||l.setCurrentSelectedItemIndex(v)}destroy(){var a,l,d;this._typeaheadSubscription.unsubscribe(),null===(a=this._itemChangesSubscription)||void 0===a||a.unsubscribe(),null===(l=this._effectRef)||void 0===l||l.destroy(),null===(d=this._typeahead)||void 0===d||d.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(a){this._wrap?this._setActiveInWrapMode(a):this._setActiveInDefaultMode(a)}_setActiveInWrapMode(a){const l=this._getItemsArray();for(let d=1;d<=l.length;d++){const v=(this._activeItemIndex+a*d+l.length)%l.length;if(!this._skipPredicateFn(l[v]))return void this.setActiveItem(v)}}_setActiveInDefaultMode(a){this._setActiveItemByIndex(this._activeItemIndex+a,a)}_setActiveItemByIndex(a,l){const d=this._getItemsArray();if(d[a]){for(;this._skipPredicateFn(d[a]);)if(!d[a+=l])return;this.setActiveItem(a)}}_getItemsArray(){return(0,E.Hps)(this._items)?this._items():this._items instanceof E.rOR?this._items.toArray():this._items}_itemsChanged(a){var l;if(null===(l=this._typeahead)||void 0===l||l.setItems(a),this._activeItem){const v=a.indexOf(this._activeItem);var d;v>-1&&v!==this._activeItemIndex&&(this._activeItemIndex=v,null===(d=this._typeahead)||void 0===d||d.setCurrentSelectedItemIndex(v))}}}class Kt extends Bt{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(a){return this._origin=a,this}setActiveItem(a){super.setActiveItem(a),this.activeItem&&this.activeItem.focus(this._origin)}}function e(f){return 0===f.buttons||0===f.detail}function n(f){const a=f.touches&&f.touches[0]||f.changedTouches&&f.changedTouches[0];return!(!a||-1!==a.identifier||null!=a.radiusX&&1!==a.radiusX||null!=a.radiusY&&1!==a.radiusY)}var c=function(f){return f[f.NONE=0]="NONE",f[f.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",f[f.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",f}(c||{});const u="cdk-high-contrast-black-on-white",M="cdk-high-contrast-white-on-black",O="cdk-high-contrast-active";let W=(()=>{var f;class a{constructor(d,v){this._platform=d,this._document=v,this._breakpointSubscription=(0,E.WQX)(gt).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return c.NONE;const d=this._document.createElement("div");d.style.backgroundColor="rgb(1,2,3)",d.style.position="absolute",this._document.body.appendChild(d);const v=this._document.defaultView||window,T=v&&v.getComputedStyle?v.getComputedStyle(d):null,B=(T&&T.backgroundColor||"").replace(/ /g,"");switch(d.remove(),B){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return c.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return c.BLACK_ON_WHITE}return c.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const d=this._document.body.classList;d.remove(O,u,M),this._hasCheckedHighContrastMode=!0;const v=this.getHighContrastMode();v===c.BLACK_ON_WHITE?d.add(O,u):v===c.WHITE_ON_BLACK&&d.add(O,M)}}}return(f=a).\u0275fac=function(d){return new(d||f)(E.KVO(K.OD),E.KVO(s.qQ))},f.\u0275prov=E.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),a})()},4085:(Dt,ht,k)=>{k.d(ht,{FG:()=>pt,OE:()=>K,he:()=>E,i8:()=>mt});var s=k(3953);function E(w){return null!=w&&"false"!=`${w}`}function K(w,rt=0){return function X(w){return!isNaN(parseFloat(w))&&!isNaN(Number(w))}(w)?Number(w):2===arguments.length?rt:0}function pt(w){return Array.isArray(w)?w:[w]}function mt(w){return w instanceof s.aKT?w.nativeElement:w}},7336:(Dt,ht,k)=>{k.d(ht,{A:()=>kt,A$:()=>t,FX:()=>dt,Fm:()=>pt,Ge:()=>Pt,Kp:()=>S,LE:()=>G,UQ:()=>$,W3:()=>mt,Z:()=>Et,bn:()=>j,dB:()=>J,eg:()=>ce,f2:()=>q,i7:()=>F,n6:()=>P,rp:()=>le,t6:()=>Q,w_:()=>at,wn:()=>K,yZ:()=>U});const K=9,pt=13,dt=16,mt=17,t=18,Q=32,at=33,J=34,S=35,U=36,$=37,F=38,G=39,P=40,q=48,j=57,kt=65,Et=90,Pt=91,ce=224;function le(oe,...se){return se.length?se.some(de=>oe[de]):oe.altKey||oe.shiftKey||oe.ctrlKey||oe.metaKey}},6860:(Dt,ht,k)=>{k.d(ht,{BQ:()=>Z,Fb:()=>H,OD:()=>X,v8:()=>Y,vc:()=>P});var s=k(3953),E=k(177);let K;try{K=typeof Intl<"u"&&Intl.v8BreakIterator}catch{K=!1}let w,X=(()=>{var D;class L{constructor(tt){this._platformId=tt,this.isBrowser=this._platformId?(0,E.UE)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!K)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return(D=L).\u0275fac=function(tt){return new(tt||D)(s.KVO(s.Agw))},D.\u0275prov=s.jDH({token:D,factory:D.\u0275fac,providedIn:"root"}),L})();function Z(D){return function rt(){if(null==w&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>w=!0}))}finally{w=w||!1}return w}()?D:!!D.capture}function P(){let D=typeof document<"u"&&document?document.activeElement:null;for(;D&&D.shadowRoot;){const L=D.shadowRoot.activeElement;if(L===D)break;D=L}return D}function H(D){return D.composedPath?D.composedPath()[0]:D.target}function Y(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},8834:(Dt,ht,k)=>{k.d(ht,{Hl:()=>ct});var s=k(3953),E=k(8820);let ct=(()=>{var nt;class ut{}return(nt=ut).\u0275fac=function(C){return new(C||nt)},nt.\u0275mod=s.$C({type:nt}),nt.\u0275inj=s.G2t({imports:[E.yE,E.pZ,E.yE]}),ut})()},8820:(Dt,ht,k)=>{k.d(ht,{$E:()=>Xt,yE:()=>_t,O5:()=>_,pZ:()=>Zt,ug:()=>Ct});var s=k(3953),E=k(5262),K=k(177);let rt=(()=>{var r;class o{}return(r=o).\u0275fac=function(u){return new(u||r)},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({}),o})();var Q=k(6860),at=k(4085);const yt=new s.nKC("mat-sanity-checks",{providedIn:"root",factory:function gt(){return!0}});let _t=(()=>{var r;class o{constructor(u,M,O){this._sanityChecks=M,this._document=O,this._hasDoneGlobalChecks=!1,u._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(u){return!(0,Q.v8)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[u])}}return(r=o).\u0275fac=function(u){return new(u||r)(s.KVO(E.Q_),s.KVO(yt,8),s.KVO(K.qQ))},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({imports:[rt,rt]}),o})();var ft=function(r){return r[r.FADING_IN=0]="FADING_IN",r[r.VISIBLE=1]="VISIBLE",r[r.FADING_OUT=2]="FADING_OUT",r[r.HIDDEN=3]="HIDDEN",r}(ft||{});class zt{constructor(o,c,u,M=!1){this._renderer=o,this.element=c,this.config=u,this._animationForciblyDisabledThroughCss=M,this.state=ft.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const Ot=(0,Q.BQ)({passive:!0,capture:!0});class Ut{constructor(){this._events=new Map,this._delegateEventHandler=o=>{const c=(0,Q.Fb)(o);var u;c&&(null===(u=this._events.get(o.type))||void 0===u||u.forEach((M,O)=>{(O===c||O.contains(c))&&M.forEach(W=>W.handleEvent(o))}))}}addHandler(o,c,u,M){const O=this._events.get(c);if(O){const W=O.get(u);W?W.add(M):O.set(u,new Set([M]))}else this._events.set(c,new Map([[u,new Set([M])]])),o.runOutsideAngular(()=>{document.addEventListener(c,this._delegateEventHandler,Ot)})}removeHandler(o,c,u){const M=this._events.get(o);if(!M)return;const O=M.get(c);O&&(O.delete(u),0===O.size&&M.delete(c),0===M.size&&(this._events.delete(o),document.removeEventListener(o,this._delegateEventHandler,Ot)))}}const St={enterDuration:225,exitDuration:150},Et=(0,Q.BQ)({passive:!0,capture:!0}),Pt=["mousedown","touchstart"],Vt=["mouseup","mouseleave","touchend","touchcancel"];class Ct{constructor(o,c,u,M){this._target=o,this._ngZone=c,this._platform=M,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,M.isBrowser&&(this._containerElement=(0,at.i8)(u))}fadeInRipple(o,c,u={}){const M=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),O={...St,...u.animation};u.centered&&(o=M.left+M.width/2,c=M.top+M.height/2);const W=u.radius||function Rt(r,o,c){const u=Math.max(Math.abs(r-c.left),Math.abs(r-c.right)),M=Math.max(Math.abs(o-c.top),Math.abs(o-c.bottom));return Math.sqrt(u*u+M*M)}(o,c,M),Mt=o-M.left,f=c-M.top,a=O.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left=Mt-W+"px",l.style.top=f-W+"px",l.style.height=2*W+"px",l.style.width=2*W+"px",null!=u.color&&(l.style.backgroundColor=u.color),l.style.transitionDuration=`${a}ms`,this._containerElement.appendChild(l);const d=window.getComputedStyle(l),T=d.transitionDuration,B="none"===d.transitionProperty||"0s"===T||"0s, 0s"===T||0===M.width&&0===M.height,z=new zt(this,l,u,B);l.style.transform="scale3d(1, 1, 1)",z.state=ft.FADING_IN,u.persistent||(this._mostRecentTransientRipple=z);let st=null;return!B&&(a||O.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const wt=()=>{st&&(st.fallbackTimer=null),clearTimeout(re),this._finishRippleTransition(z)},Qt=()=>this._destroyRipple(z),re=setTimeout(Qt,a+100);l.addEventListener("transitionend",wt),l.addEventListener("transitioncancel",Qt),st={onTransitionEnd:wt,onTransitionCancel:Qt,fallbackTimer:re}}),this._activeRipples.set(z,st),(B||!a)&&this._finishRippleTransition(z),z}fadeOutRipple(o){if(o.state===ft.FADING_OUT||o.state===ft.HIDDEN)return;const c=o.element,u={...St,...o.config.animation};c.style.transitionDuration=`${u.exitDuration}ms`,c.style.opacity="0",o.state=ft.FADING_OUT,(o._animationForciblyDisabledThroughCss||!u.exitDuration)&&this._finishRippleTransition(o)}fadeOutAll(){this._getActiveRipples().forEach(o=>o.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(o=>{o.config.persistent||o.fadeOut()})}setupTriggerEvents(o){const c=(0,at.i8)(o);!this._platform.isBrowser||!c||c===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=c,Pt.forEach(u=>{Ct._eventManager.addHandler(this._ngZone,u,c,this)}))}handleEvent(o){"mousedown"===o.type?this._onMousedown(o):"touchstart"===o.type?this._onTouchStart(o):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Vt.forEach(c=>{this._triggerElement.addEventListener(c,this,Et)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(o){o.state===ft.FADING_IN?this._startFadeOutTransition(o):o.state===ft.FADING_OUT&&this._destroyRipple(o)}_startFadeOutTransition(o){const c=o===this._mostRecentTransientRipple,{persistent:u}=o.config;o.state=ft.VISIBLE,!u&&(!c||!this._isPointerDown)&&o.fadeOut()}_destroyRipple(o){var c;const u=null!==(c=this._activeRipples.get(o))&&void 0!==c?c:null;this._activeRipples.delete(o),this._activeRipples.size||(this._containerRect=null),o===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),o.state=ft.HIDDEN,null!==u&&(o.element.removeEventListener("transitionend",u.onTransitionEnd),o.element.removeEventListener("transitioncancel",u.onTransitionCancel),null!==u.fallbackTimer&&clearTimeout(u.fallbackTimer)),o.element.remove()}_onMousedown(o){const c=(0,E._G)(o),u=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!c&&!u&&(this._isPointerDown=!0,this.fadeInRipple(o.clientX,o.clientY,this._target.rippleConfig))}_onTouchStart(o){if(!this._target.rippleDisabled&&!(0,E.w6)(o)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const c=o.changedTouches;if(c)for(let u=0;u<c.length;u++)this.fadeInRipple(c[u].clientX,c[u].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(o=>{!o.config.persistent&&(o.state===ft.VISIBLE||o.config.terminateOnPointerUp&&o.state===ft.FADING_IN)&&o.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const o=this._triggerElement;o&&(Pt.forEach(c=>Ct._eventManager.removeHandler(c,o,this)),this._pointerUpEventsRegistered&&(Vt.forEach(c=>o.removeEventListener(c,this,Et)),this._pointerUpEventsRegistered=!1))}}Ct._eventManager=new Ut;const Xt=new s.nKC("mat-ripple-global-options");let Zt=(()=>{var r;class o{}return(r=o).\u0275fac=function(u){return new(u||r)},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({imports:[_t,_t]}),o})(),_=(()=>{var r;class o{}return(r=o).\u0275fac=function(u){return new(u||r)},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({imports:[_t]}),o})()},2054:(Dt,ht,k)=>{k.d(ht,{Fg:()=>et});var s=k(3953),X=(k(4085),k(6860),k(8820));k(8359),k(6365),k(8750),k(983),k(3794),k(6648),k(1413),k(1985),k(6354),k(5964),k(9584);let F=(()=>{var m;class b{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}}return(m=b).\u0275fac=function(i){return new(i||m)},m.\u0275prov=s.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),b})(),H=(()=>{var m;class b{}return(m=b).\u0275fac=function(i){return new(i||m)},m.\u0275mod=s.$C({type:m}),m.\u0275inj=s.G2t({providers:[F]}),b})();var Y=k(177);let L=(()=>{var m;class b{}return(m=b).\u0275fac=function(i){return new(i||m)},m.\u0275mod=s.$C({type:m}),m.\u0275inj=s.G2t({imports:[X.yE,X.yE]}),b})();k(5262),k(4402),k(7673),k(7336),k(9417),k(6977);let et=(()=>{var m;class b{}return(m=b).\u0275fac=function(i){return new(i||m)},m.\u0275mod=s.$C({type:m}),m.\u0275inj=s.G2t({imports:[H,Y.MD,X.yE,X.pZ,X.O5,L]}),b})()},5911:(Dt,ht,k)=>{k.d(ht,{s5:()=>t});var s=k(3953),E=k(8820);let t=(()=>{var w;class rt{}return(w=rt).\u0275fac=function(Q){return new(Q||w)},w.\u0275mod=s.$C({type:w}),w.\u0275inj=s.G2t({imports:[E.yE,E.yE]}),rt})()}}]);